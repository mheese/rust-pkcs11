<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<base href="http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/os/pkcs11-base-v2.40-os.html">
<title>PKCS #11 Cryptographic Token Interface Base Specification Version 2.40</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:MingLiU;
	panose-1:2 2 5 9 0 0 0 0 0 0;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:Mangal;
	panose-1:2 4 5 3 5 2 3 3 2 2;}
@font-face
	{font-family:Latha;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;}
@font-face
	{font-family:Vrinda;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Raavi;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Shruti;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Tunga;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:3 8 6 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:Times;
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:Palatino;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:"\@Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
h1
	{margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.3in;
	text-indent:-.3in;
	page-break-before:always;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
h2
	{mso-style-name:"Heading 2\,H2";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.4in;
	text-indent:-.4in;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
h3
	{mso-style-name:"Heading 3\,H3";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.5in;
	text-indent:-.5in;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
h4
	{mso-style-name:"Heading 4\,H4";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.6in;
	text-indent:-.6in;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
h5
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.7in;
	text-indent:-.7in;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
h6
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.8in;
	text-indent:-.8in;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.9in;
	text-indent:-.9in;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:1.0in;
	text-indent:-1.0in;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;
	font-style:italic;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:1.1in;
	text-indent:-1.1in;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;
	font-style:italic;}
p.MsoIndex1, li.MsoIndex1, div.MsoIndex1
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoIndex2, li.MsoIndex2, div.MsoIndex2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:.25in;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoIndex3, li.MsoIndex3, div.MsoIndex3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoIndex4, li.MsoIndex4, div.MsoIndex4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:.75in;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoIndex5, li.MsoIndex5, div.MsoIndex5
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:1.0in;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoIndex6, li.MsoIndex6, div.MsoIndex6
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:1.25in;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoIndex7, li.MsoIndex7, div.MsoIndex7
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:1.5in;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:12.0pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:24.0pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.5in;
	font-size:9.0pt;
	font-family:"Arial","sans-serif";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:48.0pt;
	font-size:9.0pt;
	font-family:"Arial","sans-serif";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:60.0pt;
	font-size:9.0pt;
	font-family:"Arial","sans-serif";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:1.0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:84.0pt;
	margin-bottom:.0001pt;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:96.0pt;
	margin-bottom:.0001pt;
	font-size:9.0pt;
	font-family:"Times New Roman","serif";}
p.MsoNormalIndent, li.MsoNormalIndent, div.MsoNormalIndent
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{mso-style-link:"Footnote Text Char";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-link:"Comment Text Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-name:"Header\,header odd\,header odd1\,header odd2\,header odd11\,header odd3\,header odd12\,header odd21\,header odd111";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoIndexHeading, li.MsoIndexHeading, div.MsoIndexHeading
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	page-break-after:avoid;
	font-size:9.0pt;
	font-family:"Arial","sans-serif";
	font-style:italic;}
p.MsoTof, li.MsoTof, div.MsoTof
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:20.0pt;
	margin-bottom:.0001pt;
	text-indent:-20.0pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	font-variant:small-caps;}
span.MsoFootnoteReference
	{vertical-align:super;}
span.MsoEndnoteReference
	{vertical-align:super;}
p.MsoEndnoteText, li.MsoEndnoteText, div.MsoEndnoteText
	{mso-style-link:"Endnote Text Char";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoList, li.MsoList, div.MsoList
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:.25in;
	text-align:justify;
	text-indent:-.25in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListBullet, li.MsoListBullet, div.MsoListBullet
	{margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.25in;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoListNumber, li.MsoListNumber, div.MsoListNumber
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:.5in;
	text-align:justify;
	text-indent:-.5in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoList2, li.MsoList2, div.MsoList2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:.5in;
	text-align:justify;
	text-indent:-.25in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListBullet2, li.MsoListBullet2, div.MsoListBullet2
	{margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.5in;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:24.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{mso-style-link:"Body Text Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoBodyTextIndent, li.MsoBodyTextIndent, div.MsoBodyTextIndent
	{mso-style-link:"Body Text Indent Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:1.5in;
	text-align:justify;
	text-indent:-1.5in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListContinue2, li.MsoListContinue2, div.MsoListContinue2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.5in;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoMessageHeader, li.MsoMessageHeader, div.MsoMessageHeader
	{mso-style-link:"Message Header Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:.75in;
	text-align:justify;
	text-indent:-.75in;
	background:#CCCCCC;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Arial","sans-serif";}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
p.MsoDate, li.MsoDate, div.MsoDate
	{mso-style-link:"Date Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:center;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	font-style:italic;}
p.MsoNoteHeading, li.MsoNoteHeading, div.MsoNoteHeading
	{margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoBodyText2, li.MsoBodyText2, div.MsoBodyText2
	{mso-style-link:"Body Text 2 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoBodyTextIndent3, li.MsoBodyTextIndent3, div.MsoBodyTextIndent3
	{mso-style-link:"Body Text Indent 3 Char";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:170.1pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:-134.1pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
a:link, span.MsoHyperlink
	{color:#0000EE;
	text-decoration:none;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{mso-style-link:"Document Map Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:justify;
	background:navy;
	font-size:12.0pt;
	font-family:"Tahoma","sans-serif";}
p
	{margin-right:0in;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial Unicode MS","sans-serif";}
pre
	{mso-style-link:"HTML Preformatted Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial Unicode MS","sans-serif";}
tt
	{font-family:"Arial Unicode MS","sans-serif";}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.Titlepageinfo, li.Titlepageinfo, div.Titlepageinfo
	{mso-style-name:"Title page info";
	margin:0in;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
p.Titlepageinfodescription, li.Titlepageinfodescription, div.Titlepageinfodescription
	{mso-style-name:"Title page info description";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.TitlepageinfodescriptionCxSpFirst, li.TitlepageinfodescriptionCxSpFirst, div.TitlepageinfodescriptionCxSpFirst
	{mso-style-name:"Title page info descriptionCxSpFirst";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.TitlepageinfodescriptionCxSpMiddle, li.TitlepageinfodescriptionCxSpMiddle, div.TitlepageinfodescriptionCxSpMiddle
	{mso-style-name:"Title page info descriptionCxSpMiddle";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.TitlepageinfodescriptionCxSpLast, li.TitlepageinfodescriptionCxSpLast, div.TitlepageinfodescriptionCxSpLast
	{mso-style-name:"Title page info descriptionCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.Contributor, li.Contributor, div.Contributor
	{mso-style-name:Contributor;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.ContributorCxSpFirst, li.ContributorCxSpFirst, div.ContributorCxSpFirst
	{mso-style-name:ContributorCxSpFirst;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.ContributorCxSpMiddle, li.ContributorCxSpMiddle, div.ContributorCxSpMiddle
	{mso-style-name:ContributorCxSpMiddle;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.ContributorCxSpLast, li.ContributorCxSpLast, div.ContributorCxSpLast
	{mso-style-name:ContributorCxSpLast;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.Legalnotice, li.Legalnotice, div.Legalnotice
	{mso-style-name:"Legal notice";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.LegalnoticeCxSpFirst, li.LegalnoticeCxSpFirst, div.LegalnoticeCxSpFirst
	{mso-style-name:"Legal noticeCxSpFirst";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.LegalnoticeCxSpMiddle, li.LegalnoticeCxSpMiddle, div.LegalnoticeCxSpMiddle
	{mso-style-name:"Legal noticeCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.LegalnoticeCxSpLast, li.LegalnoticeCxSpLast, div.LegalnoticeCxSpLast
	{mso-style-name:"Legal noticeCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
span.Datatype
	{mso-style-name:Datatype;
	font-family:"Courier New";}
p.Code, li.Code, div.Code
	{mso-style-name:Code;
	margin-top:0in;
	margin-right:.3in;
	margin-bottom:0in;
	margin-left:.3in;
	margin-bottom:.0001pt;
	background:#D9D9D9;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Courier New";}
p.AppendixHeading2, li.AppendixHeading2, div.AppendixHeading2
	{mso-style-name:AppendixHeading2;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.4in;
	text-indent:-.4in;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
span.Element
	{mso-style-name:Element;
	font-family:"Courier New";}
span.Attribute
	{mso-style-name:Attribute;
	font-family:"Courier New";}
span.Keyword
	{mso-style-name:Keyword;
	font-family:"Courier New";}
p.Note, li.Note, div.Note
	{mso-style-name:Note;
	margin-top:6.0pt;
	margin-right:.5in;
	margin-bottom:6.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.Definitionterm, li.Definitionterm, div.Definitionterm
	{mso-style-name:"Definition term";
	margin-top:4.0pt;
	margin-right:2.0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";
	font-weight:bold;}
p.Definition, li.Definition, div.Definition
	{mso-style-name:Definition;
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.Ref, li.Ref, div.Ref
	{mso-style-name:Ref;
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:1.5in;
	text-indent:-1.25in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";
	color:black;}
p.AppendixHeading1, li.AppendixHeading1, div.AppendixHeading1
	{mso-style-name:AppendixHeading1;
	mso-style-link:"AppendixHeading1 Char";
	margin-right:0in;
	margin-left:.25in;
	text-indent:-.25in;
	page-break-before:always;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
span.Refterm
	{mso-style-name:"Ref term";
	font-weight:bold;}
p.Example, li.Example, div.Example
	{mso-style-name:Example;
	margin-top:0in;
	margin-right:.3in;
	margin-bottom:0in;
	margin-left:.3in;
	margin-bottom:.0001pt;
	background:#E6E6E6;
	font-size:9.0pt;
	font-family:"Courier New";}
span.CODEtemp
	{mso-style-name:"CODE temp";
	font-family:"Courier New";}
p.Codesmall, li.Codesmall, div.Codesmall
	{mso-style-name:"Code small";
	margin-top:0in;
	margin-right:.3in;
	margin-bottom:0in;
	margin-left:.3in;
	margin-bottom:.0001pt;
	background:#E6E6E6;
	border:none;
	padding:0in;
	font-size:8.0pt;
	font-family:"Courier New";}
p.Examplesmall, li.Examplesmall, div.Examplesmall
	{mso-style-name:"Example small";
	margin-top:0in;
	margin-right:.3in;
	margin-bottom:0in;
	margin-left:.3in;
	margin-bottom:.0001pt;
	background:#E6E6E6;
	font-size:8.0pt;
	font-family:"Courier New";}
span.Variable
	{mso-style-name:Variable;
	font-style:italic;}
span.FootnoteTextChar
	{mso-style-name:"Footnote Text Char";
	mso-style-link:"Footnote Text";
	font-family:"Arial","sans-serif";}
p.RelatedWork, li.RelatedWork, div.RelatedWork
	{mso-style-name:"Related Work";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.75in;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.RelatedWorkCxSpFirst, li.RelatedWorkCxSpFirst, div.RelatedWorkCxSpFirst
	{mso-style-name:"Related WorkCxSpFirst";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.75in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.RelatedWorkCxSpMiddle, li.RelatedWorkCxSpMiddle, div.RelatedWorkCxSpMiddle
	{mso-style-name:"Related WorkCxSpMiddle";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.75in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.RelatedWorkCxSpLast, li.RelatedWorkCxSpLast, div.RelatedWorkCxSpLast
	{mso-style-name:"Related WorkCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.75in;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.Abstract, li.Abstract, div.Abstract
	{mso-style-name:Abstract;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.Notices, li.Notices, div.Notices
	{mso-style-name:Notices;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	page-break-before:always;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
p.TextBody, li.TextBody, div.TextBody
	{mso-style-name:"Text Body";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.AppendixHeading3, li.AppendixHeading3, div.AppendixHeading3
	{mso-style-name:AppendixHeading3;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.5in;
	text-indent:-.5in;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
span.EndnoteTextChar
	{mso-style-name:"Endnote Text Char";
	mso-style-link:"Endnote Text";
	font-family:"Arial","sans-serif";}
p.Heading1WP, li.Heading1WP, div.Heading1WP
	{mso-style-name:"Heading 1 WP";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	text-indent:0in;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;
	font-family:"Arial","sans-serif";}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
span.AppendixHeading1Char
	{mso-style-name:"AppendixHeading1 Char";
	mso-style-link:AppendixHeading1;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
span.apple-style-span
	{mso-style-name:apple-style-span;}
p.reference, li.reference, div.reference
	{mso-style-name:reference;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:89.3pt;
	text-align:justify;
	text-indent:-89.3pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.definition0, li.definition0, div.definition0
	{mso-style-name:definition;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:2.3in;
	text-indent:-2.3in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.Table, li.Table, div.Table
	{mso-style-name:Table;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
span.HTMLPreformattedChar
	{mso-style-name:"HTML Preformatted Char";
	mso-style-link:"HTML Preformatted";
	font-family:"Arial Unicode MS","sans-serif";}
p.equation, li.equation, div.equation
	{mso-style-name:equation;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:center;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.smallexample, li.smallexample, div.smallexample
	{mso-style-name:"small example";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Courier New";}
p.name, li.name, div.name
	{mso-style-name:name;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:.6in;
	text-align:justify;
	text-indent:-.6in;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
p.information, li.information, div.information
	{mso-style-name:information;
	margin-top:0in;
	margin-right:.5in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	font-size:12.0pt;
	font-family:Courier;
	color:black;}
p.headingfunction, li.headingfunction, div.headingfunction
	{mso-style-name:"heading function";
	margin-top:0in;
	margin-right:.5in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times","serif";}
p.description, li.description, div.description
	{mso-style-name:description;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.space, li.space, div.space
	{mso-style-name:space;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.title, li.title, div.title
	{mso-style-name:title;
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:center;
	font-size:16.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
p.subtitle, li.subtitle, div.subtitle
	{mso-style-name:subtitle;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:center;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	font-style:italic;}
p.element0, li.element0, div.element0
	{mso-style-name:element;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:1.0in;
	text-align:justify;
	text-indent:-.5in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.subelement, li.subelement, div.subelement
	{mso-style-name:subelement;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:1.3in;
	text-align:justify;
	text-indent:-.5in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
span.CommentTextChar
	{mso-style-name:"Comment Text Char";
	mso-style-link:"Comment Text";}
p.CFunction, li.CFunction, div.CFunction
	{mso-style-name:CFunction;
	margin-top:0in;
	margin-right:.3in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	background:#D9D9D9;
	border:none;
	padding:0in;
	font-size:12.0pt;
	font-family:"Courier New";}
p.TableSmallFont, li.TableSmallFont, div.TableSmallFont
	{mso-style-name:TableSmallFont;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	text-align:center;
	page-break-after:avoid;
	font-size:8.0pt;
	font-family:"Times New Roman","serif";}
p.Appendix1, li.Appendix1, div.Appendix1
	{mso-style-name:Appendix1;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:justify;
	text-indent:0in;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
p.Appendix2, li.Appendix2, div.Appendix2
	{mso-style-name:Appendix2;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:justify;
	text-indent:0in;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.BodyTextChar
	{mso-style-name:"Body Text Char";
	mso-style-link:"Body Text";}
span.npal
	{mso-style-name:npal;
	font-family:Palatino;}
p.numberedlist2, li.numberedlist2, div.numberedlist2
	{mso-style-name:"numbered list 2";
	margin-top:.1in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:45.0pt;
	text-align:justify;
	text-indent:-.25in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.bulletedlist2, li.bulletedlist2, div.bulletedlist2
	{mso-style-name:"bulleted list 2";
	margin-top:.1in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:45.0pt;
	text-align:justify;
	text-indent:-.25in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.bulletedlist1, li.bulletedlist1, div.bulletedlist1
	{mso-style-name:"bulleted list 1";
	margin-top:.1in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:27.0pt;
	text-align:justify;
	text-indent:-.25in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
span.DocumentMapChar
	{mso-style-name:"Document Map Char";
	mso-style-link:"Document Map";
	font-family:"Tahoma","sans-serif";
	background:navy;}
span.BodyText2Char
	{mso-style-name:"Body Text 2 Char";
	mso-style-link:"Body Text 2";}
span.Typewriter
	{mso-style-name:Typewriter;
	font-family:"Courier New";}
p.Appendix10, li.Appendix10, div.Appendix10
	{mso-style-name:"Appendix 1";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:.3in;
	text-align:justify;
	text-indent:-.3in;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
p.Preformatted, li.Preformatted, div.Preformatted
	{mso-style-name:Preformatted;
	margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Courier New";
	layout-grid-mode:line;}
p.Appendix20, li.Appendix20, div.Appendix20
	{mso-style-name:"Appendix 2";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:.4in;
	text-align:justify;
	text-indent:-.4in;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
p.Appendix, li.Appendix, div.Appendix
	{mso-style-name:Appendix;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:justify;
	text-indent:0in;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.DateChar
	{mso-style-name:"Date Char";
	mso-style-link:Date;
	font-style:italic;}
span.BodyTextIndentChar
	{mso-style-name:"Body Text Indent Char";
	mso-style-link:"Body Text Indent";}
p.Argument, li.Argument, div.Argument
	{mso-style-name:Argument;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:1.5in;
	text-align:justify;
	text-indent:-1.5in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.Step, li.Step, div.Step
	{mso-style-name:Step;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:.5in;
	text-align:justify;
	text-indent:-.5in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.Equation0, li.Equation0, div.Equation0
	{mso-style-name:Equation;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:center;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.example0, li.example0, div.example0
	{mso-style-name:example;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Courier New";}
p.paragraph, li.paragraph, div.paragraph
	{mso-style-name:paragraph;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	font-size:10.0pt;
	font-family:"Times","serif";}
p.listitem, li.listitem, div.listitem
	{mso-style-name:"list item";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:27.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:-27.0pt;
	font-size:10.0pt;
	font-family:"Times","serif";}
p.note0, li.note0, div.note0
	{mso-style-name:note;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	font-size:9.0pt;
	font-family:"Times","serif";}
p.Substep, li.Substep, div.Substep
	{mso-style-name:Substep;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:1.0in;
	text-align:justify;
	text-indent:-.5in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.syntax, li.syntax, div.syntax
	{mso-style-name:syntax;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Courier New";}
p.Appendix3, li.Appendix3, div.Appendix3
	{mso-style-name:"Appendix 3";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	text-align:justify;
	text-indent:0in;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
span.MessageHeaderChar
	{mso-style-name:"Message Header Char";
	mso-style-link:"Message Header";
	font-family:"Arial","sans-serif";
	background:#CCCCCC;}
p.ASN1, li.ASN1, div.ASN1
	{mso-style-name:"ASN\.1";
	margin-top:6.8pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	font-size:9.0pt;
	font-family:"Helvetica","sans-serif";
	font-weight:bold;}
p.ASN1Cont, li.ASN1Cont, div.ASN1Cont
	{mso-style-name:"ASN\.1 Cont\.";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:9.0pt;
	font-family:"Helvetica","sans-serif";
	font-weight:bold;}
span.BodyTextIndent3Char
	{mso-style-name:"Body Text Indent 3 Char";
	mso-style-link:"Body Text Indent 3";
	font-family:"MS Mincho";}
p.Text, li.Text, div.Text
	{mso-style-name:Text;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:127.6pt;
	margin-bottom:.0001pt;
	text-align:justify;
	font-size:11.0pt;
	font-family:"Times New Roman","serif";}
p.BoxedCode, li.BoxedCode, div.BoxedCode
	{mso-style-name:Boxed_Code;
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
span.msoIns
	{mso-style-name:"";
	text-decoration:underline;
	color:teal;}
span.msoDel
	{mso-style-name:"";
	text-decoration:line-through;
	color:red;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in .5in 1.0in;}
div.WordSection1
	{page:WordSection1;}
@page WordSection2
	{size:8.5in 11.0in;
	margin:1.0in 1.0in .5in 1.0in;}
div.WordSection2
	{page:WordSection2;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link="#0000EE" vlink=purple>

<div class=WordSection1>

<p class=MsoHeader><img width=203 height=54
src="pkcs11-base-v2.40-os_files/image001.jpg"></p>

<div style='border:none;border-top:solid gray 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=MsoTitle><span style='font-size:22.0pt'>PKCS #11 Cryptographic Token
Interface Base Specification Version 2.40</span></p>

<p class=MsoSubtitle>OASIS Standard</p>

<p class=MsoSubtitle>14 April 2015</p>

</div>

<p class=Titlepageinfo><span style='font-size:12.0pt'>Specification URIs</span></p>

<p class=Titlepageinfo>This version:</p>

<p class=TitlepageinfodescriptionCxSpFirst><span class=MsoHyperlink><span
style='color:windowtext'><a
href="http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/os/pkcs11-base-v2.40-os.doc">http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/os/pkcs11-base-v2.40-os.doc</a>
(Authoritative)</span></span></p>

<p class=TitlepageinfodescriptionCxSpMiddle><span class=MsoHyperlink><span
style='color:windowtext'><a
href="http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/os/pkcs11-base-v2.40-os.html">http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/os/pkcs11-base-v2.40-os.html</a></span></span></p>

<p class=TitlepageinfodescriptionCxSpLast><span class=MsoHyperlink><span
style='color:windowtext'><a
href="http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/os/pkcs11-base-v2.40-os.pdf">http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/os/pkcs11-base-v2.40-os.pdf</a></span></span></p>

<p class=Titlepageinfo>Previous version:</p>

<p class=TitlepageinfodescriptionCxSpFirst><span class=MsoHyperlink><a
href="http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/cs01/pkcs11-base-v2.40-cs01.doc">http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/cs01/pkcs11-base-v2.40-cs01.doc</a>
</span><span class=MsoHyperlink><span style='color:black'>(Authoritative)</span></span></p>

<p class=TitlepageinfodescriptionCxSpMiddle><span class=MsoHyperlink><a
href="http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/cs01/pkcs11-base-v2.40-cs01.html">http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/cs01/pkcs11-base-v2.40-cs01.html</a></span></p>

<p class=TitlepageinfodescriptionCxSpLast><span class=MsoHyperlink><a
href="http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/cs01/pkcs11-base-v2.40-cs01.pdf">http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/cs01/pkcs11-base-v2.40-cs01.pdf</a></span></p>

<p class=Titlepageinfo>Latest version:</p>

<p class=TitlepageinfodescriptionCxSpFirst><span style='color:#0000EE'><a
href="http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/pkcs11-base-v2.40.doc">http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/pkcs11-base-v2.40.doc</a>
</span><span style='color:black'>(Authoritative)</span></p>

<p class=TitlepageinfodescriptionCxSpMiddle><span style='color:#0000EE'><a
href="http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/pkcs11-base-v2.40.html">http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/pkcs11-base-v2.40.html</a></span></p>

<p class=TitlepageinfodescriptionCxSpLast><span style='color:#0000EE'><a
href="http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/pkcs11-base-v2.40.pdf">http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/pkcs11-base-v2.40.pdf</a></span></p>

<p class=Titlepageinfo>Technical Committee:</p>

<p class=Titlepageinfodescription><span style='color:#0000EE'><a
href="https://www.oasis-open.org/committees/pkcs11/">OASIS PKCS 11 TC</a></span></p>

<p class=Titlepageinfo>Chairs:</p>

<p class=ContributorCxSpFirst>Robert Griffin (<a
href="mailto:robert.griffin@rsa.com">robert.griffin@rsa.com</a>), <a
href="http://www.emc.com/">EMC Corporation</a></p>

<p class=ContributorCxSpLast>Valerie Fenwick (<a
href="mailto:valerie.fenwick@oracle.com">valerie.fenwick@oracle.com</a>), <a
href="http://www.oracle.com/">Oracle</a></p>

<p class=Titlepageinfo>Editors:</p>

<p class=ContributorCxSpFirst>Susan Gleeson (<a
href="mailto:susan.gleeson@oracle.com">susan.gleeson@oracle.com</a>), <a
href="http://www.oracle.com/">Oracle</a></p>

<p class=ContributorCxSpLast>Chris Zimman (<a href="mailto:chris@wmpp.com">chris@wmpp.com</a>),
Individual</p>

<p class=Titlepageinfo>Related work:</p>

<p class=Titlepageinfodescription>This specification replaces or supersedes:</p>

<p class=RelatedWork><span style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>PKCS #11 Base Functionality v2.30: Cryptoki – Draft 4. <a
href="http://www.cryptsoft.com/pkcs11doc/STANDARD/pkcs-11v2-30b-d5.doc">http://www.cryptsoft.com/pkcs11doc/STANDARD/pkcs-11v2-30b-d5.doc</a>.</p>

<p class=Titlepageinfodescription>This specification is related to:</p>

<p class=RelatedWorkCxSpFirst><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i>PKCS #11 Cryptographic Token Interface Profiles Version 2.40</i>.
Edited by Tim Hudson. <span lang=DE-CH>Latest version. </span><a
href="http://docs.oasis-open.org/pkcs11/pkcs11-profiles/v2.40/pkcs11-profiles-v2.40.html"><span
lang=DE-CH>http://docs.oasis-open.org/pkcs11/pkcs11-profiles/v2.40/pkcs11-profiles-v2.40.html</span></a><span
lang=DE-CH>.</span></p>

<p class=RelatedWorkCxSpMiddle><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i>PKCS #11 Cryptographic Token Interface Current Mechanisms
Specification Version 2.40</i>. Edited by Susan Gleeson and Chris Zimman.
Latest version. <a
href="http://docs.oasis-open.org/pkcs11/pkcs11-curr/v2.40/pkcs11-curr-v2.40.html">http://docs.oasis-open.org/pkcs11/pkcs11-curr/v2.40/pkcs11-curr-v2.40.html</a>.</p>

<p class=RelatedWorkCxSpMiddle><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i>PKCS #11 Cryptographic Token Interface Historical Mechanisms
Specification Version 2.40</i>. Edited by Susan Gleeson and Chris Zimman.
Latest version. <a
href="http://docs.oasis-open.org/pkcs11/pkcs11-hist/v2.40/pkcs11-hist-v2.40.html">http://docs.oasis-open.org/pkcs11/pkcs11-hist/v2.40/pkcs11-hist-v2.40.html</a>.</p>

<p class=RelatedWorkCxSpLast><span lang=DE-CH style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i>PKCS #11 Cryptographic Token Interface Usage Guide Version
2.40</i>. Edited by John Leiseboer and Robert Griffin. <span lang=DE-CH>Latest
version. </span><a
href="http://docs.oasis-open.org/pkcs11/pkcs11-ug/v2.40/pkcs11-ug-v2.40.html"><span
lang=DE-CH>http://docs.oasis-open.org/pkcs11/pkcs11-ug/v2.40/pkcs11-ug-v2.40.html</span></a><span
lang=DE-CH>.</span></p>

<p class=Titlepageinfo>Abstract:</p>

<p class=Abstract>This document defines data types, functions and other basic
components of the PKCS #11 Cryptoki interface.</p>

<p class=Titlepageinfo>Status:</p>

<p class=Abstract>This document was last revised or approved by the membership
of OASIS on the above date. The level of approval is also listed above. Check
the “Latest version” location noted above for possible later revisions of this document.
Any other numbered Versions and other technical work produced by the Technical Committee
(TC) are listed at <a
href="https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=pkcs11#technical">https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=pkcs11#technical</a>.</p>

<p class=Abstract>TC members should send comments on this specification to the
TC’s email list. Others should send comments to the TC’s public comment list,
after subscribing to it by following the instructions at the “<span
class=MsoHyperlink><span style='color:windowtext'><a
href="https://www.oasis-open.org/committees/comments/index.php?wg_abbrev=pkcs11">Send
A Comment</a></span></span>” button on the TC’s web page at <span
class=MsoHyperlink><span style='color:windowtext'><a
href="https://www.oasis-open.org/committees/pkcs11/">https://www.oasis-open.org/committees/pkcs11/</a></span></span><span
class=MsoHyperlink><span style='color:black'>.</span></span></p>

<p class=Abstract>For information on whether any patents have been disclosed
that may be essential to implementing this specification, and any offers of
patent licensing terms, please refer to the Intellectual Property Rights
section of the Technical Committee web page (<span class=MsoHyperlink><span
style='color:windowtext'><a
href="https://www.oasis-open.org/committees/pkcs11/ipr.php">https://www.oasis-open.org/committees/pkcs11/ipr.php</a></span></span><span
class=MsoHyperlink><span style='color:black'>).</span></span></p>

<p class=Titlepageinfo>Citation format:</p>

<p class=Abstract>When referencing this specification the following citation
format should be used:</p>

<p class=Abstract><span class=Refterm>[PKCS11-base-v2.40]</span></p>

<p class=Abstract><i>PKCS #11 Cryptographic Token Interface Base Specification
Version 2.40. </i>Edited by Susan Gleeson and Chris Zimman. 14 April 2015. OASIS
Standard. <a
href="http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/os/pkcs11-base-v2.40-os.html">http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/os/pkcs11-base-v2.40-os.html</a>.
Latest version: <a
href="http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/pkcs11-base-v2.40.html">http://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/pkcs11-base-v2.40.html</a>.</p>

<p class=Abstract>&nbsp;</p>

<div style='border:none;border-top:solid gray 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=Notices>Notices</p>

</div>

<p class=MsoNormal>Copyright © OASIS Open 2015. All Rights Reserved.</p>

<p class=MsoNormal>All capitalized terms in the following text have the
meanings assigned to them in the OASIS Intellectual Property Rights Policy (the
&quot;OASIS IPR Policy&quot;). The full <a
href="https://www.oasis-open.org/policies-guidelines/ipr">Policy</a> may be
found at the OASIS website.</p>

<p class=MsoNormal>This document and translations of it may be copied and
furnished to others, and derivative works that comment on or otherwise explain
it or assist in its implementation may be prepared, copied, published, and
distributed, in whole or in part, without restriction of any kind, provided
that the above copyright notice and this section are included on all such
copies and derivative works. However, this document itself may not be modified
in any way, including by removing the copyright notice or references to OASIS,
except as needed for the purpose of developing any document or deliverable
produced by an OASIS Technical Committee (in which case the rules applicable to
copyrights, as set forth in the OASIS IPR Policy, must be followed) or as
required to translate it into languages other than English.</p>

<p class=MsoNormal>The limited permissions granted above are perpetual and will
not be revoked by OASIS or its successors or assigns.</p>

<p class=MsoNormal>This document and the information contained herein is
provided on an &quot;AS IS&quot; basis and OASIS DISCLAIMS ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
THE INFORMATION HEREIN WILL NOT INFRINGE ANY OWNERSHIP RIGHTS OR ANY IMPLIED
WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.</p>

<p class=MsoNormal>OASIS requests that any OASIS Party or any other party that
believes it has patent claims that would necessarily be infringed by
implementations of this OASIS Committee Specification or OASIS Standard, to
notify OASIS TC Administrator and provide an indication of its willingness to
grant patent licenses to such patent claims in a manner consistent with the IPR
Mode of the OASIS Technical Committee that produced this specification.</p>

<p class=MsoNormal>OASIS invites any party to contact the OASIS TC
Administrator if it is aware of a claim of ownership of any patent claims that
would necessarily be infringed by implementations of this specification by a
patent holder that is not willing to provide a license to such patent claims in
a manner consistent with the IPR Mode of the OASIS Technical Committee that
produced this specification. OASIS may include such claims on its website, but
disclaims any obligation to do so.</p>

<p class=MsoNormal>OASIS takes no position regarding the validity or scope of
any intellectual property or other rights that might be claimed to pertain to
the implementation or use of the technology described in this document or the
extent to which any license under such rights might or might not be available;
neither does it represent that it has made any effort to identify any such
rights. Information on OASIS' procedures with respect to rights in any document
or deliverable produced by an OASIS Technical Committee can be found on the
OASIS website. Copies of claims of rights made available for publication and
any assurances of licenses to be made available, or the result of an attempt
made to obtain a general license or permission for the use of such proprietary
rights by implementers or users of this OASIS Committee Specification or OASIS
Standard, can be obtained from the OASIS TC Administrator. OASIS makes no
representation that any information or list of intellectual property rights
will at any time be complete, or that any claims in such list are, in fact,
Essential Claims.</p>

<p class=MsoNormal>The name &quot;OASIS&quot; is a trademark of <a
href="https://www.oasis-open.org/">OASIS</a>, the owner and developer of this
specification, and should be used only to refer to the organization and its
official outputs. OASIS welcomes reference to, and implementation and use of,
specifications, while reserving the right to enforce its marks against
misleading uses. Please see <span class=MsoHyperlink><a
href="https://www.oasis-open.org/policies-guidelines/trademark">https://www.oasis-open.org/policies-guidelines/trademark</a></span>
for above guidance.</p>

<p class=MsoNormal><u><span style='text-decoration:none'>&nbsp;</span></u></p>

<div style='border:none;border-top:solid gray 1.0pt;padding:1.0pt 0in 0in 0in'>

<p class=Notices>Table of Contents</p>

</div>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc416959676">1<span
style='font-size:11.0pt;font-family:"Calibri","sans-serif";color:windowtext'>        </span>Introduction<span
style='color:windowtext;display:none'>. </span><span
style='color:windowtext;display:none'>6</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959677">1.1
Terminology<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>6</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959678">1.2
Definitions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>6</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959679">1.3 Symbols
and abbreviations<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>7</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959680">1.4
Normative References<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>10</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959681">1.5
Non-Normative References<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>11</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc416959682">2<span
style='font-size:11.0pt;font-family:"Calibri","sans-serif";color:windowtext'>        </span>Platform-
and compiler-dependent directives for C or C++<span style='color:windowtext;
display:none'>. </span><span
style='color:windowtext;display:none'>13</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959683">2.1
Structure packing<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>13</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959684">2.2
Pointer-related macros<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>13</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc416959685">3<span
style='font-size:11.0pt;font-family:"Calibri","sans-serif";color:windowtext'>        </span>General
data types<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>15</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959686">3.1 General
information<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>15</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959687">3.2 Slot and
token types<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>16</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959688">3.3 Session
types<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>22</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959689">3.4 Object
types<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>23</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959690">3.5 Data
types for mechanisms<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>27</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959691">3.6 Function
types<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>29</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959692">3.7
Locking-related types<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>32</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc416959693">4<span
style='font-size:11.0pt;font-family:"Calibri","sans-serif";color:windowtext'>        </span>Objects<span
style='color:windowtext;display:none'>. </span><span
style='color:windowtext;display:none'>35</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959694">4.1
Creating, modifying, and copying objects<span style='color:windowtext;
display:none'>. </span><span
style='color:windowtext;display:none'>36</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959695">4.1.1
Creating objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>36</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959696">4.1.2
Modifying objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>37</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959697">4.1.3
Copying objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>37</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959698">4.2 Common
attributes<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>38</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959699">4.3 Hardware
Feature Objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>38</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959700">4.3.1
Definitions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>38</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959701">4.3.2
Overview<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>38</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959702">4.3.3 Clock<span
style='color:windowtext;display:none'>. </span><span
style='color:windowtext;display:none'>39</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959703">4.3.4
Monotonic Counter Objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>39</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959704">4.3.5 User
Interface Objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>39</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959705">4.4 Storage
Objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>40</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959706">4.5 Data
objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>41</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959707">4.5.1
Definitions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>41</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959708">4.5.2
Overview<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>41</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959709">4.6
Certificate objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>42</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959710">4.6.1
Definitions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>42</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959711">4.6.2
Overview<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>42</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959712">4.6.3 X.509
public key certificate objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>43</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959713">4.6.4 WTLS
public key certificate objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>45</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959714">4.6.5 X.509
attribute certificate objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>47</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959715">4.7 Key
objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>48</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959716">4.7.1
Definitions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>48</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959717">4.7.2
Overview<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>48</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959718">4.8 Public
key objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>49</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959719">4.9 Private
key objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>50</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959720">4.9.1 RSA
private key objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>52</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959721">4.10 Secret
key objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>53</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959722">4.11 Domain
parameter objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>56</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959723">4.11.1
Definitions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>56</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959724">4.11.2
Overview<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>56</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959725">4.12
Mechanism objects<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>56</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959726">4.12.1
Definitions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>56</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959727">4.12.2
Overview<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>56</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc416959728">5<span
style='font-size:11.0pt;font-family:"Calibri","sans-serif";color:windowtext'>        </span>Functions<span
style='color:windowtext;display:none'>. </span><span
style='color:windowtext;display:none'>58</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959729">5.1 Function
return values<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>61</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959730">5.1.1
Universal Cryptoki function return values<span style='color:windowtext;
display:none'>. </span><span
style='color:windowtext;display:none'>61</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959731">5.1.2
Cryptoki function return values for functions that use a session handle<span
style='color:windowtext;display:none'>. </span><span
style='color:windowtext;display:none'>62</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959732">5.1.3
Cryptoki function return values for functions that use a token<span
style='color:windowtext;display:none'>. </span><span
style='color:windowtext;display:none'>62</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959733">5.1.4
Special return value for application-supplied callbacks<span style='color:windowtext;
display:none'>. </span><span
style='color:windowtext;display:none'>62</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959734">5.1.5
Special return values for mutex-handling functions<span style='color:windowtext;
display:none'>. </span><span
style='color:windowtext;display:none'>63</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959735">5.1.6 All
other Cryptoki function return values<span style='color:windowtext;display:
none'>. </span><span
style='color:windowtext;display:none'>63</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959736">5.1.7 More
on relative priorities of Cryptoki errors<span style='color:windowtext;
display:none'>. </span><span
style='color:windowtext;display:none'>68</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959737">5.1.8 Error
code “gotchas”<span style='color:windowtext;display:none'> </span><span style='color:windowtext;display:none'>68</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959738">5.2
Conventions for functions returning output in a variable-length buffer<span
style='color:windowtext;display:none'> </span><span
style='color:windowtext;display:none'>68</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959739">5.3
Disclaimer concerning sample code<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>69</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959740">5.4
General-purpose functions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>69</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959741">5.5 Slot and
token management functions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>72</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959742">5.6 Session
management functions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>81</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959743">5.7 Object
management functions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>89</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959744">5.8
Encryption functions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>98</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959745">5.9
Decryption functions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>102</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959746">5.10 Message
digesting functions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>105</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959747">5.11 Signing
and MACing functions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>108</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959748">5.12
Dual-function cryptographic functions<span style='color:windowtext;display:
none'>. </span><span
style='color:windowtext;display:none'>116</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959749">5.13 Key
management functions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>127</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959750">5.14 Random
number generation functions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>135</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959751">5.15
Parallel function management functions<span style='color:windowtext;display:
none'>. </span><span
style='color:windowtext;display:none'>136</span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc416959752">5.16
Callback functions<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>137</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959753">5.16.1
Surrender callbacks<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>137</span></a></span></p>

<p class=MsoToc3><span class=MsoHyperlink><a href="#_Toc416959754">5.16.2
Vendor-defined callbacks<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>137</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc416959755">6<span
style='font-size:11.0pt;font-family:"Calibri","sans-serif";color:windowtext'>        </span>PKCS
#11 Implementation Conformance<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>138</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc416959756">Appendix A.<span
style='font-size:11.0pt;font-family:"Calibri","sans-serif";color:windowtext'>       </span>Acknowledgments<span
style='color:windowtext;display:none'>. </span><span
style='color:windowtext;display:none'>139</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc416959757">Appendix B.<span
style='font-size:11.0pt;font-family:"Calibri","sans-serif";color:windowtext'>       </span>Manifest
constants<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>142</span></a></span></p>

<p class=MsoToc1><span class=MsoHyperlink><a href="#_Toc416959758">Appendix C.<span
style='font-size:11.0pt;font-family:"Calibri","sans-serif";color:windowtext'>       </span>Revision
History<span style='color:windowtext;display:none'>. </span><span style='color:windowtext;display:none'>149</span></a></span></p>

<p class=TextBody>&nbsp;</p>

<p class=TextBody>&nbsp;</p>

</div>

<span style='font-size:10.0pt;font-family:"Arial","sans-serif"'><br clear=all
style='page-break-before:always'>
</span>

<div class=WordSection2>

<div style='border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in'>

<h1><a name="_Toc416959676"></a><a name="_Toc395183749"></a><a
name="_Toc391468753"></a><a name="_Toc370633959">1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Introduction</a></h1>

</div>

<p class=MsoNormal><a name="_Toc287332007"></a><a name="_Toc85472893">This
document describes the basic PKCS#11 token interface and token behavior.</a></p>

<p class=MsoNormal>The PKCS#11 standard specifies an application programming
interface (API), called “Cryptoki,” for devices that hold cryptographic
information and perform cryptographic functions.  Cryptoki follows a simple
object based approach, addressing the goals of technology independence (any
kind of device) and resource sharing (multiple applications accessing multiple
devices), presenting to applications a common, logical view of the device
called a “cryptographic token”.</p>

<p class=MsoNormal>This document specifies the data types and functions
available to an application requiring cryptographic services using the ANSI C
programming language.  The supplier of a Cryptoki library implementation
typically provides these data types and functions via ANSI C header files. 
Generic ANSI C header files for Cryptoki are available from the PKCS#11 web
page.  This document and up-to-date errata for Cryptoki will also be available
from the same place.</p>

<p class=MsoNormal>Additional documents may provide a generic, language-independent
Cryptoki interface and/or bindings between Cryptoki and other programming
languages.</p>

<p class=MsoNormal>Cryptoki isolates an application from the details of the
cryptographic device.  The application does not have to change to interface to
a different type of device or to run in a different environment; thus, the
application is portable.  How Cryptoki provides this isolation is beyond the
scope of this document, although some conventions for the support of multiple
types of device will be addressed here and possibly in a separate document.</p>

<p class=MsoNormal>Details of cryptographic mechanisms (algorithms) may be
found in the associated PKCS#11 Mechanisms documents.</p>

<h2><a name="_Toc416959677"></a><a name="_Toc395183750"></a><a
name="_Toc391468754"></a><a name="_Toc370633960">1.1 Terminology</a></h2>

<p class=MsoNormal>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”,
“SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in
this document are to be interpreted as described in <span
class=Refterm><span style='font-size:12.0pt'>[RFC2119]</span></span>.</p>

<h2><a name="_Toc416959678"></a><a name="_Toc395183751"></a><a
name="_Toc391468755"></a><a name="_Toc370633961">1.2 Definitions</a></h2>

<p class=MsoNormal>For the purposes of this standard, the following definitions
apply:</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                           API</b>       Application
programming interface.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                              Application</b>       Any
computer program that calls the Cryptoki interface.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                       ASN.1</b>       Abstract
Syntax Notation One, as defined in X.680.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                   Attribute       </b>A
characteristic of an object.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                         BER</b>       Basic
Encoding Rules, as defined in X.690.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                         CBC       </b>Cipher-Block
Chaining mode, as defined in FIPS PUB 81.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                 Certificate</b>       A
signed message binding a subject name and a public key, or a subject name and a
set of attributes.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                         CMS       </b>Cryptographic
Message Syntax (see RFC 5652)</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>               Cryptographic
Device</b>       A device storing cryptographic information and possibly performing
cryptographic functions.  May be implemented as a smart card, smart disk,
PCMCIA card, or with some other technology, including software-only.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                   Cryptoki       </b>The
Cryptographic Token Interface defined in this standard.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                        Cryptoki
library</b>       A library that implements the functions specified in this
standard.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                         DER</b>       Distinguished
Encoding Rules, as defined in X.690.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                         DES       </b>Data
Encryption Standard, as defined in FIPS PUB 46-3.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                         DSA       </b>Digital
Signature Algorithm, as defined in FIPS PUB 186-4.</p>

<p class=definition0 style='margin-bottom:6.0pt'>                                            <b>EC</b>       Elliptic
Curve</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                         ECB</b>       Electronic
Codebook mode, as defined in FIPS PUB 81.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                             IV       </b>Initialization
Vector.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                         MAC</b>       Message
Authentication Code.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                              Mechanism</b>       A
process for implementing a cryptographic operation.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                      Object</b>       An
item that is stored on a token.  May be data, a certificate, or a key.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                           PIN</b>       Personal
Identification Number.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                       PKCS</b>       Public-Key
Cryptography Standards.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                          PRF</b>       Pseudo
random function.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                          PTD       </b>Personal
Trusted Device, as defined in MeT-PTD</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                         RSA</b>       The
RSA public-key cryptosystem.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                     Reader</b>       The
means by which information is exchanged with a device.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                    Session</b>       A
logical connection between an application and a token.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                          Slot</b>       A
logical reader that potentially contains a token.</p>

<p class=definition0 style='margin-bottom:6.0pt'>                                          <b>SSL</b>       The
Secure Sockets Layer 3.0 protocol.</p>

<p class=definition0 style='margin-bottom:6.0pt'>                           <b>Subject
Name</b>       The X.500 distinguished name of the entity to which a key is assigned.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                           SO</b>       A
Security Officer user.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                          TLS</b>       Transport
Layer Security.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                       Token</b>       The
logical view of a cryptographic device defined by Cryptoki.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                         User</b>       The
person using an application that interfaces to Cryptoki.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                       UTF-8       </b>Universal
Character Set (UCS) transformation format (UTF) that represents ISO 10646 and
UNICODE strings with a variable number of octets.</p>

<p class=definition0 style='margin-bottom:6.0pt'><b>                                         WIM</b>       Wireless
Identification Module.</p>

<p class=definition0><b>                                       WTLS</b>       Wireless
Transport Layer Security.</p>

<p class=definition0>&nbsp;</p>

<h2><a name="_Toc416959679"></a><a name="_Toc395183752"></a><a
name="_Toc391468756"></a><a name="_Toc370633962"></a><a name="_Toc235002204"></a><a
name="_Toc72655990"></a><a name="_Toc405794607"></a><a name="_Toc385057786"></a><a
name="_Toc383864799"></a><a name="_Toc323610788"></a><a name="_Toc323205359"></a><a
name="_Toc323024028"></a><a name="_Toc323000668"></a><a name="_Toc322945055"></a><a
name="_Toc322855259"></a><a name="_Ref320327683"></a><a name="_Toc319315662"></a><a
name="_Toc319313669"></a><a name="_Toc319313476"></a><a name="_Toc319287635">1.3
Symbols and abbreviations</a></h2>

<p class=MsoNormal style='page-break-after:avoid'>The following symbols are
used in this standard:</p>

<p class=MsoCaption><a name="_Toc225305933"></a><a name="_Toc405794963">Table </a>1, Symbols</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td valign=top style='border:solid windowtext 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b>Symbol</b></p>
  </td>
  <td valign=top style='border:solid windowtext 1.0pt;border-left:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b>Definition</b></p>
  </td>
 </tr>
 <tr>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>N/A</p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Not applicable</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>R/O</p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Read-only</p>
  </td>
 </tr>
 <tr>
  <td valign=top style='border:solid windowtext 1.0pt;border-top:none;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>R/W</p>
  </td>
  <td valign=top style='border-top:none;border-left:none;border-bottom:solid windowtext 1.0pt;
  border-right:solid windowtext 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Read/write</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:12.0pt;page-break-after:avoid'>The
following prefixes are used in this standard:</p>

<p class=MsoCaption><a name="_Toc225305934"></a><a name="_Toc405794964">Table </a>2, Prefixes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=62 valign=top style='width:46.55pt;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-family:
   "Arial","sans-serif"'>Prefix</span></b></p>
   </td>
   <td width=220 valign=top style='width:164.95pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-family:
   "Arial","sans-serif"'>Description</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Function</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Data
  type or general constant</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Attribute</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKC_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Certificate
  type</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKD_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Key
  derivation function</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span lang=SV style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKF_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span lang=SV style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Bit
  flag</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKG_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Mask
  generation function</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKH_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Hardware
  feature type</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKK_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Key
  type</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKM_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Mechanism
  type</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKN_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Notification</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKO_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Object
  class</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKP_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Pseudo-random
  function</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKS_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Session
  state</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKR_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Return
  value</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKU_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>User
  type</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKZ_</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Salt/Encoding
  parameter source</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>h</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>a
  handle</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>ul</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>a
  CK_ULONG</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>p</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>a
  pointer</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>pb</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>a
  pointer to a CK_BYTE</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>ph</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>a
  pointer to a handle</span></p>
  </td>
 </tr>
 <tr>
  <td width=62 valign=top style='width:46.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>pul</span></p>
  </td>
  <td width=220 valign=top style='width:164.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>a
  pointer to a CK_ULONG</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Cryptoki is based on ANSI C types, and defines the following
data types<a name="CK_BYTE"></a>:</p>

<p class=MsoNormal>&nbsp;</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>/* an
unsigned 8-bit value */</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
unsigned char CK_BYTE;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>/* an
unsigned 8-bit character */</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_BYTE CK_CHAR;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>/* an
8-bit UTF-8 character */</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_BYTE CK_UTF8CHAR;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>/* a
BYTE-sized Boolean flag */</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_BYTE CK_BBOOL;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>/* an
unsigned value, at least 32 bits long */</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
unsigned long int CK_ULONG;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>/* a
signed value, the same size as a CK_ULONG */</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
long int CK_LONG;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>/* at
least 32 bits; each bit is a Boolean flag */</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_ULONG CK_FLAGS;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>Cryptoki also uses pointers to some of these data types, as
well as to the type void, which are implementation-dependent.  These pointer
types are:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_BYTE_PTR     
/* Pointer to a CK_BYTE */</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_CHAR_PTR     
/* Pointer to a CK_CHAR */</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_UTF8CHAR_PTR 
/* Pointer to a CK_UTF8CHAR */ </p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_ULONG_PTR    
/* Pointer to a CK_ULONG */</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_VOID_PTR     
/* Pointer to a void */</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>Cryptoki also defines a pointer to a CK_VOID_PTR, which is
implementation-dependent:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_VOID_PTR_PTR 
/* Pointer to a CK_VOID_PTR */</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>In addition, Cryptoki defines a C-style NULL pointer, which
is distinct from any valid pointer:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>NULL_PTR        
/* A NULL pointer */</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>It follows that many of the data and pointer types will vary
somewhat from one environment to another (<i>e.g.</i>, a CK_ULONG will
sometimes be 32 bits, and sometimes perhaps 64 bits).  However, these details
should not affect an application, assuming it is compiled with Cryptoki header
files consistent with the Cryptoki library to which the application is linked.</p>

<p class=MsoNormal>All numbers and values expressed in this document are
decimal, unless they are preceded by “0x”, in which case they are hexadecimal
values.</p>

<p class=MsoNormal>The <b>CK_CHAR</b> data type holds characters from the
following table, taken from ANSI C:</p>

<p class=MsoCaption><a name="_Toc225305935"></a><a name="_Toc405794965"></a><a
name="_Toc383864504"></a><a name="_Toc323204874"></a><a name="_Ref320504353"></a><a
name="_Ref383947636">Table </a>3, Character Set</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=138 valign=top style='width:103.5pt;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Category</span></b></p>
   </td>
   <td width=396 valign=top style='width:297.0pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Characters</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=138 valign=top style='width:103.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Letters</span></p>
  </td>
  <td width=396 valign=top style='width:297.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>A B C D E F G H I J K L M N O P Q R S T U V
  W X Y Z a b c d e f g h i j k l m n o p q r s t u v w x y z</span></p>
  </td>
 </tr>
 <tr>
  <td width=138 valign=top style='width:103.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Numbers</span></p>
  </td>
  <td width=396 valign=top style='width:297.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0 1 2 3 4 5 6 7 8 9</span></p>
  </td>
 </tr>
 <tr>
  <td width=138 valign=top style='width:103.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Graphic characters</span></p>
  </td>
  <td width=396 valign=top style='width:297.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>! “ # % &amp; ‘ ( ) * + , - . / : ; &lt; =
  &gt; ? [ \ ] ^ _ { | } ~</span></p>
  </td>
 </tr>
 <tr>
  <td width=138 valign=top style='width:103.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Blank
  character</span></p>
  </td>
  <td width=396 valign=top style='width:297.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>‘
  ‘</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>The <b>CK_UTF8CHAR</b> data type holds UTF-8 encoded Unicode
characters as specified in RFC2279. UTF-8 allows internationalization while
maintaining backward compatibility with the Local String definition of PKCS #11
version 2.01. </p>

<p class=MsoNormal>In Cryptoki, the <b>CK_BBOOL</b> data type is a Boolean type
that can be true or false.  A zero value means false, and a nonzero value means
true.  Similarly, an individual bit flag, <b>CKF_</b>..., can also be set
(true) or unset (false). For convenience, Cryptoki defines the following macros
for use with values of type <b>CK_BBOOL</b>:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>#define
CK_FALSE 0</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>#define
CK_TRUE  1</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9'><span style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>For backwards compatibility, header files for this version
of Cryptoki also define TRUE and FALSE as (CK_DISABLE_TRUE_FALSE may be set by
the application vendor):</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>#ifndef
CK_DISABLE_TRUE_FALSE</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>#ifndef
FALSE</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>#define
FALSE CK_FALSE</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>#endif</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>#ifndef
TRUE</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>#define
TRUE CK_TRUE</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>#endif</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>#endif</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<h2><a name="_Toc416959680"></a><a name="_Toc395183753"></a><a
name="_Toc391468757"></a><a name="_Toc370633963"></a><a name="_Toc287332008"></a><a
name="_Toc85472894"></a><a name="_Toc12011611"></a><a name="_Ref7502892">1.4 Normative</a>
References</h2>

<p class=Ref style='margin-left:0in;text-indent:.25in'><b> [FIPS PUB 46-3]</b>     NIST. 
<i>FIPS 46-3: Data Encryption Standard.  </i><span lang=SV>October 1999. </span></p>

<p class=Ref style='text-indent:0in'><span lang=SV>URL:  <a
href="http://csrc.nist.gov/publications/fips/fips46-3/fips46-3.pdf">http://csrc.nist.gov/publications/fips/fips46-3/fips46-3.pdf</a></span></p>

<p class=Ref><b>[FIPS PUB 81]</b>        NIST.  <i>FIPS 81: DES Modes of
Operation.  </i><span lang=SV>December 1980. </span></p>

<p class=Ref style='text-indent:0in'><span lang=SV>URL:  <a
href="http://csrc.nist.gov/publications/fips/fips81/fips81.htm">http://csrc.nist.gov/publications/fips/fips81/fips81.htm</a></span></p>

<p class=Ref><b>[FIPS PUB 186-4]    </b>NIST.  FIPS 186-4:  Digital Signature
Standard.  July, 2013.</p>

<p class=Ref><b>                              </b>URL:  <a
href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf</a></p>

<p class=Ref><b><span style='color:windowtext'>[PKCS11-Curr]</span></b><span
class=Refterm><span style='font-weight:normal'>        <i>PKCS #11
Cryptographic Token Interface Current Mechanisms Specification Version 2.40</i>.
Edited by Susan Gleeson and Chris Zimman. 14 April 2015. OASIS Standard. <a
href="http://docs.oasis-open.org/pkcs11/pkcs11-curr/v2.40/os/pkcs11-curr-v2.40-os.html">http://docs.oasis-open.org/pkcs11/pkcs11-curr/v2.40/os/pkcs11-curr-v2.40-os.html</a>.
Latest version: <a
href="http://docs.oasis-open.org/pkcs11/pkcs11-curr/v2.40/pkcs11-curr-v2.40.html">http://docs.oasis-open.org/pkcs11/pkcs11-curr/v2.40/pkcs11-curr-v2.40.html</a>.</span></span></p>

<p class=Ref><b><span style='color:#3B006F'> </span></b><b><span
style='color:windowtext'>[PKCS11-Hist]</span></b><span class=Refterm><span
style='font-weight:normal'>        <i>PKCS #11 Cryptographic Token Interface
Historical Mechanisms Specification Version 2.40</i>. Edited by Susan Gleeson
and Chris Zimman. 14 April 2015. OASIS Standard. <a
href="http://docs.oasis-open.org/pkcs11/pkcs11-hist/v2.40/os/pkcs11-hist-v2.40-os.html">http://docs.oasis-open.org/pkcs11/pkcs11-hist/v2.40/os/pkcs11-hist-v2.40-os.html</a>.
Latest version: <a
href="http://docs.oasis-open.org/pkcs11/pkcs11-hist/v2.40/pkcs11-hist-v2.40.html">http://docs.oasis-open.org/pkcs11/pkcs11-hist/v2.40/pkcs11-hist-v2.40.html</a>.</span></span></p>

<p class=Ref><b><span style='color:windowtext'> [PKCS11-Prof]</span></b><span
class=Refterm><span style='font-weight:normal'>       <i>PKCS #11 Cryptographic
Token Interface Profiles Version 2.40</i>. Edited by Tim Hudson. 14 April 2015.
OASIS Standard. <a
href="http://docs.oasis-open.org/pkcs11/pkcs11-profiles/v2.40/os/pkcs11-profiles-v2.40-os.html">http://docs.oasis-open.org/pkcs11/pkcs11-profiles/v2.40/os/pkcs11-profiles-v2.40-os.html</a>.
Latest version: <a
href="http://docs.oasis-open.org/pkcs11/pkcs11-profiles/v2.40/pkcs11-profiles-v2.40.html">http://docs.oasis-open.org/pkcs11/pkcs11-profiles/v2.40/pkcs11-profiles-v2.40.html</a>.</span></span></p>

<p class=Ref><b> [PKCS #1]</b>              RSA Laboratories.  <i>RSA
Cryptography Standard. </i> v2.1, June 14, 2002.</p>

<p class=Ref>                              URL: 
ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-1/pkcs-1v2-1.pdf </p>

<p class=Ref><b>[PKCS #3]</b>               RSA Laboratories.  <i>Diffie-Hellman
Key-Agreement Standard.</i>  v1.4, November 1993. </p>

<p class=Ref><b>                              </b>URL: 
ftp://ftp.rsasecurity.com/pub/pkcs/doc/pkcs-3.doc</p>

<p class=Ref><b>[PKCS #5]</b>               RSA Laboratories.  <i>Password-Based
Encryption Standard</i>.  v2.0, March 25, 1999 </p>

<p class=Ref><b>                              </b>URL:  ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-5v2/pkcs5v2-0.pdf</p>

<p class=Ref><b><span lang=FR-CH>[PKCS #7]               </span></b><span
lang=FR-CH>RSA </span><span lang=FR>Laboratories.  <i>Cryptographic Message
Syntax Standard.</i>  </span>v1.5, November 1993</p>

<p class=Ref><b>                              </b>URL&nbsp;: 
ftp://ftp.rsasecurity.com/pub/pkcs/doc/pkcs-7.doc</p>

<p class=Ref><b>[PKCS #8]</b>               RSA Laboratories.  <i>Private-Key
Information Syntax Standard</i>.  v1.2, November 1993. </p>

<p class=Ref><b>                              </b>URL:  ftp://ftp.rsasecurity.com/pub/pkcs/doc/pkcs-8.doc</p>

<p class=Ref><b><span style='color:windowtext'>[PKCS11-UG]</span></b><span
class=Refterm><span style='font-weight:normal'>          </span></span><i>PKCS
#11 Cryptographic Token Interface Usage Guide Version 2.40</i>. Edited by John
Leiseboer and Robert Griffin. 16 November 2014. OASIS Committee Note 02. <a
href="http://docs.oasis-open.org/pkcs11/pkcs11-ug/v2.40/cn02/pkcs11-ug-v2.40-cn02.html">http://docs.oasis-open.org/pkcs11/pkcs11-ug/v2.40/cn02/pkcs11-ug-v2.40-cn02.html</a>.
Latest version: <a
href="http://docs.oasis-open.org/pkcs11/pkcs11-ug/v2.40/pkcs11-ug-v2.40.html">http://docs.oasis-open.org/pkcs11/pkcs11-ug/v2.40/pkcs11-ug-v2.40.html</a>.
</p>

<p class=Ref><b><span lang=FR-CH>[PKCS #12]</span></b><span lang=FR-CH>             RSA
Laboratories.  <i>Personal</i></span><i><span lang=FR> Information Exchange
Syntax Standard</span></i><span lang=FR>.  </span>v1.0,  June 1999.</p>

<p class=Ref><a name=rfc2119><span class=Refterm>[RFC2119]</span></a>               Bradner,
S., “Key words for use in RFCs to Indicate Requirement Levels”, BCP 14, RFC
2119, March 1997. </p>

<p class=Ref style='text-indent:0in'><span lang=FR-CH>URL:  </span><a
href="http://www.ietf.org/rfc/rfc2119.txt"><span lang=FR-CH>http://www.ietf.org/rfc/rfc2119.txt</span></a><span
lang=FR-CH>.</span></p>

<p class=Ref><b><span lang=FR-CH>[RFC 2279]</span></b><span lang=FR-CH>              F.
Yergeau.  </span><i>RFC 2279: </i>UTF-8, a transformation format of ISO 10646
Alis Technologies, January 1998.<span lang=EN-AU> URL: </span><a
href="http://ietf.org/rfc/rfc2279.txt"><span lang=EN-AU>http://www.ietf.org/rfc/rfc2279.txt</span></a></p>

<p class=Ref><b><span lang=EN-AU>[RFC 2534]</span></b><span lang=EN-AU>              Masinter,
L., Wing, D., Mutz, A., and K. Holtman. <i>RFC 2534: Media Features for
Display, Print, and Fax.</i> March 1999. URL: <a
href="http://ietf.org/rfc/rfc2534.txt">http://www.ietf.org/rfc/rfc2534.txt</a></span></p>

<p class=Ref><b>[TLS]</b>                      IETF. <i>RFC 2246: The TLS
Protocol Version 1.0 .</i> January 1999. </p>

<p class=Ref style='text-indent:0in'>URL:  <u><a href="http://www.ietf.org/"><span
lang=EN-AU>http://www.ietf.org/rfc/rfc2246.txt</span></a></u></p>

<p class=Ref><b>[RFC 5652]              </b><span lang=EN-AU>R.</span> Housley.
<i>RFC 5652: Cryptographic Message Syntax</i>. Septmber 2009. URL: <span
lang=IT><a href="http://www.ietf.org/rfc/rfc5652.txt"><span lang=EN-US>http://www.ietf.org/rfc/rfc5652.txt</span></a></span></p>

<p class=Ref><b>[X.500]</b>                    ITU-T. Information Technology —
Open Systems Interconnection — The Directory: Overview of Concepts, Models and
Services.  February 2001. Identical to ISO/IEC 9594-1</p>

<p class=Ref><b>[X.509]</b>                    ITU-T. Information Technology —
Open Systems Interconnection — The Directory: Public-key and Attribute
Certificate Frameworks.  March 2000.</p>

<p class=Ref>                              Identical to ISO/IEC 9594-8</p>

<p class=Ref><b>[X.680]</b>                    ITU-T. Information Technology —
Abstract Syntax Notation One (ASN.1): Specification of Basic Notation.  July
2002.</p>

<p class=Ref>                              Identical to ISO/IEC 8824-1</p>

<p class=Ref><b>[X.690]</b>                    ITU-T. Information Technology —
ASN.1 Encoding Rules: Specification of Basic Encoding Rules (BER), Canonical
Encoding Rules (CER), and Distinguished Encoding Rules (DER).  July 2002.</p>

<p class=Ref>                              Identical to ISO/IEC 8825-1</p>

<p class=Ref style='margin-left:0in;text-indent:0in'>&nbsp;</p>

<h2><a name="_Toc416959681"></a><a name="_Toc395183754"></a><a
name="_Toc391468758"></a><a name="_Toc370633964"></a><a name="_Toc287332009"></a><a
name="_Toc85472895">1.5 Non-Normative References</a></h2>

<p class=Ref><b>[ANSI C]</b>                 ANSI/ISO.  American National
Standard for Programming Languages – C.  1990.</p>

<p class=Ref><b>[CC/PP]</b>                  W3C. <i>Composite
Capability/Preference Profiles (CC/PP): Structure and Vocabularies</i>. World
Wide Web Consortium, January 2004. </p>

<p class=Ref style='text-indent:0in'>URL:  <a
href="http://www.w3.org/TR/CCPP-struct-vocab/">http://www.w3.org/TR/CCPP-struct-vocab/</a></p>

<p class=Ref><b>[CDPD</b>]                   Ameritech Mobile Communications et
al.  Cellular Digital Packet Data System Specifications: Part 406: Airlink
Security.  1993.</p>

<p class=Ref><b> [GCS-API]</b>              X/Open Company Ltd.  Generic
Cryptographic Service API (GCS-API), Base - Draft 2.  February 14, 1995.</p>

<p class=Ref><b>[ISO/IEC 7816-1]</b>     ISO. Information Technology —
Identification Cards — Integrated Circuit(s) with Contacts — Part 1: Physical
Characteristics.  1998.</p>

<p class=Ref><b>[ISO/IEC 7816-4]</b>     ISO. Information Technology —
Identification Cards — Integrated Circuit(s) with Contacts — Part 4:
Interindustry Commands for Interchange.  1995.</p>

<p class=Ref><b>[ISO/IEC 8824-1]</b>     ISO. Information Technology-- Abstract
Syntax Notation One (ASN.1): Specification of Basic Notation.  2002.</p>

<p class=Ref><b>[ISO/IEC 8825-1]</b>     ISO. Information Technology—ASN.1
Encoding Rules: Specification of Basic Encoding Rules (BER), Canonical Encoding
Rules (CER), and Distinguished Encoding Rules (DER).  2002.</p>

<p class=Ref><b>[ISO/IEC 9594-1]</b>     ISO. Information Technology — Open
Systems Interconnection — The Directory: Overview of Concepts, Models and
Services.  2001.</p>

<p class=Ref><b>[ISO/IEC 9594-8]</b>     ISO. Information Technology — Open
Systems Interconnection — The Directory: Public-key and Attribute Certificate
Frameworks.  2001</p>

<p class=Ref><b>[ISO/IEC 9796-2]</b>     ISO.  Information Technology —
Security Techniques — Digital Signature Scheme Giving Message Recovery — Part
2: Integer factorization based mechanisms.  2002.</p>

<p class=Ref>&nbsp;</p>

<p class=Ref><b>[Java MIDP]</b>            Java Community Process.  <i>Mobile
Information Device Profile for Java 2 Micro Edition.</i> November 2002. </p>

<p class=Ref style='text-indent:0in'>URL: <a
href="http://jcp.org/jsr/detail/118.jsp">http://jcp.org/jsr/detail/118.jsp</a></p>

<p class=Ref><b>[MeT-PTD]</b>              MeT. <i>MeT PTD Definition –
Personal Trusted Device Definition</i>, Version 1.0, February 2003. </p>

<p class=Ref style='text-indent:0in'>URL: <span lang=SV><a
href="http://www.mobiletransaction.org/"><span lang=EN-US>http://www.mobiletransaction.org</span></a></span></p>

<p class=Ref><b>[PCMCIA]</b>               Personal Computer Memory Card
International Association.  <i>PC Card Standard,</i>  Release 2.1,. July 1993.</p>

<p class=Ref><b>[SEC 1]</b>                   Standards for Efficient
Cryptography Group (SECG).  <i>Standards for Efficient Cryptography (SEC) 1:
Elliptic Curve Cryptography</i>.  Version 1.0, September 20, 2000.</p>

<p class=Ref><b>[SEC 2]</b>                   Standards for Efficient
Cryptography Group (SECG).  Standards for Efficient Cryptography (SEC) 2:
Recommended Elliptic Curve Domain Parameters.  Version 1.0, September 20, 2000.</p>

<p class=Ref><b>[WIM]</b>                     WAP. <i>Wireless Identity Module.
</i><i>— WAP-260-WIM-20010712-a. </i>July 2001. </p>

<p class=Ref style='text-indent:0in'>URL:  <a
href="http://technical.openmobilealliance.org/tech/affiliates/LicenseAgreement.asp?DocName=/wap/wap-260-wim-20010712-a.pdf">http://technical.openmobilealliance.org/tech/affiliates/LicenseAgreement.asp?DocName=/wap/wap-260-wim-20010712-a.pdf</a></p>

<p class=Ref><b>[WPKI]</b>                    Wireless Application Protocol:
Public Key Infrastructure Definition<i>. </i><i>— WAP-217-WPKI-20010424-a</i>. <span
lang=SV>April 2001. </span></p>

<p class=Ref style='text-indent:0in'><span lang=SV>URL: <a
href="http://technical.openmobilealliance.org/tech/affiliates/LicenseAgreement.asp?DocName=/wap/wap-217-wpki-20010424-a.pdf">http://technical.openmobilealliance.org/tech/affiliates/LicenseAgreement.asp?DocName=/wap/wap-217-wpki-20010424-a.pdf</a></span></p>

<p class=Ref><b>[WTLS]</b>                   WAP. <i>Wireless Transport Layer
Security Version </i><i>— WAP-261-WTLS-20010406-a.</i> April 2001. </p>

<p class=Ref style='text-indent:0in'>URL:  <a
href="http://technical.openmobilealliance.org/tech/affiliates/LicenseAgreement.asp?DocName=/wap/wap-261-wtls-20010406-a.pdf">http://technical.openmobilealliance.org/tech/affiliates/LicenseAgreement.asp?DocName=/wap/wap-261-wtls-20010406-a.pdf</a></p>

<p class=Ref>&nbsp;</p>

<p class=Ref>&nbsp;</p>

<div style='border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in'>

<h1><a name="_Toc405794626"></a><a name="_Toc385057803"></a><a
name="_Toc383864814"></a><a name="_Toc323610800"></a><a name="_Toc323205371"></a><a
name="_Toc323024040"></a><a name="_Toc323000680"></a><a name="_Toc322945097"></a><a
name="_Toc322855271"></a><a name="_Toc319315675"></a><a name="_Toc319313682"></a><a
name="_Toc319313489"></a><a name="_Toc319287648"></a><a name="_Toc416959682"></a><a
name="_Toc395183755"></a><a name="_Toc391468759"></a><a name="_Toc370633965"></a><a
name="_Toc235002225"></a><a name="_Toc72656010"></a><a name="_Ref406237056"></a><a
name=Functions></a>2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Platform- and compiler-dependent directives for C or C++</h1>

</div>

<p class=MsoNormal>There is a large array of Cryptoki-related data types that
are defined in the Cryptoki header files. Certain packing and pointer-related
aspects of these types are platform and compiler-dependent; these aspects are
therefore resolved on a platform-by-platform (or compiler-by-compiler) basis
outside of the Cryptoki header files by means of preprocessor directives.</p>

<p class=MsoNormal>This means that when writing C or C++ code, certain
preprocessor directives MUST be issued before including a Cryptoki header
file.  These directives are described in the remainder of Section 6.</p>

<h2><a name="_Toc416959683"></a><a name="_Toc395183756"></a><a
name="_Toc391468760"></a><a name="_Toc370633966"></a><a name="_Toc235002226"></a><a
name="_Toc72656011">2.1 Structure packing</a></h2>

<p class=MsoNormal>Cryptoki structures are packed to occupy as little space as
is possible.  Cryptoki structures SHALL be packed with 1-byte alignment.</p>

<h2><a name="_Toc416959684"></a><a name="_Toc395183757"></a><a
name="_Toc391468761"></a><a name="_Toc370633967"></a><a name="_Toc235002227"></a><a
name="_Toc72656012">2.2 Pointer-related macros</a></h2>

<p class=MsoNormal>Because different platforms and compilers have different
ways of dealing with different types of pointers, the following 6 macros SHALL be
set outside the scope of Cryptoki:</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002228"></a><a name="_Toc72656013"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_PTR</span></a></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>CK_PTR</span> is the
“indirection string” a given platform and compiler uses to make a pointer to an
object.  It is used in the following fashion:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_BYTE CK_PTR CK_BYTE_PTR;</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002229"></a><a name="_Toc72656014"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_DEFINE_FUNCTION</span></a></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>CK_DEFINE_FUNCTION(returnType,
name)</span>, when followed by a parentheses-enclosed list of arguments and a
function definition, defines a Cryptoki API function in a Cryptoki library. 
returnType is the return type of the function, and name is its name.  It SHALL
be used in the following fashion:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_DEFINE_FUNCTION(CK_RV,
C_Initialize)(</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_VOID_PTR pReserved</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>)</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>{</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  ...</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002230"></a><a name="_Toc72656015"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_DECLARE_FUNCTION</span></a></p>

<p class=MsoNormal><span style='font-size:12.0pt;font-family:"Courier New"'>CK_DECLARE_FUNCTION(returnType,
name)</span><span style='font-size:12.0pt'>, </span>when followed by a
parentheses-enclosed list of arguments and a semicolon, declares a Cryptoki API
function in a Cryptoki library.  returnType is the return type of the function,
and name is its name.  It SHALL be used in the following fashion<span
style='font-size:12.0pt'>:</span></p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_DECLARE_FUNCTION(CK_RV,
C_Initialize)(</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_VOID_PTR pReserved</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>);</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002231"></a><a name="_Toc72656016"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_DECLARE_FUNCTION_POINTER</span></a></p>

<p class=MsoNormal><span style='font-size:12.0pt;font-family:"Courier New"'>CK_DECLARE_FUNCTION_POINTER(returnType,
name</span>),  when followed by a parentheses-enclosed list of arguments and a
semicolon, declares a variable or type which is a pointer to a Cryptoki API
function in a Cryptoki library.  returnType is the return type of the function,
and name is its name.  It SHALL be used in either of the following fashions to
define a function pointer variable, myC_Initialize, which can point to a
C_Initialize function in a Cryptoki library (note that neither of the following
code snippets actually assigns a value to myC_Initialize):</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_DECLARE_FUNCTION_POINTER(CK_RV,
myC_Initialize)(</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_VOID_PTR pReserved</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>);</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

</div>

<p class=MsoNormal>or:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_DECLARE_FUNCTION_POINTER(CK_RV, myC_InitializeType)(</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_VOID_PTR pReserved</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>);</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>myC_InitializeType
myC_Initialize;</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002232"></a><a name="_Toc72656017"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_CALLBACK_FUNCTION</span></a></p>

<p class=MsoNormal><span style='font-size:12.0pt;font-family:"Courier New"'>CK_CALLBACK_FUNCTION(returnType,
name)</span><span style='font-size:12.0pt'>, </span>when followed by a
parentheses-enclosed list of arguments and a semicolon, declares a variable or
type which is a pointer to an application callback function that can be used by
a Cryptoki API function in a Cryptoki library.  returnType is the return type
of the function, and name is its name.  It SHALL be used in either of the
following fashions to define a function pointer variable, myCallback, which can
point to an application callback which takes arguments args and returns a CK_RV
(note that neither of the following code snippets actually assigns a value to
myCallback):</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_CALLBACK_FUNCTION(CK_RV,
myCallback)(args);</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

</div>

<p class=MsoNormal>or:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_CALLBACK_FUNCTION(CK_RV, myCallbackType)(args);</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>myCallbackType
myCallback;</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002233"></a><a name="_Toc72656018"><span lang=SV style='font-family:
Symbol;font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=SV style='font-family:"Arial","sans-serif"'>NULL_PTR</span></a></p>

<p class=MsoNormal><span style='font-size:12.0pt;font-family:"Courier New"'>NULL_PTR</span><span
style='font-size:12.0pt'> </span>is the value of a NULL pointer.  In any ANSI C
environment—and in many others as well—<span style='font-family:"Courier New"'>NULL_PTR</span>
SHALL be defined simply as 0.</p>

<div style='border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in'>

<h1><a name="_Toc416959685"></a><a name="_Toc395183758"></a><a
name="_Toc391468762"></a><a name="_Toc370633971"></a><a name="_Toc235002238"></a><a
name="_Toc72656023">3<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>General data types</a></h1>

</div>

<p class=MsoNormal>The general Cryptoki data types are described in the
following subsections.  The data types for holding parameters for various
mechanisms, and the pointers to those parameters, are not described here; these
types are described with the information on the mechanisms themselves, in
Section 12.</p>

<p class=MsoNormal>A C or C++ source file in a Cryptoki application or library
can define all these types (the types described here and the types that are
specifically used for particular mechanism parameters) by including the
top-level Cryptoki include file, pkcs11.h.  pkcs11.h, in turn, includes the
other Cryptoki include files, pkcs11t.h and pkcs11f.h.  A source file can also
include just pkcs11t.h (instead of pkcs11.h); this defines most (but not all)
of the types specified here.</p>

<p class=MsoNormal>When including either of these header files, a source file MUST
specify the preprocessor directives indicated in Section 2.</p>

<h2><a name="_Toc416959686"></a><a name="_Toc395183759"></a><a
name="_Toc391468763"></a><a name="_Toc370633972"></a><a name="_Toc235002239"></a><a
name="_Toc72656024"></a><a name="_Toc405794627"></a><a name="_Toc385057804"></a><a
name="_Toc383864815"></a><a name="_Toc323610801"></a><a name="_Toc323205372"></a><a
name="_Toc323024041"></a><a name="_Toc323000681"></a><a name="_Toc322945098"></a><a
name="_Toc322855272"></a><a name="_Toc319315676"></a><a name="_Toc319313683"></a><a
name="_Toc319313490"></a><a name="_Toc319287649">3.1 General information</a></h2>

<p class=MsoNormal>Cryptoki represents general information with the following
types:</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002240"></a><a name="_Toc72656025"></a><a name="_Toc405794628"></a><a
name="_Toc385057805"></a><a name="_Toc383864816"></a><a name="_Toc323610802"></a><a
name="_Toc323205373"></a><a name="_Toc323024042"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_VERSION</span></a><span
style='font-family:"Arial","sans-serif"'>; CK_VERSION_PTR</span></p>

<p class=MsoNormal><b>CK_VERSION</b> is a structure that describes the version
of a Cryptoki interface, a Cryptoki library, or an SSL implementation, or the
hardware or firmware version of a slot or token.  It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
struct CK_VERSION {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_BYTE major;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_BYTE minor;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>}
CK_VERSION;</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
lang=SV style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>The fields of the structure have the following meanings:</p>

<p class=MsoNormal>            <i>major</i>    major version number (the
integer portion of the version)</p>

<p class=MsoNormal>            <i>minor</i>    minor version number (the
hundredths portion of the version)</p>

<p class=MsoNormal>Example: For version 1.0, <i>major</i> = 1 and <i>minor</i>
= 0.  For version 2.10, <i>major</i> = 2 and <i>minor</i> = 10. Table 4 below lists the major and minor version values for the officially published
Cryptoki specifications. </p>

<p class=MsoCaption><a name="_Toc225305941"></a><a name="_Ref514351075">Table </a>4, Major and minor version values for published Cryptoki specifications</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=79 valign=top style='width:59.4pt;border-top:1.5pt;border-left:
  1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:windowtext;
  border-style:solid;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Version</span></b></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:solid windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>major</span></b></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:solid windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>minor</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=79 valign=top style='width:59.4pt;border-top:none;border-left:solid windowtext 1.5pt;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>1.0</span></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x01</span></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00</span></p>
  </td>
 </tr>
 <tr>
  <td width=79 valign=top style='width:59.4pt;border-top:none;border-left:solid windowtext 1.5pt;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>2.01</span></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x02</span></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x01</span></p>
  </td>
 </tr>
 <tr>
  <td width=79 valign=top style='width:59.4pt;border-top:none;border-left:solid windowtext 1.5pt;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>2.10</span></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x02</span></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x0a</span></p>
  </td>
 </tr>
 <tr>
  <td width=79 valign=top style='width:59.4pt;border-top:none;border-left:solid windowtext 1.5pt;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>2.11</span></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x02</span></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x0b</span></p>
  </td>
 </tr>
 <tr>
  <td width=79 valign=top style='width:59.4pt;border-top:none;border-left:solid windowtext 1.5pt;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>2.20</span></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x02</span></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x14</span></p>
  </td>
 </tr>
 <tr>
  <td width=79 valign=top style='width:59.4pt;border-top:none;border-left:solid windowtext 1.5pt;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>2.30</span></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x02</span></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x1e</span></p>
  </td>
 </tr>
 <tr>
  <td width=79 valign=top style='width:59.4pt;border-top:none;border-left:solid windowtext 1.5pt;
  border-bottom:solid windowtext 1.5pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>2.40</span></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.5pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x02</span></p>
  </td>
  <td width=66 valign=top style='width:49.5pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.5pt;border-right:solid windowtext 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x28</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>Minor revisions of the Cryptoki standard are always upwardly
compatible within the same major version number.</p>

<p class=MsoNormal><b>CK_VERSION_PTR</b> is a pointer to a <b>CK_VERSION</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002241"></a><a name="_Toc72656026"></a><a name="_Toc405794629"></a><a
name="_Toc385057807"></a><a name="_Toc383864817"></a><a name="_Toc323610803"></a><a
name="_Toc323205374"></a><a name="_Toc323024043"><span lang=SV
style='font-family:Symbol;font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=SV style='font-family:"Arial","sans-serif"'>CK_INFO</span></a><span
lang=SV style='font-family:"Arial","sans-serif"'>; CK_INFO_PTR</span></p>

<p class=MsoNormal><b>CK_INFO</b> provides general information about Cryptoki. 
It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
struct CK_INFO {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_VERSION cryptokiVersion;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_UTF8CHAR manufacturerID[32];</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_FLAGS flags;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_UTF8CHAR libraryDescription[32];</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  CK_VERSION
libraryVersion;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>}
CK_INFO;<br>
<br>
</p>

</div>

<p class=MsoNormal>The fields of the structure have the following meanings:</p>

<p class=definition0>                          <i>cryptokiVersion</i>       Cryptoki
interface version number, for compatibility with future revisions of this
interface</p>

<p class=definition0>                          <i>manufacturerID</i>       ID
of the Cryptoki library manufacturer.  MUST be padded with the blank character
(‘ ‘).  Should <i>not</i> be null-terminated.</p>

<p class=definition0>                                         <i>flags</i>       bit
flags reserved for future versions.  MUST be zero for this version</p>

<p class=definition0>                       <i>libraryDescription</i>       character-string
description of the library.  MUST be padded with the blank character (‘ ‘). 
Should <i>not</i> be null-terminated.</p>

<p class=definition0>                            <i>libraryVersion</i>       Cryptoki
library version number</p>

<p class=MsoNormal>For libraries written to this document, the value of <i>cryptokiVersion</i>
should match the version of this specification; the value of <i>libraryVersion</i>
is the version number of the library software itself.</p>

<p class=MsoNormal><b>CK_INFO_PTR</b> is a pointer to a <b>CK_INFO</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002242"></a><a name="_Toc72656027"></a><a name="_Toc405794630"></a><a
name="_Toc385057809"></a><a name="_Toc383864819"></a><a name="_Toc323610805"></a><a
name="_Toc323205376"></a><a name="_Toc323024045"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_NOTIFICATION</span></a></p>

<p class=MsoNormal><b>CK_NOTIFICATION</b> holds the types of notifications that
Cryptoki provides to an application.  It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_ULONG CK_NOTIFICATION;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>For this version of Cryptoki, the following types of
notifications are defined:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKN_SURRENDER</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>The notifications have the following meanings:</p>

<p class=definition0>                   <i>CKN_SURRENDER</i>       Cryptoki is
surrendering the execution of a function executing in a session so that the
application may perform other operations.  After performing any desired
operations, the application should indicate to Cryptoki whether to continue or
cancel the function (see Section 5.16.1).</p>

<h2><a name="_Toc416959687"></a><a name="_Toc395183760"></a><a
name="_Toc391468764"></a><a name="_Toc370633973"></a><a name="_Toc235002243"></a><a
name="_Toc72656028">3.2 Slot and token types</a></h2>

<p class=MsoNormal>Cryptoki represents slot and token information with the
following types:</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002244"></a><a name="_Toc72656029"></a><a name="_Toc405794632"></a><a
name="_Toc385057811"></a><a name="_Toc383864821"></a><a name="_Toc323610807"></a><a
name="_Toc323205378"></a><a name="_Toc323024047"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_SLOT_ID</span></a><span
style='font-family:"Arial","sans-serif"'>; CK_SLOT_ID_PTR</span></p>

<p class=MsoNormal><b>CK_SLOT_ID</b> is a Cryptoki-assigned value that
identifies a slot.  It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_ULONG CK_SLOT_ID;</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>A list of <b>CK_SLOT_ID</b>s is returned by <b>C_GetSlotList</b>. 
A priori, <i>any</i> value of <b>CK_SLOT_ID</b> can be a valid slot
identifier—in particular, a system may have a slot identified by the value 0. 
It need not have such a slot, however.</p>

<p class=MsoNormal><b>CK_SLOT_ID_PTR</b> is a pointer to a <b>CK_SLOT_ID</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002245"></a><a name="_Toc72656030"></a><a name="_Toc405794633"></a><a
name="_Toc385057813"></a><a name="_Toc383864823"></a><a name="_Toc323610809"></a><a
name="_Toc323205380"></a><a name="_Toc323024049"><span lang=SV
style='font-family:Symbol;font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=SV style='font-family:"Arial","sans-serif"'>CK_SLOT_INFO</span></a><span
lang=SV style='font-family:"Arial","sans-serif"'>; CK_SLOT_INFO_PTR</span></p>

<p class=MsoNormal><b>CK_SLOT_INFO</b> provides information about a slot.  It
is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
struct CK_SLOT_INFO {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_UTF8CHAR slotDescription[64];</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_UTF8CHAR manufacturerID[32];</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  <span
lang=DE-CH>CK_FLAGS flags;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE-CH>  CK_VERSION hardwareVersion;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE-CH>  </span>CK_VERSION firmwareVersion;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>}
CK_SLOT_INFO;</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>The fields of the structure have the following meanings:</p>

<p class=definition0>                           <i>slotDescription</i>       character-string
description of the slot.  MUST be padded with the blank character (‘ ‘).  MUST
NOT be null-terminated.</p>

<p class=definition0>                          <i>manufacturerID</i>       ID
of the slot manufacturer.  MUST be padded with the blank character (‘ ‘).  MUST
NOT be null-terminated.</p>

<p class=definition0>                                         <i>flags</i>       bits
flags that provide capabilities of the slot.  The flags are defined below</p>

<p class=definition0><i>                        hardwareVersion       </i>version
number of the slot’s hardware</p>

<p class=definition0><i>                         firmwareVersion       </i>version
number of the slot’s firmware</p>

<p class=MsoNormal>The following table defines the <i>flags</i> field:</p>

<p class=MsoCaption><a name="_Toc225305942"></a><a name="_Toc405794971"></a><a
name="_Toc383864510"><span lang=SV>Table </span></a><span
lang=SV>5</span><span lang=SV>, Slot Information Flags</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=222 valign=top style='width:166.5pt;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.4pt 0in 5.4pt'>
   <p class=MsoNormal><b><span lang=SV>Bit Flag</span></b></p>
   </td>
   <td width=96 valign=top style='width:1.0in;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=MsoNormal><b><span lang=SV>Mask</span></b></p>
   </td>
   <td width=264 valign=top style='width:2.75in;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=MsoNormal><b>Meaning</b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=222 valign=top style='width:166.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>CKF_TOKEN_PRESENT</p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>0x00000001</p>
  </td>
  <td width=264 valign=top style='width:2.75in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>True if a token is present in the slot (<i>e.g.</i>, a
  device is in the reader)</p>
  </td>
 </tr>
 <tr>
  <td width=222 valign=top style='width:166.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>CKF_REMOVABLE_DEVICE</p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>0x00000002</p>
  </td>
  <td width=264 valign=top style='width:2.75in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>True if the reader supports removable devices</p>
  </td>
 </tr>
 <tr>
  <td width=222 valign=top style='width:166.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>CKF_HW_SLOT</p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>0x00000004</p>
  </td>
  <td width=264 valign=top style='width:2.75in;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>True if the slot is a hardware slot, as opposed to a
  software slot implementing a “soft token”</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>For a given slot, the value of the <b>CKF_REMOVABLE_DEVICE</b>
flag <i>never changes</i>.  In addition, if this flag is not set for a given
slot, then the <b>CKF_TOKEN_PRESENT</b> flag for that slot is <i>always</i>
set.  That is, if a slot does not support a removable device, then that slot
always has a token in it.</p>

<p class=MsoNormal><b>CK_SLOT_INFO_PTR</b> is a pointer to a <b>CK_SLOT_INFO</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002246"></a><a name="_Toc72656031"></a><a name="_Toc405794634"></a><a
name="_Toc385057815"></a><a name="_Toc383864825"></a><a name="_Toc323610811"></a><a
name="_Toc323205382"></a><a name="_Toc323024051"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_TOKEN_INFO</span></a><span
style='font-family:"Arial","sans-serif"'>; CK_TOKEN_INFO_PTR</span></p>

<p class=MsoNormal><b>CK_TOKEN_INFO</b> provides information about a token.  It
is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
struct CK_TOKEN_INFO {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_UTF8CHAR label[32];</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_UTF8CHAR manufacturerID[32];</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_UTF8CHAR model[16];</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_CHAR serialNumber[16];</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_FLAGS flags;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_ULONG ulMaxSessionCount;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_ULONG ulSessionCount;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_ULONG ulMaxRwSessionCount;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_ULONG ulRwSessionCount;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_ULONG ulMaxPinLen;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_ULONG ulMinPinLen;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_ULONG ulTotalPublicMemory;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_ULONG ulFreePublicMemory;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_ULONG ulTotalPrivateMemory;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_ULONG ulFreePrivateMemory;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_VERSION hardwareVersion;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_VERSION firmwareVersion;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_CHAR utcTime[16];</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>}
CK_TOKEN_INFO;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

</div>

<p class=MsoNormal>The fields of the structure have the following meanings:</p>

<p class=definition0>                                         <i>label</i>       application-defined
label, assigned during token initialization.  MUST be padded with the blank
character (‘ ‘).  MUST NOT be null-terminated.</p>

<p class=definition0>                          <i>manufacturerID</i>       ID
of the device manufacturer.  MUST be padded with the blank character (‘ ‘).  MUST
NOT be null-terminated.</p>

<p class=definition0>                                       <i>model</i>       model
of the device.  MUST be padded with the blank character (‘ ‘).  MUST NOT be
null-terminated.</p>

<p class=definition0>                             <i>serialNumber</i>       character-string
serial number of the device.  MUST be padded with the blank character (‘ ‘).  MUST
NOT be null-terminated.</p>

<p class=definition0>                                         <i>flags</i>       bit
flags indicating capabilities and status of the device as defined below</p>

<p class=definition0><i>                   ulMaxSessionCount</i>       maximum
number of sessions that can be opened with the token at one time by a single
application (see <b>CK_TOKEN_INFO Note</b> below)</p>

<p class=definition0><i>                         ulSessionCount</i>       number
of sessions that this application currently has open with the token (see <b>CK_TOKEN_INFO
Note</b> below)</p>

<p class=definition0><i>               ulMaxRwSessionCount</i>       maximum
number of read/write sessions that can be opened with the token at one time by
a single application (see <b>CK_TOKEN_INFO Note</b> below)</p>

<p class=definition0><i>                     ulRwSessionCount</i>       number
of read/write sessions that this application currently has open with the token
(see <b>CK_TOKEN_INFO Note</b> below)</p>

<p class=definition0><i>                             ulMaxPinLen</i>       maximum
length in bytes of the PIN</p>

<p class=definition0><i>                              ulMinPinLen</i>       minimum
length in bytes of the PIN</p>

<p class=definition0>                  <i>ulTotalPublicMemory</i>       the
total amount of memory on the token in bytes in which public objects may be
stored (see <b>CK_TOKEN_INFO Note</b> below)</p>

<p class=definition0>                  <i>ulFreePublicMemory</i>       the
amount of free (unused) memory on the token in bytes for public objects (see <b>CK_TOKEN_INFO
Note</b> below)</p>

<p class=definition0>                <i>ulTotalPrivateMemory</i>       the
total amount of memory on the token in bytes in which private objects may be
stored (see <b>CK_TOKEN_INFO Note</b> below)</p>

<p class=definition0>                 <i>ulFreePrivateMemory</i>       the
amount of free (unused) memory on the token in bytes for private objects (see <b>CK_TOKEN_INFO
Note</b> below)</p>

<p class=definition0><i>                        hardwareVersion       </i>version
number of hardware</p>

<p class=definition0><i>                         firmwareVersion       </i>version
number of firmware</p>

<p class=definition0><i>                                    utcTime       </i>current
time as a character-string of length 16, represented in the format
YYYYMMDDhhmmssxx (4 characters for the year;  2 characters each for the month,
the day, the hour, the minute, and the second; and 2 additional reserved ‘0’
characters).  The value of this field only makes sense for tokens equipped with
a clock, as indicated in the token information flags (see below)</p>

<p class=MsoNormal>The following table defines the <i>flags</i> field:</p>

<p class=MsoCaption><a name="_Toc225305943"></a><a name="_Toc405794972"></a><a
name="_Toc383864511"></a><a name="_Ref398089151"><span lang=SV>Table </span></a><span lang=SV>6</span><span lang=SV>, Token Information Flags</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr style='page-break-inside:avoid'>
   <td width=281 valign=top style='width:210.55pt;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span lang=SV
   style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Bit Flag</span></b></p>
   </td>
   <td width=104 valign=top style='width:77.95pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span lang=SV
   style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Mask</span></b></p>
   </td>
   <td width=197 valign=top style='width:148.0pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_RNG</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000001</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the token has its own random number
  generator</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_WRITE_PROTECTED</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000002</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the token is write-protected (see
  below)</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_LOGIN_REQUIRED</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000004</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if there are some cryptographic
  functions that a user MUST be logged in to perform</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_USER_PIN_INITIALIZED</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000008</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the normal user’s PIN has been
  initialized</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_RESTORE_KEY_NOT_NEEDED</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000020</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if a successful save of a session’s
  cryptographic operations state <i>always</i> contains all keys needed to
  restore the state of the session</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_CLOCK_ON_TOKEN</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000040</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if token has its own hardware clock</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_PROTECTED_AUTHENTICATION_PATH</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000100</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if token has a “protected
  authentication path”, whereby a user can log into the token without passing a
  PIN through the Cryptoki library</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_DUAL_CRYPTO_OPERATIONS</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000200</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if a single session with the token can
  perform dual cryptographic operations (see Section </span><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>5.12</span><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>)</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_TOKEN_INITIALIZED</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000400</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the token has been initialized
  using C_InitToken or an equivalent mechanism outside the scope of this
  standard. Calling C_InitToken when this flag is set will cause the token to
  be reinitialized.</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif";layout-grid-mode:line'>CKF_</span><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>SECONDARY<span
  style='layout-grid-mode:line'>_AUTHENTICATION</span></span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000800</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the token supports secondary
  authentication for private key objects. (Deprecated; new implementations MUST
  NOT set this flag)</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif";layout-grid-mode:line'>CKF_USER_PIN_COUNT_LOW</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00010000</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if an incorrect user login PIN has
  been entered at least once since the last successful authentication.</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif";layout-grid-mode:line'>CKF_USER_PIN_FINAL_TRY</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00020000</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if supplying an incorrect user PIN
  will cause it to become locked.</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif";layout-grid-mode:line'>CKF_USER_PIN_LOCKED</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00040000</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the user PIN has been locked. User
  login to the token is not possible.</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif";layout-grid-mode:line'>CKF_USER_PIN_TO_BE_CHANGED</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00080000</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the user PIN value is the default
  value set by token initialization or manufacturing, or the PIN has been
  expired by the card. </span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif";layout-grid-mode:line'>CKF_SO_PIN_COUNT_LOW</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00100000</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if an incorrect SO login PIN has been
  entered at least once since the last successful authentication.</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif";layout-grid-mode:line'>CKF_SO_PIN_FINAL_TRY</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00200000</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if supplying an incorrect SO PIN will
  cause it to become locked.</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif";layout-grid-mode:line'>CKF_SO_PIN_LOCKED</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00400000</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the SO PIN has been locked. SO
  login to the token is not possible.</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif";layout-grid-mode:line'>CKF_SO_PIN_TO_BE_CHANGED</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00800000</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the SO PIN value is the default
  value set by token initialization or manufacturing, or the PIN has been
  expired by the card. </span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid' style='page-break-inside:avoid !msorm'>
  <td width=281 valign=top style='width:210.55pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;border-top:none !msorm;border-left:solid black 1.5pt !msorm;
  border-bottom:solid black 1.5pt !msorm;border-right:solid black 1.0pt !msorm;
  padding:0in 5.4pt 0in 5.4pt !msorm'>
  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;text-autospace:
  none'>CKF_ERROR_STATE</p>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif";layout-grid-mode:line'>&nbsp;</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;border-top:none !msorm;border-left:none !msorm;
  border-bottom:solid black 1.5pt !msorm;border-right:solid black 1.0pt !msorm;
  padding:0in 5.4pt 0in 5.4pt !msorm'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x01000000</span></p>
  </td>
  <td width=197 valign=top style='width:148.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt;border-top:none !msorm;border-left:none !msorm;
  border-bottom:solid black 1.5pt !msorm;border-right:solid black 1.5pt !msorm;
  padding:0in 5.4pt 0in 5.4pt !msorm'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the token failed a FIPS 140-2
  self-test and entered an error state.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>Exactly what the <b>CKF_WRITE_PROTECTED</b> flag means is
not specified in Cryptoki.  An application may be unable to perform certain
actions on a write-protected token; these actions can include any of the
following, among others:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Creating/modifying/deleting any object on the token.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Creating/modifying/deleting a token object on the token.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Changing the SO’s PIN.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Changing the normal user’s PIN.</p>

<p class=MsoNormal>The token may change the value of the <b>CKF_WRITE_PROTECTED</b>
flag depending on the session state to implement its object management policy.
For instance, the token may set the <b>CKF_WRITE_PROTECTED</b> flag unless the
session state is R/W SO or R/W User to implement a policy that does not allow
any objects, public or private, to be created, modified, or deleted unless the
user has successfully called C_Login.</p>

<p class=MsoNormal>The <b>CKF_USER_PIN_COUNT_LOW</b>, <b>CKF_USER_PIN_COUNT_LOW</b>,
<b>CKF_USER_PIN_FINAL_TRY</b>, and <b>CKF_SO_PIN_FINAL_TRY </b>flags may always
be set to false if the token does not support the functionality or will not
reveal the information because of its security policy.</p>

<p class=MsoNormal>The <b>CKF_USER_PIN_TO_BE_CHANGED</b> and <b>CKF_SO_PIN_TO_BE_CHANGED
</b>flags may always be set to false if the token does not support the
functionality. If a PIN is set to the default value, or has expired, the
appropriate <b>CKF_USER_PIN_TO_BE_CHANGED</b> or <b>CKF_SO_PIN_TO_BE_CHANGED</b>
flag is set to true. When either of these flags are true, logging in with the
corresponding PIN will succeed, but only the C_SetPIN function can be called.
Calling any other function that required the user to be logged in will cause
CKR_PIN_EXPIRED to be returned until C_SetPIN is called successfully.</p>

<p class=MsoNormal><b>CK_TOKEN_INFO Note</b>: The fields ulMaxSessionCount,
ulSessionCount, ulMaxRwSessionCount, ulRwSessionCount, ulTotalPublicMemory,
ulFreePublicMemory, ulTotalPrivateMemory, and ulFreePrivateMemory can have the
special value CK_UNAVAILABLE_INFORMATION, which means that the token and/or
library is unable or unwilling to provide that information.  In addition, the
fields ulMaxSessionCount and ulMaxRwSessionCount can have the special value
CK_EFFECTIVELY_INFINITE, which means that there is no practical limit on the
number of sessions (resp. R/W sessions) an application can have open with the
token.</p>

<p class=MsoNormal>It is important to check these fields for these special
values.  This is particularly true for CK_EFFECTIVELY_INFINITE, since an
application seeing this value in the ulMaxSessionCount or ulMaxRwSessionCount
field would otherwise conclude that it can’t open any sessions with the token,
which is far from being the case.</p>

<p class=MsoNormal>The upshot of all this is that the correct way to interpret
(for example) the ulMaxSessionCount field is something along the lines of the
following:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_TOKEN_INFO
info;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>.</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>.</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>if
((CK_LONG) info.ulMaxSessionCount</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>   
== CK_UNAVAILABLE_INFORMATION) {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  /*
Token refuses to give value of ulMaxSessionCount */</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  .</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  .</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>}
else if (info.ulMaxSessionCount == CK_EFFECTIVELY_INFINITE) {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  /*
Application can open as many sessions as it wants */</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  .</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  .</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>}
else {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  /*
ulMaxSessionCount really does contain what it should */</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  .</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  .</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>}</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>CK_TOKEN_INFO_PTR is a pointer to a CK_TOKEN_INFO.</p>

<h2><a name="_Toc416959688"></a><a name="_Toc395183761"></a><a
name="_Toc391468765"></a><a name="_Toc370633974"></a><a name="_Toc235002247"></a><a
name="_Toc72656032"></a><a name="_Toc405794635"></a><a name="_Toc385057817"></a><a
name="_Toc383864827"></a><a name="_Toc323610813"></a><a name="_Toc323205384"></a><a
name="_Toc323024053"></a><a name="_Toc323000683"></a><a name="_Toc322945100"></a><a
name="_Toc322855274"></a><a name="_Toc319315679"></a><a name="_Toc319313686"></a><a
name="_Toc319313493"></a><a name="_Toc319287652">3.3 Session types</a></h2>

<p class=MsoNormal>Cryptoki represents session information with the following
types:</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002248"></a><a name="_Toc72656033"></a><a name="_Toc405794636"></a><a
name="_Toc385057818"></a><a name="_Toc383864828"></a><a name="_Toc323610814"></a><a
name="_Toc323205385"></a><a name="_Toc323024054"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_SESSION_HANDLE</span></a><span
style='font-family:"Arial","sans-serif"'>; CK_SESSION_HANDLE_PTR</span></p>

<p class=MsoNormal><b>CK_SESSION_HANDLE</b> is a Cryptoki-assigned value that
identifies a session.  It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_ULONG CK_SESSION_HANDLE;</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal><a name="_Toc385057819"></a><a name="_Toc383864829"></a><a
name="_Toc323610815"></a><a name="_Toc323205386"></a><a name="_Toc323024055"><i>Valid
session handles in Cryptoki always have nonzero values.</i>  For developers’
convenience, Cryptoki defines the following symbolic value:</a></p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_INVALID_HANDLE</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>CK_SESSION_HANDLE_PTR is a pointer to a CK_SESSION_HANDLE.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002249"></a><a name="_Toc72656034"></a><a name="_Toc405794637"></a><a
name="_Toc385057820"></a><a name="_Toc383864830"></a><a name="_Toc323610816"></a><a
name="_Toc323205387"></a><a name="_Toc323024057"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_USER_TYPE</span></a></p>

<p class=MsoNormal><b>CK_USER_TYPE</b> holds the types of Cryptoki users
described in <b><span style='color:#3B006F'>[PKCS11-UG] </span></b>and, in
addition, a context-specific type described in Section 4.9.  It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_ULONG CK_USER_TYPE;</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>For this version of Cryptoki, the following types of users
are defined:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKU_SO</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKU_USER</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKU_CONTEXT_SPECIFIC</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc323024058"></a><a name="_Toc235002250"></a><a name="_Toc72656035"></a><a
name="_Toc405794638"></a><a name="_Toc385057821"></a><a name="_Toc383864831"></a><a
name="_Toc323610817"></a><a name="_Toc323205388"></a><a name="_Toc323024056"><span
style='font-family:Symbol;font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_STATE</span></a></p>

<p class=MsoNormal><b>CK_STATE</b> holds the session state, as described in <b><span
style='color:#3B006F'>[PKCS11-UG]</span></b>. It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_ULONG CK_STATE;</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>For this version of Cryptoki, the following session states
are defined:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKS_RO_PUBLIC_SESSION</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKS_RO_USER_FUNCTIONS</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKS_RW_PUBLIC_SESSION</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKS_RW_USER_FUNCTIONS</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKS_RW_SO_FUNCTIONS 
</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002251"></a><a name="_Toc72656036"></a><a name="_Toc405794639"></a><a
name="_Toc385057822"></a><a name="_Toc383864832"></a><a name="_Toc323610818"></a><a
name="_Toc323205389"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>CK_SESSION_INFO</span></a><span
style='font-family:"Arial","sans-serif"'>; CK_SESSION_INFO_PTR</span></p>

<p class=MsoNormal><b>CK_SESSION_INFO</b> provides information about a
session.  It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
struct CK_SESSION_INFO {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_SLOT_ID slotID;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_STATE state;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_FLAGS flags;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_ULONG ulDeviceError;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>}
CK_SESSION_INFO;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

</div>

<p class=MsoNormal>The fields of the structure have the following meanings:</p>

<p class=definition0>                                        <i>slotID</i>       ID
of the slot that interfaces with the token</p>

<p class=definition0><i>                                         state</i>       the
state of the session</p>

<p class=definition0><i>                                         flags</i>       bit
flags that define the type of session; the flags are defined below</p>

<p class=definition0>                             <i>ulDeviceError</i>       an
error code defined by the cryptographic device.  Used for errors not covered by
Cryptoki.</p>

<p class=MsoNormal>The following table defines the <i>flags</i> field:</p>

<p class=MsoCaption><a name="_Toc225305944"></a><a name="_Toc405794973"></a><a
name="_Toc383864512">Table </a>7, Session Information Flags</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=192 valign=top style='width:2.0in;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><a name="_Toc319315680"></a><a
   name="_Toc319313687"></a><a name="_Toc319313494"></a><a name="_Toc319287653"><b><span
   style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Bit Flag</span></b></a></p>
   </td>
   <td width=96 valign=top style='width:1.0in;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Mask</span></b></p>
   </td>
   <td width=294 valign=top style='width:220.5pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:solid black 1.5pt;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_RW_SESSION</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000002</span></p>
  </td>
  <td width=294 valign=top style='width:220.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the session is read/write; false if
  the session is read-only</span></p>
  </td>
 </tr>
 <tr>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:solid black 1.5pt;
  border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_SERIAL_SESSION</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000004</span></p>
  </td>
  <td width=294 valign=top style='width:220.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>This flag is provided for backward
  compatibility, and should always be set to true</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><a name="_Toc385057823"></a><a name="_Toc383864833"></a><a
name="_Toc323610819"></a><a name="_Toc323205390"></a><a name="_Toc323024059">CK_SESSION_INFO_PTR
is a pointer to a CK_SESSION_INFO.</a></p>

<h2><a name="_Toc416959689"></a><a name="_Toc395183762"></a><a
name="_Toc391468766"></a><a name="_Toc370633975"></a><a name="_Toc235002252"></a><a
name="_Toc72656037"></a><a name="_Ref26861179"></a><a name="_Toc405794640"></a><a
name="_Toc385057824"></a><a name="_Toc383864834"></a><a name="_Toc323610820"></a><a
name="_Toc323205391"></a><a name="_Toc323024060"></a><a name="_Toc323000684"></a><a
name="_Toc322945101"></a><a name="_Toc322855275">3.4 Object types</a></h2>

<p class=MsoNormal>Cryptoki represents object information with the following
types:</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002253"></a><a name="_Toc72656038"></a><a name="_Toc405794641"></a><a
name="_Toc385057825"></a><a name="_Toc383864835"></a><a name="_Toc323610821"></a><a
name="_Toc323205392"></a><a name="_Toc323024061"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_OBJECT_HANDLE</span></a><span
style='font-family:"Arial","sans-serif"'>; CK_OBJECT_HANDLE_PTR</span></p>

<p class=MsoNormal><b>CK_OBJECT_HANDLE</b> is a token-specific identifier for
an object.  It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_ULONG CK_OBJECT_HANDLE;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

</div>

<p class=MsoNormal>When an object is created or found on a token by an
application, Cryptoki assigns it an object handle for that application’s
sessions to use to access it.  A particular object on a token does not
necessarily have a handle which is fixed for the lifetime of the object;
however, if a particular session can use a particular handle to access a
particular object, then that session will continue to be able to use that
handle to access that object as long as the session continues to exist, the
object continues to exist, and the object continues to be accessible to the
session.</p>

<p class=MsoNormal><a name="_Toc385057826"></a><a name="_Toc383864836"></a><a
name="_Toc323610822"></a><a name="_Toc323205393"></a><a name="_Toc323024062"><i>Valid
object handles in Cryptoki always have nonzero values.</i>  For developers’
convenience, Cryptoki defines the following symbolic value:</a></p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_INVALID_HANDLE</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

</div>

<p class=MsoNormal>CK_OBJECT_HANDLE_PTR is a pointer to a CK_OBJECT_HANDLE.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002254"></a><a name="_Toc72656039"></a><a name="_Toc405794642"></a><a
name="_Toc385057827"></a><a name="_Toc383864837"></a><a name="_Toc323610823"></a><a
name="_Toc323205394"></a><a name="_Toc323024063"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_OBJECT_CLASS</span></a><span
style='font-family:"Arial","sans-serif"'>; CK_OBJECT_CLASS_PTR</span></p>

<p class=MsoNormal style='page-break-after:avoid'>CK_OBJECT_CLASS is a value
that identifies the classes (or types) of objects that Cryptoki recognizes.  It
is defined as follows<span style='font-size:12.0pt'>:</span></p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_ULONG CK_OBJECT_CLASS;</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>Object classes are defined with the objects that use them.
The type is specified on an object through the CKA_CLASS attribute of the
object.</p>

<p class=MsoNormal>Vendor defined values for this type may also be specified.</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKO_VENDOR_
DEFINED   </p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>Object classes <b>CKO_VENDOR_DEFINED</b> and above are
permanently reserved for token vendors.  For interoperability, vendors should
register their object classes through the PKCS process.</p>

<p class=MsoNormal><b>CK_OBJECT_CLASS_PTR</b> is a pointer to a <b>CK_OBJECT_CLASS</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002255"></a><a name="_Toc72656040"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_HW_FEATURE_TYPE</span></a></p>

<p class=MsoNormal><b>CK_HW_FEATURE_TYPE</b> is a value that identifies a
hardware feature type of a device. It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_ULONG CK_HW_FEATURE_TYPE;</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>Hardware feature types are defined with the objects that use
them. The type is specified on an object through the CKA_HW_FEATURE_TYPE
attribute of the object.</p>

<p class=MsoNormal>Vendor defined values for this type may also be specified.</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKH_VENDOR_DEFINED   
</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>Feature types <b>CKH_VENDOR_DEFINED</b> and above are
permanently reserved for token vendors.  For interoperability, vendors should
register their feature types through the PKCS process.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc323205396"></a><a name="_Toc323024065"></a><a name="_Toc235002256"></a><a
name="_Toc72656041"></a><a name="_Toc405794643"></a><a name="_Toc385057829"></a><a
name="_Toc383864839"></a><a name="_Toc323610825"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_KEY_TYPE</span></a></p>

<p class=MsoNormal><b>CK_KEY_TYPE</b> is a value that identifies a key type. It
is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>typedef CK_ULONG CK_KEY_TYPE;</span></p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>Key types are defined with the objects and mechanisms that
use them. The key type is specified on an object through the CKA_KEY_TYPE
attribute of the object.</p>

<p class=MsoNormal>Vendor defined values for this type may also be specified.</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKK_VENDOR_DEFINED 
</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>Key types <b>CKK_VENDOR_DEFINED</b> and above are
permanently reserved for token vendors.  For interoperability, vendors should
register their key types through the PKCS process.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002257"></a><a name="_Toc72656042"></a><a name="_Toc405794644"></a><a
name="_Toc385057830"></a><a name="_Toc383864840"></a><a name="_Toc323610826"><span
style='font-family:Symbol;font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_CERTIFICATE_TYPE</span></a></p>

<p class=MsoNormal><b>CK_CERTIFICATE_TYPE</b> is a value that identifies a
certificate type. It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_ULONG CK_CERTIFICATE_TYPE;</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>Certificate types are defined with the objects and
mechanisms that use them. The certificate type is specified on an object
through the CKA_CERTIFICATE_TYPE attribute of the object.</p>

<p class=MsoNormal>Vendor defined values for this type may also be specified.</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKC_VENDOR_DEFINED</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal><a name="_Toc323024066">Certificate types <b>CKC_VENDOR_DEFINED</b>
and above are permanently reserved for token vendors.  For interoperability,
vendors should register their certificate types through the PKCS process.</a></p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol;font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_CERTIFICATE_CATEGORY</span></p>

<p class=MsoNormal><b>CK_CERTIFICATE_CATEGORY</b> is a value that identifies a
certificate category. It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_ULONG CK_CERTIFICATE_CATEGORY;</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>For this version of Cryptoki, the following certificate
categories are defined:</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=320 valign=top style='width:239.9pt;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span lang=SV
   style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Constant</span></b></p>
   </td>
   <td width=106 valign=top style='width:79.35pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span lang=SV
   style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Value</span></b></p>
   </td>
   <td width=158 valign=top style='width:118.85pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=320 valign=top style='width:239.9pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_CERTIFICATE_CATEGORY_UNSPECIFIED</span></p>
  </td>
  <td width=106 valign=top style='width:79.35pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000000UL</span></p>
  </td>
  <td width=158 valign=top style='width:118.85pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>No category specified</span></p>
  </td>
 </tr>
 <tr>
  <td width=320 valign=top style='width:239.9pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_CERTIFICATE_CATEGORY_TOKEN_USER</span></p>
  </td>
  <td width=106 valign=top style='width:79.35pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000001UL</span></p>
  </td>
  <td width=158 valign=top style='width:118.85pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Certificate belongs to owner of the token</span></p>
  </td>
 </tr>
 <tr>
  <td width=320 valign=top style='width:239.9pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_CERTIFICATE_CATEGORY_AUTHORITY</span></p>
  </td>
  <td width=106 valign=top style='width:79.35pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000002UL</span></p>
  </td>
  <td width=158 valign=top style='width:118.85pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Certificate belongs to a certificate authority</span></p>
  </td>
 </tr>
 <tr>
  <td width=320 valign=top style='width:239.9pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_CERTIFICATE_CATEGORY_OTHER_ENTITY</span></p>
  </td>
  <td width=106 valign=top style='width:79.35pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000003UL</span></p>
  </td>
  <td width=158 valign=top style='width:118.85pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Certificate belongs to an end entity (i.e.:
  not a CA)</span></p>
  </td>
 </tr>
</table>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002258"></a><a name="_Toc72656043"></a><a name="_Toc405794645"></a><a
name="_Toc385057831"></a><a name="_Toc383864841"></a><a name="_Toc323610827"></a><a
name="_Toc323205397"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>CK_ATTRIBUTE_TYPE</span></a><span
style='font-family:"Arial","sans-serif"'> </span></p>

<p class=MsoNormal><b>CK_ATTRIBUTE_TYPE</b> is a value that identifies an
attribute type. It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_ULONG CK_ATTRIBUTE_TYPE;</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>Attributes are defined with the objects and mechanisms that
use them. Attributes are specified on an object as a list of type, length value
items. These are often specified as an attribute template.</p>

<p class=MsoNormal>Vendor defined values for this type may also be specified.</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKA_VENDOR_DEFINED</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>Attribute types <b>CKA_VENDOR_DEFINED</b> and above are
permanently reserved for token vendors.  For interoperability, vendors should
register their attribute types through the PKCS process.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002259"></a><a name="_Toc72656044"></a><a name="_Toc405794646"></a><a
name="_Toc385057832"></a><a name="_Toc383864842"></a><a name="_Toc323610828"></a><a
name="_Toc323205398"></a><a name="_Toc323024067"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_ATTRIBUTE</span></a><span
style='font-family:"Arial","sans-serif"'>; CK_ATTRIBUTE_PTR</span></p>

<p class=MsoNormal><b>CK_ATTRIBUTE </b>is a structure that includes the type,
value, and length of an attribute.  It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
struct CK_ATTRIBUTE {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_ATTRIBUTE_TYPE type;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_VOID_PTR pValue;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_ULONG ulValueLen;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>}
CK_ATTRIBUTE;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

</div>

<p class=MsoNormal>The fields of the structure have the following meanings:</p>

<p class=definition0>                                          <i>type</i>       the
attribute type</p>

<p class=definition0>                                      <i>pValue</i>       pointer
to the value of the attribute</p>

<p class=definition0>                                <i>ulValueLen</i>       length
in bytes of the value</p>

<p class=MsoNormal>If an attribute has no value, then <i>ulValueLen</i> = 0,
and the value of <i>pValue</i> is irrelevant. An array of <b>CK_ATTRIBUTE</b>s
is called a “template” and is used for creating, manipulating and searching for
objects.  The order of the attributes in a template <i>never</i> matters, even
if the template contains vendor-specific attributes.  Note that <i>pValue</i>
is a “void” pointer, facilitating the passing of arbitrary values.  Both the
application and Cryptoki library MUST ensure that the pointer can be safely
cast to the expected type (<i>i.e.</i>, without word-alignment errors).</p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt'><span
style='font-family:"Courier New";color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt'><span
style='color:black'>The constant CK_UNAVAILABLE_INFORMATION is used in the
ulValueLen field to denote an invalid or unavailable value. See
C_GetAttributeValue for further details.</span></p>

<p class=MsoNormal><b>&nbsp;</b></p>

<p class=MsoNormal><b>CK_ATTRIBUTE_PTR</b> is a pointer to a <b>CK_ATTRIBUTE</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc322855276"></a><a name="_Toc319315681"></a><a name="_Toc319313688"></a><a
name="_Toc319313495"></a><a name="_Toc319287654"></a><a name="_Toc235002260"></a><a
name="_Toc72656045"></a><a name="_Toc405794647"></a><a name="_Toc385057834"></a><a
name="_Toc383864844"></a><a name="_Toc323610830"></a><a name="_Toc323205400"></a><a
name="_Toc323024069"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>CK_DATE</span></a></p>

<p class=MsoNormal><b>CK_DATE </b>is a structure that defines a date. It is
defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
struct CK_DATE {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_CHAR year[4];</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_CHAR month[2];</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_CHAR day[2];</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>}
CK_DATE;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>The fields of the structure have the following meanings:</p>

<p class=definition0>                                          <i>year</i>       the
year (“1900” - “9999”)</p>

<p class=definition0>                                       <i>month</i>       the
month (“01” - “12”)</p>

<p class=definition0>                                           <i>day</i>       the
day (“01” - “31”)</p>

<p class=MsoNormal><a name="_Toc323024070"></a><a name="_Toc323000685"></a><a
name="_Toc322945102">The fields hold numeric characters from the character set
in </a>Table 3, not the literal byte values.</p>

<p class=MsoNormal>When a Cryptoki object carries an attribute of this type,
and the default value of the attribute is specified to be &quot;empty,&quot;
then Cryptoki libraries SHALL set the attribute's <i>ulValueLen</i> to 0.</p>

<p class=MsoNormal>Note that implementations of previous versions of Cryptoki
may have used other methods to identify an &quot;empty&quot; attribute of type
CK_DATE, and applications that needs to interoperate with these libraries
therefore have to be flexible in what they accept as an empty value.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol;font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_JAVA_MIDP_SECURITY_DOMAIN</span></p>

<p class=name style='margin-left:0in;text-indent:0in'><span style='font-size:
10.0pt;font-family:"Arial","sans-serif"'>CK_JAVA_MIDP_SECURITY_DOMAIN </span><span
style='font-size:10.0pt;font-family:"Arial","sans-serif";font-weight:normal'>is
a value that identifies the Java MIDP security domain of a certificate.  It is
defined as follows:</span></p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_ULONG CK_JAVA_MIDP_SECURITY_DOMAIN;</p>

</div>

<p class=name style='margin-left:0in;text-indent:0in'><span style='font-size:
10.0pt;font-family:"Arial","sans-serif";font-weight:normal'>For this version of
Cryptoki, the following security domains are defined.  See the Java MIDP
specification for further information:</span></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=320 valign=top style='width:239.9pt;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span lang=SV
   style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Constant</span></b></p>
   </td>
   <td width=106 valign=top style='width:79.35pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span lang=SV
   style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Value</span></b></p>
   </td>
   <td width=158 valign=top style='width:118.85pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=320 valign=top style='width:239.9pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_SECURITY_DOMAIN_UNSPECIFIED</span></p>
  </td>
  <td width=106 valign=top style='width:79.35pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000000UL</span></p>
  </td>
  <td width=158 valign=top style='width:118.85pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>No domain specified</span></p>
  </td>
 </tr>
 <tr>
  <td width=320 valign=top style='width:239.9pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_SECURITY_DOMAIN_MANUFACTURER</span></p>
  </td>
  <td width=106 valign=top style='width:79.35pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000001UL</span></p>
  </td>
  <td width=158 valign=top style='width:118.85pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Manufacturer protection domain</span></p>
  </td>
 </tr>
 <tr>
  <td width=320 valign=top style='width:239.9pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_SECURITY_DOMAIN_OPERATOR</span></p>
  </td>
  <td width=106 valign=top style='width:79.35pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000002UL</span></p>
  </td>
  <td width=158 valign=top style='width:118.85pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Operator protection domain</span></p>
  </td>
 </tr>
 <tr>
  <td width=320 valign=top style='width:239.9pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_SECURITY_DOMAIN_THIRD_PARTY</span></p>
  </td>
  <td width=106 valign=top style='width:79.35pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000003UL</span></p>
  </td>
  <td width=158 valign=top style='width:118.85pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Third party protection domain</span></p>
  </td>
 </tr>
</table>

<p class=name style='margin-left:0in;text-indent:0in'><span style='font-size:
10.0pt;font-family:"Arial","sans-serif";font-weight:normal'>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Ref319978509"></a><a name="_Toc319315682"></a><a
name="_Toc319313689"></a><a name="_Toc319313496"></a><a name="_Toc319287655"></a><a
name="_Toc383864845"></a><a name="_Ref372962897"></a><a name="_Toc323610839"></a><a
name="_Toc323205409"></a><a name="_Toc323024078"></a><a name="_Toc323000686"></a><a
name="_Toc322945103"></a><a name="_Toc322855277"></a><a name="_Toc416959690"></a><a
name="_Toc395183763"></a><a name="_Toc391468767"></a><a name="_Toc370633976"></a><a
name="_Toc235002261"></a><a name="_Toc72656046"></a><a name="_Toc405794648"></a><a
name="_Toc385057835"></a><a name="_Toc383864940"></a><a name="_Toc323610831"></a><a
name="_Toc323205401">3.5 Data types for mechanisms</a></h2>

<p class=MsoNormal>Cryptoki supports the following types for describing
mechanisms and parameters to them:</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002262"></a><a name="_Toc72656047"></a><a name="_Toc405794649"></a><a
name="_Toc385057836"></a><a name="_Toc383864941"></a><a name="_Toc323610832"></a><a
name="_Toc323205402"></a><a name="_Toc323024071"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_MECHANISM_TYPE</span></a><span
style='font-family:"Arial","sans-serif"'>; CK_MECHANISM_TYPE_PTR</span></p>

<p class=MsoNormal><b>CK_MECHANISM_TYPE </b>is a value that identifies a
mechanism type. It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_ULONG CK_MECHANISM_TYPE;</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>Mechanism types are defined with the objects and mechanism
descriptions that use them.</p>

<p class=MsoNormal>Vendor defined values for this type may also be specified.</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKM_VENDOR_DEFINED</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal><a name="_Toc323024072">Mechanism types <b>CKM_VENDOR_DEFINED</b>
and above are permanently reserved for token vendors.  For interoperability,
vendors should register their mechanism types through the PKCS process.</a></p>

<p class=MsoNormal><b>CK_MECHANISM_TYPE_PTR</b> is a pointer to a <b>CK_MECHANISM_TYPE</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002263"></a><a name="_Toc72656048"></a><a name="_Toc405794650"></a><a
name="_Toc385057838"></a><a name="_Toc383864943"></a><a name="_Toc323610834"></a><a
name="_Toc323205404"></a><a name="_Toc323024073"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_MECHANISM</span></a><span
style='font-family:"Arial","sans-serif"'>; CK_MECHANISM_PTR</span></p>

<p class=MsoNormal><b>CK_MECHANISM</b> is a structure that specifies a
particular mechanism and any parameters it requires.  It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
struct CK_MECHANISM {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_MECHANISM_TYPE mechanism;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_VOID_PTR pParameter;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_ULONG ulParameterLen;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>}
CK_MECHANISM;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

</div>

<p class=MsoNormal>The fields of the structure have the following meanings:</p>

<p class=definition0>                               <i>mechanism</i>       the
type of mechanism</p>

<p class=definition0>                               <i>pParameter</i>       pointer
to the parameter if required by the mechanism</p>

<p class=definition0>                         <i>ulParameterLen</i>       length
in bytes of the parameter</p>

<p class=MsoNormal><a name="_Toc323024074">Note that <i>pParameter</i> is a
“void” pointer, facilitating the passing of arbitrary values.  Both the
application and the Cryptoki library MUST ensure that the pointer can be safely
cast to the expected type (<i>i.e.</i>, without word-alignment errors).</a></p>

<p class=MsoNormal><b>CK_MECHANISM_PTR</b> is a pointer to a <b>CK_MECHANISM</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002264"></a><a name="_Toc72656049"></a><a name="_Toc405794651"></a><a
name="_Toc385057840"></a><a name="_Toc383864945"></a><a name="_Toc323610836"></a><a
name="_Toc323205406"></a><a name="_Toc323024075"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_MECHANISM_INFO</span></a><span
style='font-family:"Arial","sans-serif"'>; CK_MECHANISM_INFO_PTR</span></p>

<p class=MsoNormal><b>CK_MECHANISM_INFO</b> is a structure that provides
information about a particular mechanism.  It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
struct CK_MECHANISM_INFO {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_ULONG ulMinKeySize;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_ULONG ulMaxKeySize;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_FLAGS flags;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>}
CK_MECHANISM_INFO;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

</div>

<p class=MsoNormal>The fields of the structure have the following meanings:</p>

<p class=definition0>                            <i>ulMinKeySize</i>       the
minimum size of the key for the mechanism (whether this is measured in bits or
in bytes is mechanism-dependent)</p>

<p class=definition0>                           <i>ulMaxKeySize</i>       the
maximum size of the key for the mechanism (whether this is measured in bits or
in bytes is mechanism-dependent)</p>

<p class=definition0>                                         <i>flags</i>       bit
flags specifying mechanism capabilities</p>

<p class=MsoNormal>For some mechanisms, the <i>ulMinKeySize</i> and <i>ulMaxKeySize</i>
fields have meaningless values.</p>

<p class=MsoNormal>The following table defines the <i>flags</i> field:</p>

<p class=MsoCaption><a name="_Toc225305945"></a><a name="_Toc405794974"></a><a
name="_Toc383864547">Table </a>8, Mechanism Information Flags</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=228 valign=top style='width:171.0pt;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span lang=SV
   style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Bit Flag</span></b></p>
   </td>
   <td width=96 valign=top style='width:1.0in;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span lang=SV
   style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Mask</span></b></p>
   </td>
   <td width=252 valign=top style='width:189.0pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=228 valign=top style='width:171.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_HW</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000001</span></p>
  </td>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the mechanism is performed by the
  device; false if the mechanism is performed in software</span></p>
  </td>
 </tr>
 <tr>
  <td width=228 valign=top style='width:171.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_ENCRYPT</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000100</span></p>
  </td>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the mechanism can be used with <b>C_EncryptInit</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=228 valign=top style='width:171.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_DECRYPT</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000200</span></p>
  </td>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the mechanism can be used with <b>C_DecryptInit</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=228 valign=top style='width:171.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_DIGEST</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000400</span></p>
  </td>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the mechanism can be used with <b>C_DigestInit</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=228 valign=top style='width:171.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_SIGN</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000800</span></p>
  </td>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the mechanism can be used with <b>C_SignInit</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=228 valign=top style='width:171.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_SIGN_RECOVER</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00001000</span></p>
  </td>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the mechanism can be used with <b>C_SignRecoverInit</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=228 valign=top style='width:171.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_VERIFY</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00002000</span></p>
  </td>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the mechanism can be used with <b>C_VerifyInit</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=228 valign=top style='width:171.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_VERIFY_RECOVER</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00004000</span></p>
  </td>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the mechanism can be used with <b>C_VerifyRecoverInit</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=228 valign=top style='width:171.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_GENERATE</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00008000</span></p>
  </td>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the mechanism can be used with <b>C_GenerateKey</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=228 valign=top style='width:171.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_GENERATE_KEY_PAIR</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00010000</span></p>
  </td>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the mechanism can be used with <b>C_GenerateKeyPair</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=228 valign=top style='width:171.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_WRAP</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00020000</span></p>
  </td>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the mechanism can be used with <b>C_WrapKey</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=228 valign=top style='width:171.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_UNWRAP</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00040000</span></p>
  </td>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the mechanism can be used with <b>C_UnwrapKey</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=228 valign=top style='width:171.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_DERIVE</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00080000</span></p>
  </td>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the mechanism can be used with <b>C_DeriveKey</b></span></p>
  </td>
 </tr>
 <tr>
  <td width=228 valign=top style='width:171.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_EXTENSION</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x80000000</span></p>
  </td>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if there is an extension to the flags;
  false if no extensions.  MUST be false for this version.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:12.0pt'><a name="_Toc385057841"></a><a
name="_Toc383864946"></a><a name="_Toc323610837"></a><a name="_Toc323205407"></a><a
name="_Toc323024076">CK_MECHANISM_INFO_PTR is a pointer to a CK_MECHANISM_INFO</a><span
style='font-size:12.0pt'>.</span></p>

<h2><a name="_Toc416959691"></a><a name="_Toc395183764"></a><a
name="_Toc391468768"></a><a name="_Toc370633977"></a><a name="_Toc235002265"></a><a
name="_Toc72656050"></a><a name="_Toc405794652"></a><a name="_Toc385057842"></a><a
name="_Ref384634468">3.6 Function</a> types</h2>

<p class=MsoNormal>Cryptoki represents information about functions with the
following data types:</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002266"></a><a name="_Toc72656051"></a><a name="_Toc405794654"></a><a
name="_Toc385057844"></a><a name="_Toc383864847"></a><a name="_Toc323610841"></a><a
name="_Toc323205411"></a><a name="_Toc323024080"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_RV</span></a></p>

<p class=MsoNormal><b>CK_RV</b> is a value that identifies the return value of
a Cryptoki function. It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_ULONG CK_RV;</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>Vendor defined values for this type may also be specified.</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKR_VENDOR_DEFINED</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

</div>

<p class=MsoNormal>Section 5.1 defines the meaning of each <b>CK_RV</b> value.
Return values <b>CKR_VENDOR_DEFINED</b> and above are permanently reserved for
token vendors.  For interoperability, vendors should register their return
values through the PKCS process.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002267"></a><a name="_Toc72656052"></a><a name="_Toc405794655"></a><a
name="_Toc385057845"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>CK_NOTIFY</span></a></p>

<p class=MsoNormal><b>CK_NOTIFY</b> is the type of a pointer to a function used
by Cryptoki to perform notification callbacks.  It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_CALLBACK_FUNCTION(CK_RV, CK_NOTIFY)(</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_SESSION_HANDLE hSession,</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_NOTIFICATION event,</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_VOID_PTR pApplication</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>);</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>The arguments to a notification callback function have the
following meanings:</p>

<p class=definition0>                                   <i>hSession</i>       The
handle of the session performing the callback</p>

<p class=definition0>                                        <i>event</i>       The
type of notification callback</p>

<p class=definition0>                              <i>pApplication</i>       An
application-defined value.  This is the same value as was passed to <b>C_OpenSession</b>
to open the session performing the callback</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002268"></a><a name="_Toc72656053"></a><a name="_Toc405794656"><span
style='font-family:Symbol;font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_C_XXX</span></a></p>

<p class=MsoNormal>Cryptoki also defines an entire family of other function
pointer types.  For each function <b>C_XXX</b> in the Cryptoki API (see Section
4.12 for detailed information about each of them), Cryptoki defines a type <b>CK_C_XXX</b>,
which is a pointer to a function with the same arguments and return value as <b>C_XXX</b>
has.  An appropriately-set variable of type <b>CK_C_XXX</b> may be used by an
application to call the Cryptoki function <b>C_XXX</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002269"></a><a name="_Toc72656054"></a><a name="_Toc405794657"></a><a
name="_Toc385057846"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>CK_FUNCTION_LIST</span></a><span
style='font-family:"Arial","sans-serif"'>; CK_FUNCTION_LIST_PTR;
CK_FUNCTION_LIST_PTR_PTR</span></p>

<p class=MsoNormal><b>CK_FUNCTION_LIST</b> is a structure which contains a
Cryptoki version and a function pointer to each function in the Cryptoki API. 
It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
struct CK_FUNCTION_LIST {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_VERSION version;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_Initialize C_Initialize;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_Finalize C_Finalize;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_GetInfo C_GetInfo;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_GetFunctionList C_GetFunctionList;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  <span
lang=DE-CH>CK_C_GetSlotList C_GetSlotList;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE-CH>  </span>CK_C_GetSlotInfo C_GetSlotInfo;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_GetTokenInfo C_GetTokenInfo;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  <span
lang=DE>CK_C_GetMechanismList C_GetMechanismList;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE>  CK_C_GetMechanismInfo C_GetMechanismInfo;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE>  CK_C_InitToken C_InitToken;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE>  CK_C_InitPIN C_InitPIN;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE>  CK_C_SetPIN C_SetPIN;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE>  </span>CK_C_OpenSession C_OpenSession;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_CloseSession C_CloseSession;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_CloseAllSessions C_CloseAllSessions;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_GetSessionInfo C_GetSessionInfo;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_GetOperationState C_GetOperationState;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_SetOperationState C_SetOperationState;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_Login C_Login;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  <span
lang=FR-CH>CK_C_Logout C_Logout;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=FR-CH>  </span>CK_C_CreateObject C_CreateObject;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_CopyObject C_CopyObject;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_DestroyObject C_DestroyObject;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_GetObjectSize C_GetObjectSize;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  CK_C_GetAttributeValue
C_GetAttributeValue;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_SetAttributeValue C_SetAttributeValue;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  CK_C_FindObjectsInit
C_FindObjectsInit;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_FindObjects C_FindObjects;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_FindObjectsFinal C_FindObjectsFinal;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  <span
lang=FR>CK_C_EncryptInit C_EncryptInit;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=FR>  CK_C_Encrypt C_Encrypt;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=FR>  CK_C_EncryptUpdate C_EncryptUpdate;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=FR>  CK_C_EncryptFinal C_EncryptFinal;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=FR>  CK_C_DecryptInit C_DecryptInit;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=FR>  CK_C_Decrypt C_Decrypt;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=FR>  </span>CK_C_DecryptUpdate C_DecryptUpdate;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_DecryptFinal C_DecryptFinal;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  <span
lang=DE-CH>CK_C_DigestInit C_DigestInit;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE-CH>  </span><span lang=DE>CK_C_Digest C_Digest;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE>  CK_C_DigestUpdate C_DigestUpdate;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE>  CK_C_DigestKey C_DigestKey;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE>  CK_C_DigestFinal C_DigestFinal;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE>  </span><span lang=SV>CK_C_SignInit C_SignInit;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=SV>  </span>CK_C_Sign C_Sign;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_SignUpdate C_SignUpdate;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_SignFinal C_SignFinal;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_SignRecoverInit C_SignRecoverInit;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_SignRecover C_SignRecover;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_VerifyInit C_VerifyInit;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_Verify C_Verify;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  <span
lang=IT>CK_C_VerifyUpdate C_VerifyUpdate;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=IT>  CK_C_VerifyFinal C_VerifyFinal;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=IT>  </span>CK_C_VerifyRecoverInit C_VerifyRecoverInit;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_VerifyRecover C_VerifyRecover;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  <span
lang=DE>CK_C_DigestEncryptUpdate C_DigestEncryptUpdate;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE>  CK_C_DecryptDigestUpdate C_DecryptDigestUpdate;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE>  CK_C_SignEncryptUpdate C_SignEncryptUpdate;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE>  CK_C_DecryptVerifyUpdate C_DecryptVerifyUpdate;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=DE>  </span>CK_C_GenerateKey C_GenerateKey;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_GenerateKeyPair C_GenerateKeyPair;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_WrapKey C_WrapKey;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_UnwrapKey C_UnwrapKey;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_DeriveKey C_DeriveKey;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  <span
lang=SV>CK_C_SeedRandom C_SeedRandom;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=SV>  CK_C_GenerateRandom C_GenerateRandom;</span></p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
lang=SV>  </span>CK_C_GetFunctionStatus C_GetFunctionStatus;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_CancelFunction C_CancelFunction;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_C_WaitForSlotEvent C_WaitForSlotEvent;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>}
CK_FUNCTION_LIST;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>Each Cryptoki library has a static <b>CK_FUNCTION_LIST</b>
structure, and a pointer to it (or to a copy of it which is also owned by the
library) may be obtained by the <b>C_GetFunctionList</b> function (see Section 5.2).  The value that this pointer points to can be used by an application to quickly
find out where the executable code for each function in the Cryptoki API is
located.  Every function in the Cryptoki API MUST have an entry point defined
in the Cryptoki library’s <b>CK_FUNCTION_LIST</b> structure.  If a particular
function in the Cryptoki API is not supported by a library, then the function
pointer for that function in the library’s <b>CK_FUNCTION_LIST</b> structure
should point to a function stub which simply returns
CKR_FUNCTION_NOT_SUPPORTED.</p>

<p class=MsoNormal>In this structure ‘version’ is the cryptoki specification
version number. It should match the value of ‘cryptokiVersion’ returned in the
CK_INFO structure.</p>

<p class=MsoNormal>An application may or may not be able to modify a Cryptoki
library’s static <b>CK_FUNCTION_LIST</b> structure.  Whether or not it can, it
should never attempt to do so.</p>

<p class=MsoNormal><b>CK_FUNCTION_LIST_PTR</b> is a pointer to a <b>CK_FUNCTION_LIST</b>.</p>

<p class=MsoNormal><b>CK_FUNCTION_LIST_PTR_PTR</b> is a pointer to a <b>CK_FUNCTION_LIST_PTR</b>.</p>

<h2><a name="_Ref320349815"></a><a name="_Toc319315696"></a><a
name="_Toc319313703"></a><a name="_Toc319313510"></a><a name="_Toc319287669"></a><a
name="_Toc385057849"></a><a name="_Toc383864848"></a><a name="_Toc323610842"></a><a
name="_Toc323205412"></a><a name="_Toc323024081"></a><a name="_Toc323000687"></a><a
name="_Toc322945120"></a><a name="_Toc322855278"></a><a name="_Ref320512055"></a><a
name="_Toc416959692"></a><a name="_Toc395183765"></a><a name="_Toc391468769"></a><a
name="_Toc370633978"></a><a name="_Toc235002270"></a><a name="_Toc72656055"></a><a
name="_Ref407445939"></a><a name="_Toc405794658">3.7 Locking-related types</a></h2>

<p class=MsoNormal>The types in this section are provided solely for
applications which need to access Cryptoki from multiple threads
simultaneously.  <i>Applications which will not do this need not use any of
these types.</i></p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002271"></a><a name="_Toc72656056"></a><a name="_Toc405794659"><span
style='font-family:Symbol;font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_CREATEMUTEX</span></a></p>

<p class=MsoNormal><b>CK_CREATEMUTEX</b> is the type of a pointer to an
application-supplied function which creates a new mutex object and returns a
pointer to it.  It is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_CALLBACK_FUNCTION(CK_RV, CK_CREATEMUTEX)(</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_VOID_PTR_PTR ppMutex</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>);</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>Calling a CK_CREATEMUTEX function returns the pointer to the
new mutex object in the location pointed to by ppMutex.  Such a function should
return one of the following values:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKR_OK,
CKR_GENERAL_ERROR</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKR_HOST_MEMORY</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002272"></a><a name="_Toc72656057"></a><a name="_Toc405794660"><span
style='font-family:Symbol;font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_DESTROYMUTEX</span></a></p>

<p class=MsoNormal><b>CK_DESTROYMUTEX</b> is the type of a pointer to an
application-supplied function which destroys an existing mutex object.  It is
defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_CALLBACK_FUNCTION(CK_RV, CK_DESTROYMUTEX)(</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_VOID_PTR pMutex</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>);</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>The argument to a CK_DESTROYMUTEX function is a pointer to
the mutex object to be destroyed.  Such a function should return one of the
following values:<span style='font-size:12.0pt'> </span></p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKR_OK,
CKR_GENERAL_ERROR</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKR_HOST_MEMORY</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKR_MUTEX_BAD</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002273"></a><a name="_Toc72656058"></a><a name="_Toc405794661"><span
style='font-family:Symbol;font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_LOCKMUTEX</span></a><span
style='font-family:"Arial","sans-serif"'> and CK_UNLOCKMUTEX</span></p>

<p class=MsoNormal><b>CK_LOCKMUTEX</b> is the type of a pointer to an
application-supplied function which locks an existing mutex object.  <b>CK_UNLOCKMUTEX</b>
is the type of a pointer to an application-supplied function which unlocks an
existing mutex object.  The proper behavior for these types of functions is as
follows:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>If a CK_LOCKMUTEX function is called on a mutex which is not
locked, the calling thread obtains a lock on that mutex and returns.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>If a CK_LOCKMUTEX function is called on a mutex which is locked
by some thread other than the calling thread, the calling thread blocks and
waits for that mutex to be unlocked.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>If a CK_LOCKMUTEX function is called on a mutex which is locked
by the calling thread, the behavior of the function call is undefined.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>If a CK_UNLOCKMUTEX function is called on a mutex which is locked
by the calling thread, that mutex is unlocked and the function call returns. 
Furthermore:</p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span>If exactly one thread was blocking on that particular mutex, then
that thread stops blocking, obtains a lock on that mutex, and its CK_LOCKMUTEX
call returns.</p>

<p class=MsoNormal style='margin-left:.75in;text-indent:-.25in'><span
style='font-family:"Courier New"'>o<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span>If more than one thread was blocking on that particular mutex,
then exactly one of the blocking threads is selected somehow.  That lucky
thread stops blocking, obtains a lock on the mutex, and its CK_LOCKMUTEX call
returns.  All other threads blocking on that particular mutex continue to
block.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>If a CK_UNLOCKMUTEX function is called on a mutex which is not
locked, then the function call returns the error code CKR_MUTEX_NOT_LOCKED.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>If a CK_UNLOCKMUTEX function is called on a mutex which is locked
by some thread other than the calling thread, the behavior of the function call
is undefined.</p>

<p class=MsoNormal><b>CK_LOCKMUTEX</b> is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_CALLBACK_FUNCTION(CK_RV, CK_LOCKMUTEX)(</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_VOID_PTR pMutex</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>);</p>

<p class=Code style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.8in;margin-bottom:.0001pt;text-indent:-.8in;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>The argument to a CK_LOCKMUTEX function is a pointer to the
mutex object to be locked.  Such a function should return one of the following
values:<span style='font-size:12.0pt'> </span></p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKR_OK,
CKR_GENERAL_ERROR</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKR_HOST_MEMORY,</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKR_MUTEX_BAD</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

</div>

<p class=MsoNormal><b>CK_UNLOCKMUTEX</b> is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
CK_CALLBACK_FUNCTION(CK_RV, CK_UNLOCKMUTEX)(</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_VOID_PTR pMutex</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>);</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>&nbsp;</p>

</div>

<p class=MsoNormal>The argument to a CK_UNLOCKMUTEX function is a pointer to
the mutex object to be unlocked.  Such a function should return one of the
following values:<span style='font-size:12.0pt'> </span></p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKR_OK,
CKR_GENERAL_ERROR</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKR_HOST_MEMORY</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKR_MUTEX_BAD</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CKR_MUTEX_NOT_LOCKED</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002274"></a><a name="_Toc72656059"></a><a name="_Toc405794663"><span
style='font-family:Symbol;font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>CK_C_INITIALIZE_ARGS</span></a><span
style='font-family:"Arial","sans-serif"'>; CK_C_INITIALIZE_ARGS_PTR</span></p>

<p class=MsoNormal><b>CK_C_INITIALIZE_ARGS</b> is a structure containing the
optional arguments for the <b>C_Initialize</b> function.  For this version of
Cryptoki, these optional arguments are all concerned with the way the library
deals with threads.  <b>CK_C_INITIALIZE_ARGS</b> is defined as follows:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>typedef
struct CK_C_INITIALIZE_ARGS {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_CREATEMUTEX CreateMutex;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_DESTROYMUTEX DestroyMutex;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_LOCKMUTEX LockMutex;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_UNLOCKMUTEX UnlockMutex;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_FLAGS flags;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
CK_VOID_PTR pReserved;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>}
CK_C_INITIALIZE_ARGS;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'><span
style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

</div>

<p class=MsoNormal>The fields of the structure have the following meanings:</p>

<p class=definition0>                              <i>CreateMutex</i>       pointer
to a function to use for creating mutex objects</p>

<p class=definition0>                            <i>DestroyMutex</i>       pointer
to a function to use for destroying mutex objects</p>

<p class=definition0>                                <i>LockMutex</i>       pointer
to a function to use for locking mutex objects</p>

<p class=definition0>                             <i>UnlockMutex</i>       pointer
to a function to use for unlocking mutex objects</p>

<p class=definition0>                                         <i>flags</i>       bit
flags specifying options for <b>C_Initialize</b>; the flags are defined below</p>

<p class=definition0>                                 <i>pReserved</i>       reserved
for future use.  Should be NULL_PTR for this version of Cryptoki</p>

<p class=MsoNormal style='page-break-after:avoid'>The following table defines
the flags field<span style='font-size:12.0pt'>:</span></p>

<p class=MsoCaption><a name="_Toc225305946"></a><a name="_Toc405794975">Table </a>9, C_Initialize Parameter Flags</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=360 valign=top style='width:3.75in;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span lang=SV
   style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Bit Flag</span></b></p>
   </td>
   <td width=96 valign=top style='width:1.0in;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span lang=SV
   style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Mask</span></b></p>
   </td>
   <td width=126 valign=top style='width:94.5pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=360 valign=top style='width:3.75in;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_LIBRARY_CANT_CREATE_OS_THREADS</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000001</span></p>
  </td>
  <td width=126 valign=top style='width:94.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if application threads which are
  executing calls to the library may <i>not</i> use native operating system
  calls to spawn new threads; false if they may</span></p>
  </td>
 </tr>
 <tr>
  <td width=360 valign=top style='width:3.75in;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKF_OS_LOCKING_OK</span></p>
  </td>
  <td width=96 valign=top style='width:1.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>0x00000002</span></p>
  </td>
  <td width=126 valign=top style='width:94.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>True if the library can use the native
  operation system threading model for locking; false otherwise</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><a name="_Toc405794664"></a><a name="_Ref398028757">CK_C_INITIALIZE_ARGS_PTR
is a pointer to a CK_C_INITIALIZE_ARGS.</a></p>

<div style='border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in'>

<h1><a name="_Toc416959693"></a><a name="_Toc395183766"></a><a
name="_Toc391468770"></a><a name="_Toc370633979"></a><a name="_Toc235002275"></a><a
name="_Toc72656060"></a><a name="_Ref457115175">4<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Objects</a></h1>

</div>

<p class=MsoNormal>Cryptoki recognizes a number of classes of objects, as
defined in the <b>CK_OBJECT_CLASS</b> data type.  An object consists of a set
of attributes, each of which has a given value. Each attribute that an object
possesses has precisely one value.  The following figure illustrates the
high-level hierarchy of the Cryptoki objects and some of the attributes they
support:</p>

<p class=MsoNormal align=center style='text-align:center;page-break-after:avoid'><img
border=0 width=529 height=385 src="pkcs11-base-v2.40-os_files/image002.png"></p>

<p class=MsoCaption><a name="_Toc225305929">Figure </a>1, Object Attribute
Hierarchy</p>

<p class=MsoNormal>Cryptoki provides functions for creating, destroying, and
copying objects in general, and for obtaining and modifying the values of their
attributes.  Some of the cryptographic functions (<i>e.g.</i>, <b>C_GenerateKey</b>)
also create key objects to hold their results.</p>

<p class=MsoNormal>Objects are always “well-formed” in Cryptoki—that is, an
object always contains all required attributes, and the attributes are always
consistent with one another from the time the object is created.  This
contrasts with some object-based paradigms where an object has no attributes
other than perhaps a class when it is created, and is uninitialized for some
time.  In Cryptoki, objects are always initialized.</p>

<p class=MsoNormal>Tables throughout most of Section 4 define each Cryptoki attribute in terms of the data type of the attribute value and the meaning of the
attribute, which may include a default initial value.  Some of the data types
are defined explicitly by Cryptoki (<i>e.g.</i>, <b>CK_OBJECT_CLASS</b>). 
Attribute values may also take the following types:</p>

<p class=definition0>                                 Byte array       an
arbitrary string (array) of <b>CK_BYTE</b>s</p>

<p class=definition0>                                Big integer       a string
of <b>CK_BYTE</b>s representing an unsigned integer of arbitrary size,
most-significant byte first (<i>e.g.</i>, the integer 32768 is represented as
the 2-byte string 0x80 0x00)</p>

<p class=definition0>                               Local string       an
unpadded string of <b>CK_CHAR</b>s (see Table 3) with no null-termination</p>

<p class=definition0>                         RFC2279 string       an unpadded
string of <strong>CK_UTF8CHARs</strong> with no null-termination</p>

<p class=MsoNormal>A token can hold several identical objects, <i>i.e.</i>, it
is permissible for two or more objects to have exactly the same values for all
their attributes.</p>

<p class=MsoNormal>In most cases each type of object in the Cryptoki
specification possesses a completely well-defined set of Cryptoki attributes.
Some of these attributes possess default values, and need not be specified when
creating an object; some of these default values may even be the empty string
(“”).  Nonetheless, the object possesses these attributes.  A given object has
a single value for each attribute it possesses, even if the attribute is a
vendor-specific attribute whose meaning is outside the scope of Cryptoki.</p>

<p class=MsoNormal>In addition to possessing Cryptoki attributes, objects may
possess additional vendor-specific attributes whose meanings and values are not
specified by Cryptoki.</p>

<h2><a name="_Toc416959694"></a><a name="_Toc395183767"></a><a
name="_Toc391468771"></a><a name="_Toc370633980"></a><a name="_Toc235002276"></a><a
name="_Toc72656061"></a><a name="_Toc405794665"></a><a name="_Ref399824797"></a><a
name="_Ref399824759"></a><a name="_Ref399824691">4.1 Creating, modifying, and
copying objects</a></h2>

<p class=MsoNormal>All Cryptoki functions that create, modify, or copy objects
take a template as one of their arguments, where the template specifies
attribute values.  Cryptographic functions that create objects (see Section 5.13) may also contribute some additional attribute values themselves; which
attributes have values contributed by a cryptographic function call depends on
which cryptographic mechanism is being performed (see [PKCS11-Curr] and
[PKCS11-Hist] for specification of mechanisms for PKCS #11).  In any case, all
the required attributes supported by an object class that do not have default
values MUST be specified when an object is created, either in the template or
by the function itself.</p>

<h3><a name="_Toc416959695"></a><a name="_Toc395183768"></a><a
name="_Toc391468772"></a><a name="_Toc370633981"></a><a name="_Toc235002277"></a><a
name="_Toc72656062"></a><a name="_Toc405794666"></a><a name="_Ref399215106">4.1.1
Creating objects</a></h3>

<p class=MsoNormal>Objects may be created with the Cryptoki functions <b>C_CreateObject</b>
(see Section 5.7), <b>C_GenerateKey</b>, <b>C_GenerateKeyPair</b>, <b>C_UnwrapKey</b>,
and <b>C_DeriveKey</b> (see Section 5.13).  In addition, copying an existing
object (with the function <b>C_CopyObject</b>) also creates a new object, but
we consider this type of object creation separately in Section 4.1.3.</p>

<p class=MsoNormal>Attempting to create an object with any of these functions
requires an appropriate template to be supplied.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.0pt;
margin-left:.25in;text-align:justify;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>If the
supplied template specifies a value for an invalid attribute, then the attempt
should fail with the error code CKR_ATTRIBUTE_TYPE_INVALID.  An attribute is
valid if it is either one of the attributes described in the Cryptoki
specification or an additional vendor-specific attribute supported by the
library and token.</p>

<p class=MsoList><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:10.0pt;font-family:"Arial","sans-serif"'>If the supplied
template specifies an invalid value for a valid attribute, then the attempt
should fail with the error code CKR_ATTRIBUTE_VALUE_INVALID.  The valid values
for Cryptoki attributes are described in the Cryptoki specification.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.0pt;
margin-left:.25in;text-align:justify;text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>If the
supplied template specifies a value for a read-only attribute, then the attempt
should fail with the error code CKR_ATTRIBUTE_READ_ONLY.  Whether or not a
given Cryptoki attribute is read-only is explicitly stated in the Cryptoki
specification; however, a particular library and token may be even more
restrictive than Cryptoki specifies.  In other words, an attribute which
Cryptoki says is not read-only may nonetheless be read-only under certain
circumstances (<i>i.e.</i>, in conjunction with some combinations of other
attributes) for a particular library and token.  Whether or not a given
non-Cryptoki attribute is read-only is obviously outside the scope of Cryptoki.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.0pt;
margin-left:.25in;text-align:justify;text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>If the
attribute values in the supplied template, together with any default attribute
values and any attribute values contributed to the object by the
object-creation function itself, are insufficient to fully specify the object
to create, then the attempt should fail with the error code
CKR_TEMPLATE_INCOMPLETE.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.0pt;
margin-left:.25in;text-align:justify;text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>If the
attribute values in the supplied template, together with any default attribute
values and any attribute values contributed to the object by the
object-creation function itself, are inconsistent, then the attempt should fail
with the error code CKR_TEMPLATE_INCONSISTENT.  A set of attribute values is
inconsistent if not all of its members can be satisfied simultaneously <i>by
the token</i>, although each value individually is valid in Cryptoki. One
example of an inconsistent template would be using a template which specifies
two different values for the same attribute.  Another example would be trying
to create a secret key object with an attribute which is appropriate for
various types of public keys or private keys, but not for secret keys.  A final
example would be a template with an attribute that violates some token specific
requirement.  Note that this final example of an inconsistent template is
token-dependent—on a different token, such a template might <i>not</i> be
inconsistent.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.0pt;
margin-left:.25in;text-align:justify;text-indent:-.25in'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>If the
supplied template specifies the same value for a particular attribute more than
once (or the template specifies the same value for a particular attribute that
the object-creation function itself contributes to the object), then the
behavior of Cryptoki is not completely specified.  The attempt to create an
object can either succeed—thereby creating the same object that would have been
created if the multiply-specified attribute had only appeared once—or it can
fail with error code CKR_TEMPLATE_INCONSISTENT.  Library developers are
encouraged to make their libraries behave as though the attribute had only
appeared once in the template; application developers are strongly encouraged
never to put a particular attribute into a particular template more than once.</p>

<p class=MsoNormal>If more than one of the situations listed above applies to
an attempt to create an object, then the error code returned from the attempt
can be any of the error codes from above that applies.</p>

<h3><a name="_Toc416959696"></a><a name="_Toc395183769"></a><a
name="_Toc391468773"></a><a name="_Toc370633982"></a><a name="_Toc235002278"></a><a
name="_Ref226351743"></a><a name="_Toc72656063"></a><a name="_Toc405794667">4.1.2
Modifying objects</a></h3>

<p class=MsoNormal>Objects may be modified with the Cryptoki function <b>C_SetAttributeValue</b>
(see Section 5.7).  The template supplied to <b>C_SetAttributeValue</b> can
contain new values for attributes which the object already possesses; values
for attributes which the object does not yet possess; or both.</p>

<p class=MsoNormal>Some attributes of an object may be modified after the
object has been created, and some may not.  In addition, attributes which
Cryptoki specifies are modifiable may actually <i>not</i> be modifiable on some
tokens.  That is, if a Cryptoki attribute is described as being modifiable,
that really means only that it is modifiable <i>insofar as the Cryptoki
specification is concerned</i>.  A particular token might not actually support
modification of some such attributes.  Furthermore, whether or not a particular
attribute of an object on a particular token is modifiable might depend on the
values of certain attributes of the object.  For example, a secret key object’s
<b>CKA_SENSITIVE</b> attribute can be changed from CK_FALSE to CK_TRUE, but not
the other way around.</p>

<p class=MsoNormal>All the scenarios in Section 4.1.1—and the error codes they return—apply to modifying objects with <b>C_SetAttributeValue</b>, except
for the possibility of a template being incomplete.</p>

<h3><a name="_Toc416959697"></a><a name="_Toc395183770"></a><a
name="_Toc391468774"></a><a name="_Toc370633983"></a><a name="_Toc235002279"></a><a
name="_Toc72656064"></a><a name="_Toc405794668"></a><a name="_Ref399147407">4.1.3
Copying objects</a></h3>

<p class=MsoNormal><span style='color:black'>Unless an object's CKA_COPYABLE
(see table 21) attribute is set to CK_FALSE, it </span>may be copied with the
Cryptoki function <b>C_CopyObject</b> (see Section 5.7).  In the process of copying an object, <b>C_CopyObject</b> also modifies the attributes of the
newly-created copy according to an application-supplied template.</p>

<p class=MsoNormal>The Cryptoki attributes which can be modified during the
course of a <b>C_CopyObject</b> operation are the same as the Cryptoki
attributes which are described as being modifiable, plus the three special
attributes <b>CKA_TOKEN</b>, <b>CKA_PRIVATE</b>, <b>CKA_MODIFIABLE and
CKA_DESTROYABLE</b>.  To be more precise, these attributes are modifiable
during the course of a <b>C_CopyObject</b> operation <i>insofar as the Cryptoki
specification is concerned</i>.  A particular token might not actually support
modification of some such attributes during the course of a <b>C_CopyObject</b>
operation.  Furthermore, whether or not a particular attribute of an object on
a particular token is modifiable during the course of a <b>C_CopyObject</b>
operation might depend on the values of certain attributes of the object.  For
example, a secret key object’s <b>CKA_SENSITIVE</b> attribute can be changed
from CK_FALSE to CK_TRUE during the course of a <b>C_CopyObject</b> operation,
but not the other way around.</p>

<p class=MsoNormal><a name="_Toc385057850"></a><a name="_Toc383864849"></a><a
name="_Toc323610843"></a><a name="_Toc323205413"></a><a name="_Toc323024082"></a><a
name="_Toc323000688"></a><a name="_Toc322945121"></a><a name="_Toc322855279"><span
style='color:black'>If the CKA_COPYABLE attribute of the object to be copied is
set to CK_FALSE, C_CopyObject returns CKR_ACTION_PROHIBITED.  Otherwise, the
scenarios described in 10.1.1 - and the error codes they return - apply to
copying objects with C_CopyObject, except for the possibility of a template
being incomplete</span>.</a></p>

<h2><a name="_Toc416959698"></a><a name="_Toc395183771"></a><a
name="_Toc391468775"></a><a name="_Toc370633984"></a><a name="_Toc235002280"></a><a
name="_Toc72656065"></a><a name="_Toc405794669"></a><a name="_Common_attributes"></a>4.2
Common attributes</h2>

<p class=MsoCaption><a name="_Toc225305947"></a><a name="_Toc405794980"></a><a
name="_Ref62896792">Table </a>10, Common footnotes for object attribute tables</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=576 valign=top style='width:6.0in;border:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><sup><span style='font-size:12.0pt'>1</span></sup><span
  style='font-size:12.0pt'> </span>MUST be specified when object is created
  with <b>C_CreateObject</b>.</p>
  <p class=MsoNormal><sup>2</sup> MUST <i>not</i> be specified when object is
  created with <b>C_CreateObject</b>.</p>
  <p class=MsoNormal><sup>3</sup> MUST be specified when object is generated
  with <b>C_GenerateKey</b> or <b>C_GenerateKeyPair</b>.</p>
  <p class=MsoNormal><sup>4</sup> MUST <i>not</i> be specified when object is
  generated with <b>C_GenerateKey</b> or <b>C_GenerateKeyPair</b>.</p>
  <p class=MsoNormal><sup>5</sup> MUST be specified when object is unwrapped
  with <b>C_UnwrapKey</b>.</p>
  <p class=MsoNormal><sup>6</sup> MUST <i>not</i> be specified when object is
  unwrapped with <b>C_UnwrapKey</b>.</p>
  <p class=MsoNormal><sup>7</sup> Cannot be revealed if object has its <b>CKA_SENSITIVE</b>
  attribute set to CK_TRUE or its <b>CKA_EXTRACTABLE</b> attribute set to
  CK_FALSE.</p>
  <p class=MsoNormal><sup>8</sup> May be modified after object is created with
  a <b>C_SetAttributeValue</b> call, or in the process of copying object with a
  <b>C_CopyObject</b> call.  However, it is possible that a particular token
  may not permit modification of the attribute during the course of a <b>C_CopyObject</b>
  call.</p>
  <p class=MsoNormal><sup>9</sup> Default value is token-specific, and may
  depend on the values of other attributes.</p>
  <p class=MsoNormal><sup>10 </sup>Can only be set to CK_TRUE by the SO user.</p>
  <p class=MsoNormal><sup>11</sup> Attribute cannot be changed once set to
  CK_TRUE. It becomes a read only attribute.</p>
  <p class=MsoNormal><sup>12</sup> Attribute cannot be changed once set to
  CK_FALSE. It becomes a read only attribute.</p>
  <p class=MsoNormal>&nbsp;</p>
  </td>
 </tr>
</table>

<p class=space><span style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

<p class=MsoCaption><a name="_Toc225305948"></a><a name="_Ref457120194"></a><a
name="_Ref457120199">Table </a>11, Common Object Attributes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=156 valign=top style='width:117.0pt;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Attribute</span></b></p>
   </td>
   <td width=162 valign=top style='width:121.5pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Data Type</span></b></p>
   </td>
   <td width=265 valign=top style='width:198.9pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_CLASS<sup>1</sup></span></p>
  </td>
  <td width=162 valign=top style='width:121.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_OBJECT_CLASS</span></p>
  </td>
  <td width=265 valign=top style='width:198.9pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Object class (type)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><sup> </sup>Refer to Table 10 for footnotes</p>

<p class=MsoNormal>The above table defines the attributes common to all
objects.</p>

<h2><a name="_Toc416959699"></a><a name="_Toc395183772"></a><a
name="_Toc391468776"></a><a name="_Toc370633985"></a><a name="_Toc235002281"></a><a
name="_Toc72656066">4.3 Hardware Feature Objects</a></h2>

<h3><a name="_Toc416959700"></a><a name="_Toc395183773"></a><a
name="_Toc391468777"></a><a name="_Toc370633986"></a><a name="_Toc235002282"></a><a
name="_Toc72656067">4.3.1 Definitions</a></h3>

<p class=MsoNormal>This section defines the object class CKO_HW_FEATURE for
type CK_OBJECT_CLASS as used in the CKA_CLASS attribute of  objects.</p>

<h3><a name="_Toc416959701"></a><a name="_Toc395183774"></a><a
name="_Toc391468778"></a><a name="_Toc370633987"></a><a name="_Toc235002283"></a><a
name="_Toc72656068">4.3.2 Overview</a></h3>

<p class=MsoNormal>Hardware feature objects (<b>CKO_HW_FEATURE</b>) represent
features of the device. They provide an easily expandable method for
introducing new value-based features to the Cryptoki interface.</p>

<p class=MsoNormal>When searching for objects using <b>C_FindObjectsInit</b>
and <b>C_FindObjects</b>, hardware feature objects are not returned unless the <b>CKA_CLASS</b>
attribute in the template has the value <b>CKO_HW_FEATURE</b>. This protects
applications written to previous versions of Cryptoki from finding objects that
they do not understand.</p>

<p class=MsoCaption><a name="_Toc225305949">Table </a>12, Hardware Feature
Common Attributes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=216 valign=top style='width:2.25in;border:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Attribute</span></b></p>
  </td>
  <td width=180 valign=top style='width:135.0pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Data Type</span></b></p>
  </td>
  <td width=187 valign=top style='width:1.95in;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Meaning</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=216 valign=top style='width:2.25in;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_HW_FEATURE_TYPE<sup>1</sup></span></p>
  </td>
  <td width=180 valign=top style='width:135.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_HW_FEATURE_TYPE</span></p>
  </td>
  <td width=187 valign=top style='width:1.95in;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Hardware feature (type)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><sup>- </sup>Refer to Table 10 for footnotes</p>

<h3><a name="_Toc416959702"></a><a name="_Toc395183775"></a><a
name="_Toc391468779"></a><a name="_Toc370633988"></a><a name="_Toc235002284">4.3.3
Clock</a></h3>

<h4>4.3.3.1 Definition</h4>

<p class=MsoNormal>The CKA_HW_FEATURE_TYPE attribute takes the value CKH_CLOCK
of type CK_HW_FEATURE.</p>

<h4>4.3.3.2 Description</h4>

<p class=MsoNormal>Clock objects represent real-time clocks that exist on the
device. This represents the same clock source as the <b>utcTime</b> field in
the <b>CK_TOKEN_INFO</b> structure.</p>

<p class=MsoCaption><a name="_Toc225305950">Table </a>13, Clock Object
Attributes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=114 valign=top style='width:85.5pt;border:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Attribute</span></b></p>
  </td>
  <td width=120 valign=top style='width:1.25in;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Data Type</span></b></p>
  </td>
  <td width=349 valign=top style='width:261.9pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Meaning</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=114 valign=top style='width:85.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_VALUE</span></p>
  </td>
  <td width=120 valign=top style='width:1.25in;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_CHAR[16]</span></p>
  </td>
  <td width=349 valign=top style='width:261.9pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Current time as a character-string of
  length 16, represented in the format YYYYMMDDhhmmssxx (4 characters for the
  year;  2 characters each for the month, the day, the hour, the minute, and
  the second; and 2 additional reserved ‘0’ characters).</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>The <b>CKA_VALUE</b> attribute may be set using the <b>C_SetAttributeValue</b>
function if permitted by the device. The session used to set the time MUST be
logged in. The device may require the SO to be the user logged in to modify the
time value. <b>C_SetAttributeValue</b> will return the error
CKR_USER_NOT_LOGGED_IN to indicate that a different user type is required to
set the value.</p>

<h3><a name="_Toc416959703"></a><a name="_Toc395183776"></a><a
name="_Toc391468780"></a><a name="_Toc370633989"></a><a name="_Toc235002285">4.3.4
Monotonic Counter Objects</a></h3>

<h4>4.3.4.1 Definition</h4>

<p class=MsoNormal>The CKA_HW_FEATURE_TYPE attribute takes the value CKH_MONOTONIC_COUNTER
of type CK_HW_FEATURE.</p>

<h4>4.3.4.2 Description</h4>

<p class=MsoNormal>Monotonic counter objects represent hardware counters that
exist on the device. The counter is guaranteed to increase each time its value
is read, but not necessarily by one. This might be used by an application for
generating serial numbers to get some assurance of uniqueness per token.</p>

<p class=MsoCaption><a name="_Toc225305951">Table </a>14, Monotonic Counter
Attributes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=186 valign=top style='width:139.5pt;border:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Attribute</span></b></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Data Type</span></b></p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Meaning</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=186 valign=top style='width:139.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_RESET_ON_INIT<sup>1</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>The value of the counter will reset to a
  previously returned value if the token is initialized using <b>C_InitToken</b>.</span></p>
  </td>
 </tr>
 <tr>
  <td width=186 valign=top style='width:139.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_HAS_RESET<sup>1</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>The value of the counter has been reset at
  least once at some point in time.</span></p>
  </td>
 </tr>
 <tr>
  <td width=186 valign=top style='width:139.5pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_VALUE<sup>1</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Byte Array</span></p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>The current version of the monotonic
  counter. The value is returned in big endian order.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><sup>1</sup>Read Only</p>

<p class=MsoNormal>The <b>CKA_VALUE</b> attribute may not be set by the client.</p>

<h3><a name="_Toc416959704"></a><a name="_Toc395183777"></a><a
name="_Toc391468781"></a><a name="_Toc370633990"></a><a name="_Toc235002286">4.3.5
User Interface Objects</a></h3>

<h4>4.3.5.1 Definition</h4>

<p class=MsoNormal>The CKA_HW_FEATURE_TYPE attribute takes the value
CKH_USER_INTERFACE of type CK_HW_FEATURE.</p>

<h4>4.3.5.2 Description</h4>

<p class=MsoNormal>User interface objects represent the presentation
capabilities of the device.</p>

<p class=MsoCaption><a name="_Toc225305952">Table </a>15, User Interface Object
Attributes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr style='page-break-inside:avoid;height:8.5pt'>
   <td width=217 valign=top style='width:163.05pt;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.75pt 0in 5.75pt;height:8.5pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif";layout-grid-mode:line'>Attribute</span></b></p>
   </td>
   <td width=104 valign=top style='width:77.95pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt;height:8.5pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Data type</span></b></p>
   </td>
   <td width=261 valign=top style='width:195.5pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt;height:8.5pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
  <tr>
   <td width=217 valign=top style='width:163.05pt;border-top:none;border-left:
   solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span lang=EN-AU
   style='font-size:10.0pt;font-family:"Arial","sans-serif";layout-grid-mode:
   line'>CKA_PIXEL_X</span></p>
   </td>
   <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
   none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif"'>CK_ULONG</span></p>
   </td>
   <td width=261 valign=top style='width:195.5pt;border-top:none;border-left:
   none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif"'>Screen resolution (in pixels) in X-axis
   (e.g. 1280)</span></p>
   </td>
  </tr>
  <tr style='page-break-inside:avoid'>
   <td width=217 valign=top style='width:163.05pt;border-top:none;border-left:
   solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span lang=SV
   style='font-size:10.0pt;font-family:"Arial","sans-serif";layout-grid-mode:
   line'>CKA_PIXEL_Y</span></p>
   </td>
   <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
   none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif"'>CK_ULONG</span></p>
   </td>
   <td width=261 valign=top style='width:195.5pt;border-top:none;border-left:
   none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif"'>Screen resolution (in pixels) in Y-axis
   (e.g. 1024)</span></p>
   </td>
  </tr>
  <tr style='page-break-inside:avoid'>
   <td width=217 valign=top style='width:163.05pt;border-top:none;border-left:
   solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span lang=EN-AU
   style='font-size:10.0pt;font-family:"Arial","sans-serif";layout-grid-mode:
   line'>CKA_RESOLUTION</span></p>
   </td>
   <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
   none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif"'>CK_ULONG</span></p>
   </td>
   <td width=261 valign=top style='width:195.5pt;border-top:none;border-left:
   none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif"'>DPI, pixels per inch</span></p>
   </td>
  </tr>
  <tr>
   <td width=217 valign=top style='width:163.05pt;border-top:none;border-left:
   solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif";layout-grid-mode:line'>CKA_CHAR_ROWS</span></p>
   </td>
   <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
   none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif"'>CK_ULONG</span></p>
   </td>
   <td width=261 valign=top style='width:195.5pt;border-top:none;border-left:
   none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif"'>For character-oriented displays; number of
   character rows (e.g. 24)</span></p>
   </td>
  </tr>
  <tr>
   <td width=217 valign=top style='width:163.05pt;border-top:none;border-left:
   solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif";layout-grid-mode:line'>CKA_CHAR_COLUMNS</span></p>
   </td>
   <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
   none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif"'>CK_ULONG</span></p>
   </td>
   <td width=261 valign=top style='width:195.5pt;border-top:none;border-left:
   none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif"'>For character-oriented displays: number of
   character columns (e.g. 80). If display is of proportional-font type, this
   is the width of the display in “em”-s (letter “M”), see CC/PP Struct.</span></p>
   </td>
  </tr>
  <tr>
   <td width=217 valign=top style='width:163.05pt;border-top:none;border-left:
   solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif";layout-grid-mode:line'>CKA_COLOR</span></p>
   </td>
   <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
   none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
   </td>
   <td width=261 valign=top style='width:195.5pt;border-top:none;border-left:
   none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif"'>Color support</span></p>
   </td>
  </tr>
  <tr>
   <td width=217 valign=top style='width:163.05pt;border-top:none;border-left:
   solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif";layout-grid-mode:line'>CKA_BITS_PER_PIXEL</span></p>
   </td>
   <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
   none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif"'>CK_ULONG</span></p>
   </td>
   <td width=261 valign=top style='width:195.5pt;border-top:none;border-left:
   none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>The
   number of bits of color or grayscale information per pixel.</span></p>
   </td>
  </tr>
  <tr>
   <td width=217 valign=top style='width:163.05pt;border-top:none;border-left:
   solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span lang=SV
   style='font-size:10.0pt;font-family:"Arial","sans-serif";layout-grid-mode:
   line'>CKA_CHAR_SETS</span></p>
   </td>
   <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
   none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif"'>RFC 2279 string</span></p>
   </td>
   <td width=261 valign=top style='width:195.5pt;border-top:none;border-left:
   none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
   font-family:"Arial","sans-serif"'>String indicating supported character
   sets, as defined by IANA MIBenum sets (</span><a href="http://www.iana.org/"><span
   style='font-size:10.0pt;font-family:"Arial","sans-serif"'>www.iana.org</span></a><span
   style='font-size:10.0pt;font-family:"Arial","sans-serif"'>). Supported
   character sets are separated with “;”. E.g. a token supporting iso-8859-1
   and US-ASCII would set the attribute value to “4;3”.</span></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=217 valign=top style='width:163.05pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif";layout-grid-mode:line'>CKA_ENCODING_METHODS</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>RFC 2279 string</span></p>
  </td>
  <td width=261 valign=top style='width:195.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>String indicating supported content
  transfer encoding methods, as defined by IANA (</span><a
  href="http://www.iana.org/"><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>www.iana.org</span></a><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>). Supported
  methods are separated with “;”. E.g. a token supporting 7bit, 8bit and base64
  could set the attribute value to “7bit;8bit;base64”.</span></p>
  </td>
 </tr>
 <tr style='page-break-inside:avoid'>
  <td width=217 valign=top style='width:163.05pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif";layout-grid-mode:line'>CKA_MIME_TYPES</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>RFC 2279 string</span></p>
  </td>
  <td width=261 valign=top style='width:195.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>String indicating supported (presentable)
  MIME-types, as defined by IANA (</span><a href="http://www.iana.org/"><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>www.iana.org</span></a><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>). Supported types
  are separated with “;”. E.g. a token supporting MIME types &quot;a/b&quot;,
  &quot;a/c&quot; and &quot;a/d&quot; would set the attribute value to
  “a/b;a/c;a/d”.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>The selection of attributes, and associated data types, has
been done in an attempt to stay as aligned with RFC 2534 and CC/PP Struct as
possible. The special value CK_UNAVAILABLE_INFORMATION may be used for
CK_ULONG-based attributes when information is not available or applicable.</p>

<p class=MsoNormal>None of the attribute values may be set by an application.</p>

<p class=MsoNormal>The value of the <b>CKA_ENCODING_METHODS</b> attribute may
be used when the application needs to send MIME objects with encoded content to
the token.</p>

<h2><a name="_Toc416959705"></a><a name="_Toc395183778"></a><a
name="_Toc391468782"></a><a name="_Toc370633991"></a><a name="_Toc235002287"></a><a
name="_Toc72656069">4.4 Storage Objects</a></h2>

<p class=MsoNormal>This is not an object class; hence no CKO_ definition is
required. It is a category of object classes with common attributes for the
object classes that follow.</p>

<p class=MsoCaption><a name="_Toc225305953"></a><a name="_Toc405794976"></a><a
name="_Ref384017029"></a><a name="_Toc383864513"></a><a name="_Ref323704643"></a><a
name="_Toc323204879"></a><a name="_Toc319315838"></a><a name="_Toc319314966"></a><a
name="_Toc319314551"></a><a name="_Toc319314009"></a><a name="_Ref383948268">Table
</a>16, Common Storage Object Attributes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=156 valign=top style='width:117.0pt;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Attribute</span></b></p>
   </td>
   <td width=162 valign=top style='width:121.5pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Data Type</span></b></p>
   </td>
   <td width=265 valign=top style='width:198.9pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_TOKEN</span></p>
  </td>
  <td width=162 valign=top style='width:121.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=265 valign=top style='width:198.9pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_TRUE if object is a token object; CK_FALSE
  if object is a session object. Default is CK_FALSE.</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_PRIVATE</span></p>
  </td>
  <td width=162 valign=top style='width:121.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=265 valign=top style='width:198.9pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_TRUE if object is a private object;
  CK_FALSE if object is a public object.  Default value is token-specific, and
  may depend on the values of other attributes of the object.</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_MODIFIABLE</span></p>
  </td>
  <td width=162 valign=top style='width:121.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=265 valign=top style='width:198.9pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_TRUE if object can be modified Default
  is CK_TRUE.</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span lang=SV style='font-size:
  10.0pt;font-family:"Arial","sans-serif"'>CKA_LABEL</span></p>
  </td>
  <td width=162 valign=top style='width:121.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span lang=SV style='font-size:
  10.0pt;font-family:"Arial","sans-serif"'>RFC2279 string</span></p>
  </td>
  <td width=265 valign=top style='width:198.9pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Description of the object (default empty).</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span lang=SV style='font-size:
  10.0pt;font-family:"Arial","sans-serif"'>CKA_COPYABLE</span></p>
  </td>
  <td width=162 valign=top style='width:121.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=265 valign=top style='width:198.9pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif";color:black'>CK_TRUE if object can be copied
  using C_CopyObject. Defaults to CK_TRUE.</span><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'> Can’t be set to TRUE once it is set to
  FALSE.</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:117.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span lang=SV style='font-size:
  10.0pt;font-family:"Arial","sans-serif"'>CKA_DESTROYABLE</span></p>
  </td>
  <td width=162 valign=top style='width:121.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=265 valign=top style='width:198.9pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif";color:black'>CK_TRUE if the object can be
  destroyed using C_DestroyObject.  Default is CK_TRUE.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>Only the <b>CKA_LABEL</b> attribute can be modified after
the object is created. (The <b>CKA_TOKEN</b>, <b>CKA_PRIVATE</b>, and <b>CKA_MODIFIABLE</b>
attributes can be changed in the process of copying an object, however.)</p>

<p class=MsoNormal>The <b>CKA_TOKEN</b> attribute identifies whether the object
is a token object or a session object.</p>

<p class=MsoNormal>When the <b>CKA_PRIVATE</b> attribute is CK_TRUE, a user may
not access the object until the user has been authenticated to the token.</p>

<p class=MsoNormal>The value of the <b>CKA_MODIFIABLE</b> attribute determines
whether or not an object is read-only.  </p>

<p class=MsoNormal>The <b>CKA_LABEL</b> attribute is intended to assist users
in browsing.</p>

<p class=MsoNormal><span style='color:black'>The value of the CKA_COPYABLE
attribute determines whether or not an object can be copied.  This attribute
can be used in conjunction with CKA_MODIFIABLE to prevent changes to the
permitted usages of keys and other objects.</span></p>

<p class=MsoNormal><span style='color:black'>The value of the CKA_DESTROYABLE
attribute determines whether the object can be destroyed using C_DestroyObject.</span></p>

<h2><a name="_Ref317568626"></a><a name="_Toc416959706"></a><a
name="_Toc395183779"></a><a name="_Toc391468783"></a><a name="_Toc370633992"></a><a
name="_Toc235002288"></a><a name="_Toc72656070"></a><a name="_Toc405794670"></a><a
name="_Toc385057851"></a><a name="_Toc383864850"></a><a name="_Toc323610844"></a><a
name="_Toc323205414"></a><a name="_Toc323024083"></a><a name="_Toc323000689"></a><a
name="_Toc322945122"></a><a name="_Toc322855280"></a><a name="_Toc319315683"></a><a
name="_Toc319313690"></a><a name="_Toc319313497"></a><a name="_Toc319287656">4.5
Data object</a>s</h2>

<h3><a name="_Toc416959707"></a><a name="_Toc395183780"></a><a
name="_Toc391468784"></a><a name="_Toc370633993"></a><a name="_Toc235002289"></a><a
name="_Toc72656071">4.5.1 Definitions</a></h3>

<p class=MsoNormal>This section defines the object class CKO_DATA for type
CK_OBJECT_CLASS as used in the CKA_CLASS attribute of objects.</p>

<h3><a name="_Toc416959708"></a><a name="_Toc395183781"></a><a
name="_Toc391468785"></a><a name="_Toc370633994"></a><a name="_Toc235002290"></a><a
name="_Toc72656072">4.5.2 Overview</a></h3>

<p class=MsoNormal>Data objects (object class <b>CKO_DATA</b>) hold information
defined by an application. Other than providing access to it, Cryptoki does not
attach any special meaning to a data object. The following table lists the
attributes supported by data objects, in addition to the common attributes
defined for this object class:</p>

<p class=MsoCaption><a name="_Toc225305954"></a><a name="_Toc405794977"></a><a
name="_Toc383864514"></a><a name="_Toc323204880"></a><a name="_Toc319315839"></a><a
name="_Toc319314967"></a><a name="_Toc319314552"></a><a name="_Toc319314010">Table
</a>17, Data Object Attributes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=162 valign=top style='width:121.5pt;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Attribute</span></b></p>
   </td>
   <td width=90 valign=top style='width:67.5pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Data type</span></b></p>
   </td>
   <td width=331 valign=top style='width:3.45in;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=162 valign=top style='width:121.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_APPLICATION</span></p>
  </td>
  <td width=90 valign=top style='width:67.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>RFC2279 string</span></p>
  </td>
  <td width=331 valign=top style='width:3.45in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Description of the application that manages
  the object (default empty)</span></p>
  </td>
 </tr>
 <tr>
  <td width=162 valign=top style='width:121.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_OBJECT_ID</span></p>
  </td>
  <td width=90 valign=top style='width:67.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Byte Array</span></p>
  </td>
  <td width=331 valign=top style='width:3.45in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>DER-encoding of the object identifier
  indicating the data object type (default empty)</span></p>
  </td>
 </tr>
 <tr>
  <td width=162 valign=top style='width:121.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_VALUE</span></p>
  </td>
  <td width=90 valign=top style='width:67.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Byte array</span></p>
  </td>
  <td width=331 valign=top style='width:3.45in;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Value of the object (default empty)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>The <b>CKA_APPLICATION</b> attribute provides a means for
applications to indicate ownership of the data objects they manage. Cryptoki
does not provide a means of ensuring that only a particular application has
access to a data object, however.</p>

<p class=MsoNormal>The <b>CKA_OBJECT_ID</b> attribute provides an application
independent and expandable way to indicate the type of the data object value.
Cryptoki does not provide a means of insuring that the data object identifier
matches the data value.</p>

<p class=MsoNormal>The following is a sample template containing attributes for
creating a data object:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_OBJECT_CLASS
class = CKO_DATA;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_UTF8CHAR
label[] = “A data object”;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_UTF8CHAR
application[] = “An application”;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_BYTE
data[] = “Sample data”;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_BBOOL
true = CK_TRUE;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_ATTRIBUTE
template[] = {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_CLASS, &amp;class, sizeof(class)},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_TOKEN, &amp;true, sizeof(true)},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_LABEL, label, sizeof(label)-1},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_APPLICATION, application, sizeof(application)-1},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  {CKA_VALUE,
data, sizeof(data)}</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>};</p>

</div>

<h2><a name="_Toc416959709"></a><a name="_Toc395183782"></a><a
name="_Toc391468786"></a><a name="_Toc370633995"></a><a name="_Toc235002291"></a><a
name="_Toc72656073"></a><a name="_Toc405794671"></a><a name="_Ref388965223"></a><a
name="_Toc385057852"></a><a name="_Toc383864851"></a><a name="_Ref383856511"></a><a
name="_Toc323610845"></a><a name="_Toc323205415"></a><a name="_Toc323024084"></a><a
name="_Toc323000690"></a><a name="_Toc322945123"></a><a name="_Toc322855281"></a><a
name="_Toc319315684"></a><a name="_Toc319313691"></a><a name="_Toc319313498"></a><a
name="_Toc319287657">4.6 Certificate objects</a></h2>

<h3><a name="_Toc416959710"></a><a name="_Toc395183783"></a><a
name="_Toc391468787"></a><a name="_Toc370633996"></a><a name="_Toc235002292"></a><a
name="_Toc72656074">4.6.1 Definitions</a></h3>

<p class=MsoNormal>This section defines the object class CKO_CERTIFICATE for
type CK_OBJECT_CLASS as used in the CKA_CLASS attribute of objects.</p>

<h3><a name="_Toc416959711"></a><a name="_Toc395183784"></a><a
name="_Toc391468788"></a><a name="_Toc370633997"></a><a name="_Toc235002293"></a><a
name="_Toc72656075">4.6.2 Overview</a></h3>

<p class=MsoNormal>Certificate objects (object class <b>CKO_CERTIFICATE</b>)
hold public-key or attribute certificates. Other than providing access to
certificate objects, Cryptoki does not attach any special meaning to
certificates. The following table defines the common certificate object
attributes, in addition to the common attributes defined for this object class:</p>

<p class=MsoCaption><a name="_Toc225305955"></a><a name="_Toc405794978"></a><a
name="_Toc383864515"></a><a name="_Ref383948332">Table </a>18, Common Certificate Object Attributes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=222 valign=top style='width:166.5pt;border:solid black 1.0pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-family:
   "Arial","sans-serif"'>Attribute</span></b></p>
   </td>
   <td width=222 valign=top style='width:166.5pt;border:solid black 1.0pt;
   border-left:none;padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-family:
   "Arial","sans-serif"'>Data type</span></b></p>
   </td>
   <td width=138 valign=top style='width:103.5pt;border:solid black 1.0pt;
   border-left:none;padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-family:
   "Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=222 valign=top style='width:166.5pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_CERTIFICATE_TYPE<sup>1</sup></span></p>
  </td>
  <td width=222 valign=top style='width:166.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_CERTIFICATE_TYPE</span></p>
  </td>
  <td width=138 valign=top style='width:103.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Type
  of certificate</span></p>
  </td>
 </tr>
 <tr>
  <td width=222 valign=top style='width:166.5pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_TRUSTED<sup>10</sup></span></p>
  </td>
  <td width=222 valign=top style='width:166.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=138 valign=top style='width:103.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>The
  certificate can be trusted for the application that it was created.</span></p>
  </td>
 </tr>
 <tr>
  <td width=222 valign=top style='width:166.5pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_CERTIFICATE_CATEGORY</span></p>
  </td>
  <td width=222 valign=top style='width:166.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'>CKA_CERTIFICATE_CATEGORY
  </p>
  </td>
  <td width=138 valign=top style='width:103.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>(default
  CK_CERTIFICATE_CATEGORY_UNSPECIFIED)</span></p>
  </td>
 </tr>
 <tr>
  <td width=222 valign=top style='width:166.5pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_CHECK_VALUE</span></p>
  </td>
  <td width=222 valign=top style='width:166.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Byte
  array</span></p>
  </td>
  <td width=138 valign=top style='width:103.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Checksum</span></p>
  </td>
 </tr>
 <tr>
  <td width=222 valign=top style='width:166.5pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_START_DATE</span></p>
  </td>
  <td width=222 valign=top style='width:166.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_DATE</span></p>
  </td>
  <td width=138 valign=top style='width:103.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Start
  date for the certificate (default empty)</span></p>
  </td>
 </tr>
 <tr>
  <td width=222 valign=top style='width:166.5pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_END_DATE </span></p>
  </td>
  <td width=222 valign=top style='width:166.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_DATE
  </span></p>
  </td>
  <td width=138 valign=top style='width:103.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>End
  date for the certificate (default empty)</span></p>
  </td>
 </tr>
 <tr>
  <td width=222 valign=top style='width:166.5pt;border:solid black 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_PUBLIC_KEY_INFO</span></p>
  </td>
  <td width=222 valign=top style='width:166.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Byte
  Array</span></p>
  </td>
  <td width=138 valign=top style='width:103.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>DER-encoding
  of the SubjectPublicKeyInfo for the public key contained in this certificate
  (default empty)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><sup>- </sup>Refer to Table 10 for footnotes</p>

<p class=MsoNormal>Cryptoki does not enforce the relationship of the
CKA_PUBLIC_KEY_INFO to the public key in the certificate, but does recommend
that the key be extracted from the certificate to create this value.</p>

<p class=MsoNormal>The <b>CKA_CERTIFICATE_TYPE</b> attribute may not be modified
after an object is created. This version of Cryptoki supports the following
certificate types:</p>

<p class=MsoList2 style='margin-bottom:0in;margin-bottom:.0001pt'><span
style='font-size:10.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>X.509
public key certificate</span></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='margin-top:0in;margin-bottom:0in;margin-bottom:
     .0001pt;text-align:justify'>WTLS public key certificate</li>
</ul>

<p class=MsoList2><span style='font-size:10.0pt;font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>X.509
attribute certificate</span></p>

<p class=MsoNormal>The <b>CKA_TRUSTED</b> attribute cannot be set to CK_TRUE by
an application. It MUST be set by a token initialization application or by the
token’s SO. Trusted certificates cannot be modified.</p>

<p class=MsoNormal><a name="_Toc319315685"></a><a name="_Toc319313692"></a><a
name="_Toc319313499"></a><a name="_Toc319287658"></a><a name="_Toc323024085"></a><a
name="_Toc323000691"></a><a name="_Toc322945124"></a><a name="_Toc322855282"></a><a
name="_Toc405794673"></a><a name="_Toc385057854"></a><a name="_Toc383864853"></a><a
name="_Toc323610846"></a><a name="_Toc323205416">The <b>CKA_CERTIFICATE_CATEGORY</b>
attribute is used to indicate if a stored certificate is a user certificate for
which the corresponding private key is available on the token (“token user”), a
CA certificate (“authority”), or another end-entity certificate (“other
entity”). This attribute may not be modified after an object is created. </a></p>

<p class=MsoNormal>The <b>CKA_CERTIFICATE_CATEGORY</b> and <b>CKA_TRUSTED</b>
attributes will together be used to map to the categorization of the
certificates. </p>

<p class=MsoNormal><b>CKA_CHECK_VALUE</b>: The value of this attribute is
derived from the certificate by taking the first three bytes of the SHA-1 hash
of the certificate object’s CKA_VALUE attribute.</p>

<p class=MsoNormal>The <b>CKA_START_DATE</b> and <b>CKA_END_DATE</b> attributes
are for reference only; Cryptoki does not attach any special meaning to them.
When present, the application is responsible to set them to values that match
the certificate’s encoded “not before” and “not after” fields (if any).</p>

<h3><a name="_Toc416959712"></a><a name="_Toc395183785"></a><a
name="_Toc391468789"></a><a name="_Toc370633998"></a><a name="_Toc235002294"></a><a
name="_Toc72656076">4.6.3 X.509 public key certificate objects</a></h3>

<p class=MsoNormal>X.509 certificate objects (certificate type <b>CKC_X_509</b>)
hold X.509 public key certificates.  The following table defines the X.509
certificate object attributes, in addition to the common attributes defined for
this object class:</p>

<p class=MsoCaption><a name="_Toc225305956">Table </a>19, X.509 Certificate
Object Attributes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=216 valign=top style='width:2.25in;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Attribute</span></b></p>
   </td>
   <td width=84 valign=top style='width:63.0pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Data type</span></b></p>
   </td>
   <td width=242 valign=top style='width:181.65pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_SUBJECT<sup>1</sup></span></p>
  </td>
  <td width=84 valign=top style='width:63.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Byte array</span></p>
  </td>
  <td width=242 valign=top style='width:181.65pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>DER-encoding of the certificate subject
  name</span></p>
  </td>
 </tr>
 <tr>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span lang=SV style='font-size:
  10.0pt;font-family:"Arial","sans-serif"'>CKA_ID</span></p>
  </td>
  <td width=84 valign=top style='width:63.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span lang=SV style='font-size:
  10.0pt;font-family:"Arial","sans-serif"'>Byte array</span></p>
  </td>
  <td width=242 valign=top style='width:181.65pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Key identifier for public/private key pair
  (default empty)</span></p>
  </td>
 </tr>
 <tr>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_ISSUER</span></p>
  </td>
  <td width=84 valign=top style='width:63.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Byte array</span></p>
  </td>
  <td width=242 valign=top style='width:181.65pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>DER-encoding of the certificate issuer name
  (default empty)</span></p>
  </td>
 </tr>
 <tr>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_SERIAL_NUMBER</span></p>
  </td>
  <td width=84 valign=top style='width:63.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Byte array</span></p>
  </td>
  <td width=242 valign=top style='width:181.65pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>DER-encoding of the certificate serial
  number (default empty)</span></p>
  </td>
 </tr>
 <tr>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_VALUE<sup>2</sup></span></p>
  </td>
  <td width=84 valign=top style='width:63.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Byte array</span></p>
  </td>
  <td width=242 valign=top style='width:181.65pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>BER-encoding of the certificate</span></p>
  </td>
 </tr>
 <tr>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoFootnoteText style='page-break-after:avoid'>CKA_URL<sup>3</sup></p>
  </td>
  <td width=84 valign=top style='width:63.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoFootnoteText style='page-break-after:avoid'>RFC2279 string</p>
  </td>
  <td width=242 valign=top style='width:181.65pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoFootnoteText style='page-break-after:avoid'>If not empty this
  attribute gives the URL where the complete certificate can be obtained 
  (default empty)</p>
  </td>
 </tr>
 <tr>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoFootnoteText style='page-break-after:avoid'>CKA_HASH_OF_SUBJECT_PUBLIC_KEY<sup>4</sup></p>
  </td>
  <td width=84 valign=top style='width:63.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoFootnoteText style='page-break-after:avoid'>Byte array</p>
  </td>
  <td width=242 valign=top style='width:181.65pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoFootnoteText style='page-break-after:avoid'>Hash of the subject
  public key (default empty). Hash algorithm is defined by
  CKA_NAME_HASH_ALGORITHM</p>
  </td>
 </tr>
 <tr>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoFootnoteText style='page-break-after:avoid'>CKA_HASH_OF_ISSUER_PUBLIC_KEY<sup>4</sup></p>
  </td>
  <td width=84 valign=top style='width:63.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoFootnoteText style='page-break-after:avoid'>Byte array</p>
  </td>
  <td width=242 valign=top style='width:181.65pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoFootnoteText style='page-break-after:avoid'>Hash of the issuer
  public key (default empty). Hash algorithm is defined by
  CKA_NAME_HASH_ALGORITHM</p>
  </td>
 </tr>
 <tr>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoFootnoteText style='page-break-after:avoid'>CKA_JAVA_MIDP_SECURITY_DOMAIN</p>
  </td>
  <td width=84 valign=top style='width:63.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoFootnoteText style='page-break-after:avoid'>CK_JAVA_MIDP_SECURITY_DOMAIN</p>
  </td>
  <td width=242 valign=top style='width:181.65pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoFootnoteText style='page-break-after:avoid'>Java MIDP security
  domain.  (default CK_SECURITY_DOMAIN_UNSPECIFIED)</p>
  </td>
 </tr>
 <tr>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoFootnoteText style='page-break-after:avoid'>CKA_NAME_HASH_ALGORITHM</p>
  </td>
  <td width=84 valign=top style='width:63.0pt;border-top:none;border-left:none;
  border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoFootnoteText style='page-break-after:avoid'>CK_MECHANISM_TYPE</p>
  </td>
  <td width=242 valign=top style='width:181.65pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoFootnoteText style='page-break-after:avoid'>Defines the mechanism
  used to calculate CKA_HASH_OF_SUBJECT_PUBLIC_KEY and
  CKA_HASH_OF_ISSUER_PUBLIC_KEY. If the attribute is not present then the type
  defaults to SHA-1.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><sup>1</sup>MUST be specified when the object is created.<sup><br>
2</sup>MUST be specified when the object is created.  MUST be non-empty if
CKA_URL is empty.</p>

<p class=MsoNormal><sup>3</sup>MUST be non-empty if CKA_VALUE is empty. </p>

<p class=MsoNormal><sup>4</sup>Can only be empty if CKA_URL is empty.</p>

<p class=MsoNormal>Only the <b>CKA_ID</b>, <b>CKA_ISSUER</b>, and <b>CKA_SERIAL_NUMBER</b>
attributes may be modified after the object is created.</p>

<p class=MsoNormal>The <b>CKA_ID</b> attribute is intended as a means of
distinguishing multiple public-key/private-key pairs held by the same subject
(whether stored in the same token or not). (Since the keys are distinguished by
subject name as well as identifier, it is possible that keys for different
subjects may have the same <b>CKA_ID</b> value without introducing any
ambiguity.)</p>

<p class=MsoNormal>It is intended in the interests of interoperability that the
subject name and key identifier for a certificate will be the same as those for
the corresponding public and private keys (though it is not required that all
be stored in the same token). However, Cryptoki does not enforce this
association, or even the uniqueness of the key identifier for a given subject;
in particular, an application may leave the key identifier empty.</p>

<p class=MsoNormal>The <b>CKA_ISSUER</b> and <b>CKA_SERIAL_NUMBER</b>
attributes are for compatibility with PKCS #7 and Privacy Enhanced Mail
(RFC1421). Note that with the version 3 extensions to X.509 certificates, the
key identifier may be carried in the certificate. It is intended that the <b>CKA_ID</b>
value be identical to the key identifier in such a certificate extension,
although this will not be enforced by Cryptoki.</p>

<p class=MsoNormal>The <b>CKA_URL</b> attribute enables the support for storage
of the URL where the certificate can be found instead of the certificate
itself. Storage of a URL instead of the complete certificate is often used in
mobile environments. </p>

<p class=MsoNormal>The <b>CKA_HASH_OF_SUBJECT_PUBLIC_KEY</b> and <b>CKA_HASH_OF_ISSUER_PUBLIC_KEY</b>
attributes are used to store the hashes of the public keys of the subject and
the issuer. They are particularly important when only the URL is available to
be able to correlate a certificate with a private key and when searching for
the certificate of the issuer. The hash algorithm is defined by
CKA_NAME_HASH_ALGORITHM.</p>

<p class=MsoNormal>The <b>CKA_JAVA_MIDP_SECURITY_DOMAIN</b> attribute
associates a certificate with a Java MIDP security domain.</p>

<p class=MsoNormal>The following is a sample template for creating an X.509
certificate object:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_OBJECT_CLASS
class = CKO_CERTIFICATE;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_CERTIFICATE_TYPE
certType = CKC_X_509;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_UTF8CHAR
label[] = “A certificate object”;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_BYTE
subject[] = {...};</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_BYTE
id[] = {123};</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_BYTE
certificate[] = {...};</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_BBOOL
true = CK_TRUE;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_ATTRIBUTE
template[] = {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_CLASS, &amp;class, sizeof(class)},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_CERTIFICATE_TYPE, &amp;certType, sizeof(certType)};</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_TOKEN, &amp;true, sizeof(true)},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_LABEL, label, sizeof(label)-1},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_SUBJECT, subject, sizeof(subject)},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_ID, id, sizeof(id)},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_VALUE, certificate, sizeof(certificate)}</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>};</p>

</div>

<h3><a name="_Toc416959713"></a><a name="_Toc395183786"></a><a
name="_Toc391468790"></a><a name="_Toc370633999"></a><a name="_Toc235002295"></a><a
name="_Toc72656077">4.6.4 WTLS public key certificate objects</a></h3>

<p class=MsoNormal>WTLS certificate objects (certificate type <b>CKC_WTLS</b>)
hold WTLS public key certificates. The following table defines the WTLS
certificate object attributes, in addition to the common attributes defined for
this object class.</p>

<p class=MsoCaption><a name="_Toc225305957">Table </a>20: WTLS Certificate
Object Attributes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=548
 style='width:411.1pt;margin-left:6.85pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=208 valign=top style='width:155.95pt;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Attribute</span></b></p>
   </td>
   <td width=104 valign=top style='width:77.95pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Data type</span></b></p>
   </td>
   <td width=236 valign=top style='width:177.2pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=208 valign=top style='width:155.95pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_SUBJECT<sup>1</sup></span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Byte array</span></p>
  </td>
  <td width=236 valign=top style='width:177.2pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>WTLS-encoding (Identifier type) of the
  certificate subject </span></p>
  </td>
 </tr>
 <tr>
  <td width=208 valign=top style='width:155.95pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_ISSUER</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Byte array</span></p>
  </td>
  <td width=236 valign=top style='width:177.2pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>WTLS-encoding (Identifier type) of the
  certificate issuer (default empty)</span></p>
  </td>
 </tr>
 <tr>
  <td width=208 valign=top style='width:155.95pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_VALUE<sup>2</sup></span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Byte array</span></p>
  </td>
  <td width=236 valign=top style='width:177.2pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>WTLS-encoding of the certificate</span></p>
  </td>
 </tr>
 <tr>
  <td width=208 valign=top style='width:155.95pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_URL<sup>3</sup></span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>RFC2279 string</span></p>
  </td>
  <td width=236 valign=top style='width:177.2pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>If not empty this attribute gives the URL
  where the complete certificate can be obtained</span></p>
  </td>
 </tr>
 <tr>
  <td width=208 valign=top style='width:155.95pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_HASH_OF_SUBJECT_PUBLIC_KEY<sup>4</sup></span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Byte array</span></p>
  </td>
  <td width=236 valign=top style='width:177.2pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>SHA-1 hash of the subject public key
  (default empty). Hash algorithm is defined by CKA_NAME_HASH_ALGORITHM</span></p>
  </td>
 </tr>
 <tr>
  <td width=208 valign=top style='width:155.95pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_HASH_OF_ISSUER_PUBLIC_KEY<sup>4</sup></span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Byte array</span></p>
  </td>
  <td width=236 valign=top style='width:177.2pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>SHA-1 hash of the issuer public key
  (default empty). Hash algorithm is defined by CKA_NAME_HASH_ALGORITHM</span></p>
  </td>
 </tr>
 <tr>
  <td width=208 valign=top style='width:155.95pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_NAME_HASH_ALGORITHM</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_MECHANISM_TYPE</span></p>
  </td>
  <td width=236 valign=top style='width:177.2pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Defines the mechanism used to calculate
  CKA_HASH_OF_SUBJECT_PUBLIC_KEY and CKA_HASH_OF_ISSUER_PUBLIC_KEY. If the
  attribute is not present then the type defaults to SHA-1.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><sup>1</sup>MUST be specified when the object is created.
Can only be empty if CKA_VALUE is empty.</p>

<p class=MsoNormal><sup>2</sup>MUST be specified when the object is created. MUST
be non-empty if CKA_URL is empty.</p>

<p class=MsoNormal><sup>3</sup>MUST be non-empty if CKA_VALUE is empty. </p>

<p class=MsoNormal><sup>4</sup>Can only be empty if CKA_URL is empty. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Only the <b>CKA_ISSUER</b> attribute may be modified after
the object has been created.</p>

<p class=MsoNormal>The encoding for the <b>CKA_SUBJECT</b>, <b>CKA_ISSUER</b>,
and <b>CKA_VALUE</b> attributes can be found in [WTLS] (see <a
href="#_References">References</a>).</p>

<p class=MsoNormal>The <b>CKA_URL</b> attribute enables the support for storage
of the URL where the certificate can be found instead of the certificate
itself. Storage of a URL instead of the complete certificate is often used in
mobile environments.</p>

<p class=MsoNormal>The <b>CKA_HASH_OF_SUBJECT_PUBLIC_KEY</b> and <b>CKA_HASH_OF_ISSUER_PUBLIC_KEY</b>
attributes are used to store the hashes of the public keys of the subject and
the issuer. They are particularly important when only the URL is available to
be able to correlate a certificate with a private key and when searching for
the certificate of the issuer. The hash algorithm is defined by
CKA_NAME_HASH_ALGORITHM.</p>

<p class=MsoNormal>The following is a sample template for creating a WTLS
certificate object:</p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_OBJECT_CLASS
class = CKO_CERTIFICATE;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_CERTIFICATE_TYPE
certType = CKC_WTLS;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_UTF8CHAR
label[] = “A certificate object”;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_BYTE
subject[] = {...};</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_BYTE
certificate[] = {...};</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_BBOOL
true = CK_TRUE;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_ATTRIBUTE
template[] =</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>{</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_CLASS, &amp;class, sizeof(class)},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_CERTIFICATE_TYPE, &amp;certType, sizeof(certType)};</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_TOKEN, &amp;true, sizeof(true)},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_LABEL, label, sizeof(label)-1},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_SUBJECT, subject, sizeof(subject)},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_VALUE, certificate, sizeof(certificate)}</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>};</p>

</div>

<h3><a name="_Toc416959714"></a><a name="_Toc395183787"></a><a
name="_Toc391468791"></a><a name="_Toc370634000"></a><a name="_Toc235002296"></a><a
name="_Toc72656078">4.6.5 X.509 attribute certificate objects</a></h3>

<p class=MsoNormal>X.509 attribute certificate objects (certificate type <b>CKC_X_509_ATTR_CERT</b>)
hold X.509 attribute certificates. The following table defines the X.509
attribute certificate object attributes, in addition to the common attributes
defined for this object class: </p>

<p class=MsoCaption><a name="_Toc225305958">Table </a>21, X.509 Attribute
Certificate Object Attributes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:.75pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=180 valign=top style='width:135.0pt;border-top:1.5pt;border-left:
  1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:windowtext;
  border-style:solid;padding:0in 0in 0in 0in'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Attribute</span></b></p>
  </td>
  <td width=84 valign=top style='width:63.0pt;border-top:solid windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 0in 0in 0in'>
  <p class=Table align=center style='text-align:center;page-break-after:avoid'><b><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Data Type</span></b></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:solid windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 0in 0in 0in'>
  <p class=Table style='margin-left:4.5pt;page-break-after:avoid'><b><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:135.0pt;border-top:none;border-left:
  solid windowtext 1.5pt;border-bottom:solid windowtext 1.0pt;border-right:
  solid windowtext 1.0pt;padding:0in 0in 0in 0in'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_OWNER<sup>1</sup></span></p>
  </td>
  <td width=84 valign=top style='width:63.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 0in 0in 0in'>
  <p class=Table align=center style='text-align:center;page-break-after:avoid'><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Byte Array</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 0in 0in 0in'>
  <p class=Table style='margin-left:4.5pt;page-break-after:avoid'><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>DER-encoding of the
  attribute certificate's subject field. This is distinct from the CKA_SUBJECT
  attribute contained in CKC_X_509 certificates because the ASN.1 syntax and
  encoding are different.</span></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:135.0pt;border-top:none;border-left:
  solid windowtext 1.5pt;border-bottom:solid windowtext 1.0pt;border-right:
  solid windowtext 1.0pt;padding:0in 0in 0in 0in'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_AC_ISSUER</span></p>
  </td>
  <td width=84 valign=top style='width:63.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 0in 0in 0in'>
  <p class=Table align=center style='text-align:center;page-break-after:avoid'><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Byte Array</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 0in 0in 0in'>
  <p class=Table style='margin-left:4.5pt;page-break-after:avoid'><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>DER-encoding of the
  attribute certificate's issuer field. This is distinct from the CKA_ISSUER
  attribute contained in CKC_X_509 certificates because the ASN.1 syntax and
  encoding are different. (default empty)</span></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:135.0pt;border-top:none;border-left:
  solid windowtext 1.5pt;border-bottom:solid windowtext 1.0pt;border-right:
  solid windowtext 1.0pt;padding:0in 0in 0in 0in'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_SERIAL_NUMBER</span></p>
  </td>
  <td width=84 valign=top style='width:63.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 0in 0in 0in'>
  <p class=Table align=center style='text-align:center;page-break-after:avoid'><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Byte Array</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 0in 0in 0in'>
  <p class=Table style='margin-left:4.5pt;page-break-after:avoid'><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>DER-encoding of the
  certificate serial number. (default empty)</span></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:135.0pt;border-top:none;border-left:
  solid windowtext 1.5pt;border-bottom:solid windowtext 1.0pt;border-right:
  solid windowtext 1.0pt;padding:0in 0in 0in 0in'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_ATTR_TYPES</span></p>
  </td>
  <td width=84 valign=top style='width:63.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 0in 0in 0in'>
  <p class=Table align=center style='text-align:center;page-break-after:avoid'><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Byte Array</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 0in 0in 0in'>
  <p class=Table style='margin-left:4.5pt;page-break-after:avoid'><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>BER-encoding of a
  sequence of object identifier values corresponding to the attribute types
  contained in the certificate. <span style='layout-grid-mode:line'>When
  present, this field offers an opportunity for applications to search for a particular
  attribute certificate without fetching and parsing the certificate itself.</span>
  (default empty)</span></p>
  </td>
 </tr>
 <tr>
  <td width=180 valign=top style='width:135.0pt;border-top:none;border-left:
  solid windowtext 1.5pt;border-bottom:solid windowtext 1.5pt;border-right:
  solid windowtext 1.0pt;padding:0in 0in 0in 0in'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_VALUE<sup>1</sup></span></p>
  </td>
  <td width=84 valign=top style='width:63.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.5pt;border-right:solid windowtext 1.0pt;
  padding:0in 0in 0in 0in'>
  <p class=Table align=center style='text-align:center;page-break-after:avoid'><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Byte Array</span></p>
  </td>
  <td width=312 valign=top style='width:3.25in;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.5pt;border-right:solid windowtext 1.5pt;
  padding:0in 0in 0in 0in'>
  <p class=Table style='margin-left:4.5pt;page-break-after:avoid'><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>BER-encoding of the
  certificate.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><sup>1</sup>MUST be specified when the object is created </p>

<p class=MsoNormal>Only the <b>CKA_AC_ISSUER</b>, <b>CKA_SERIAL_NUMBER</b> and <b>CKA_ATTR_TYPES
</b>attributes may be modified after the object is created. </p>

<p class=MsoNormal>The following is a sample template for creating an X.509
attribute certificate object: </p>

<div style='border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in'>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_OBJECT_CLASS
class = CKO_CERTIFICATE;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_CERTIFICATE_TYPE
certType = CKC_X_509_ATTR_CERT;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_UTF8CHAR
label[] = &quot;An attribute certificate object&quot;;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_BYTE
owner[] = {...};</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_BYTE
certificate[] = {...};</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_BBOOL
true = CK_TRUE;</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>CK_ATTRIBUTE
template[] = {</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_CLASS, &amp;class, sizeof(class)},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_CERTIFICATE_TYPE, &amp;certType, sizeof(certType)};</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>  {CKA_TOKEN,
&amp;true, sizeof(true)},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_LABEL, label, sizeof(label)-1},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_OWNER, owner, sizeof(owner)},</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'> 
{CKA_VALUE, certificate, sizeof(certificate)}</p>

<p class=Code style='margin:0in;margin-bottom:.0001pt;background:#D9D9D9'>};</p>

</div>

<h2><a name="_Toc416959715"></a><a name="_Toc395183788"></a><a
name="_Toc391468792"></a><a name="_Toc370634001"></a><a name="_Toc235002297"></a><a
name="_Toc72656079">4.7 Key </a>objects</h2>

<h3><a name="_Toc416959716"></a><a name="_Toc395183789"></a><a
name="_Toc391468793"></a><a name="_Toc370634002"></a><a name="_Toc235002298"></a><a
name="_Toc72656080">4.7.1 Definitions</a></h3>

<p class=MsoNormal>There is no CKO_ definition for the base key object class,
only for the key types derived from it.</p>

<p class=MsoNormal>This section defines the object class CKO_PUBLIC_KEY,
CKO_PRIVATE_KEY and  CKO_SECRET_KEY for type CK_OBJECT_CLASS as used in the
CKA_CLASS attribute of  objects.</p>

<h3><a name="_Toc416959717"></a><a name="_Toc395183790"></a><a
name="_Toc391468794"></a><a name="_Toc370634003"></a><a name="_Toc235002299"></a><a
name="_Toc72656081">4.7.2 Overview</a></h3>

<p class=MsoNormal>Key objects hold encryption or authentication keys, which can
be public keys, private keys, or secret keys.  The following common footnotes
apply to all the tables describing attributes of keys:</p>

<p class=MsoNormal>The following table defines the attributes common to public
key, private key and secret key classes, in addition to the common attributes
defined for this object class:</p>

<p class=MsoCaption><a name="_Toc225305959"></a><a name="_Toc405794981"></a><a
name="_Toc383864517"></a><a name="_Toc323204882"></a><a name="_Ref323111513"></a><a
name="_Ref384003113">Table </a>22, <a name="_Ref323111519">Common Key
Attributes</a></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=192 valign=top style='width:2.0in;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Attribute</span></b></p>
   </td>
   <td width=126 valign=top style='width:94.5pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Data Type</span></b></p>
   </td>
   <td width=258 valign=top style='width:193.5pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:solid black 1.5pt;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_KEY_TYPE<sup>1,5</sup></span></p>
  </td>
  <td width=126 valign=top style='width:94.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_KEY_TYPE</span></p>
  </td>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Type
  of key</span></p>
  </td>
 </tr>
 <tr>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:solid black 1.5pt;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span lang=SV style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_ID<sup>8</sup></span></p>
  </td>
  <td width=126 valign=top style='width:94.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span lang=SV style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Byte
  array</span></p>
  </td>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Key
  identifier for key (default empty)</span></p>
  </td>
 </tr>
 <tr>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:solid black 1.5pt;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_START_DATE<sup>8</sup></span></p>
  </td>
  <td width=126 valign=top style='width:94.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_DATE</span></p>
  </td>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Start
  date for the key (default empty)</span></p>
  </td>
 </tr>
 <tr>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:solid black 1.5pt;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_END_DATE<sup>8</sup></span></p>
  </td>
  <td width=126 valign=top style='width:94.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_DATE</span></p>
  </td>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>End
  date for the key (default empty)</span></p>
  </td>
 </tr>
 <tr>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:solid black 1.5pt;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_DERIVE<sup>8</sup></span></p>
  </td>
  <td width=126 valign=top style='width:94.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_TRUE
  if key supports key derivation (<i>i.e.</i>, if other keys can be derived
  from this one (default CK_FALSE)</span></p>
  </td>
 </tr>
 <tr>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:solid black 1.5pt;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_LOCAL<sup>2,4,6</sup></span></p>
  </td>
  <td width=126 valign=top style='width:94.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_TRUE
  only if key was either</span></p>
  <p class=Table style='margin-left:.25in;text-indent:-.25in'><span
  style='font-size:10.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>generated
  locally (<i>i.e.</i>, on the token) with a <b>C_GenerateKey</b> or <b>C_GenerateKeyPair</b>
  call</span></p>
  <p class=Table style='margin-left:.25in;text-indent:-.25in'><span
  style='font-size:10.0pt;font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>created
  with a <b>C_CopyObject</b> call as a copy of a key which had its <b>CKA_LOCAL</b>
  attribute set to CK_TRUE</span></p>
  </td>
 </tr>
 <tr>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:solid black 1.5pt;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_KEY_GEN_<br>
  MECHANISM<sup>2,4,6</sup></span></p>
  </td>
  <td width=126 valign=top style='width:94.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_MECHANISM_TYPE</span></p>
  </td>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Identifier
  of the mechanism used to generate the key material.</span></p>
  </td>
 </tr>
 <tr>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:solid black 1.5pt;
  border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif";color:black'>CKA_ALLOWED_MECHANISMS</span></p>
  </td>
  <td width=126 valign=top style='width:94.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span lang=EN-GB
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_MECHANISM_TYPE
  _PTR, pointer to a CK_MECHANISM_TYPE array</span></p>
  </td>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>A list of mechanisms allowed to be used
  with this key. The number of mechanisms in the array is the <i>ulValueLen</i>
  component of the attribute divided by the size</span></p>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>of CK_MECHANISM_TYPE.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><sup>- </sup>Refer to Table 10 for footnotes</p>

<p class=MsoNormal>The <b>CKA_ID</b> field is intended to distinguish among
multiple keys. In the case of public and private keys, this field assists in
handling multiple keys held by the same subject; the key identifier for a
public key and its corresponding private key should be the same. The key
identifier should also be the same as for the corresponding certificate, if one
exists. Cryptoki does not enforce these associations, however. (See Section 4.6 for further commentary.)</p>

<p class=MsoNormal>In the case of secret keys, the meaning of the <b>CKA_ID</b>
attribute is up to the application.</p>

<p class=MsoNormal>Note that the <b>CKA_START_DATE</b> and <b>CKA_END_DATE</b>
attributes are for reference only; Cryptoki does not attach any special meaning
to them. In particular, it does not restrict usage of a key according to the
dates; doing this is up to the application.</p>

<p class=MsoNormal>The <b>CKA_DERIVE</b> attribute has the value CK_TRUE if and
only if it is possible to derive other keys from the key.</p>

<p class=MsoNormal>The <b>CKA_LOCAL</b> attribute has the value CK_TRUE if and
only if the value of the key was originally generated on the token by a <b>C_GenerateKey</b>
or <b>C_GenerateKeyPair</b> call.</p>

<p class=MsoNormal>The <b>CKA_KEY_GEN_MECHANISM</b> attribute identifies the
key generation mechanism used to generate the key material. It contains a valid
value only if the <b>CKA_LOCAL</b> attribute has the value CK_TRUE. If <b>CKA_LOCAL</b>
has the value CK_FALSE, the value of the attribute is CK_UNAVAILABLE_INFORMATION.</p>

<h2><a name="_Toc416959718"></a><a name="_Toc395183791"></a><a
name="_Toc391468795"></a><a name="_Toc370634004"></a><a name="_Toc235002300"></a><a
name="_Toc72656082"></a><a name="_Toc405794674"></a><a name="_Ref399153796"></a><a
name="_Toc385057855"></a><a name="_Toc383864854"></a><a name="_Toc323610847"></a><a
name="_Toc323205417">4.8 Public key </a>objects</h2>

<p class=MsoNormal>Public key objects (object class <b>CKO_PUBLIC_KEY</b>) hold
public keys.   The following table defines the attributes common to all public
keys, in addition to the common attributes defined for this object class:</p>

<p class=MsoCaption><a name="_Toc225305960"></a><a name="_Toc405794982"></a><a
name="_Toc383864518"></a><a name="_Toc323204883"></a><a name="_Ref384003159">Table
</a>23, Common Public Key Attributes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=576
 style='width:6.0in;margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=204 valign=top style='width:153.0pt;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Attribute</span></b></p>
   </td>
   <td width=102 valign=top style='width:76.5pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Data type</span></b></p>
   </td>
   <td width=270 valign=top style='width:202.5pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=204 valign=top style='width:153.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_SUBJECT<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Byte
  array</span></p>
  </td>
  <td width=270 valign=top style='width:202.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>DER-encoding
  of the key subject name (default empty)</span></p>
  </td>
 </tr>
 <tr>
  <td width=204 valign=top style='width:153.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_ENCRYPT<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=270 valign=top style='width:202.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_TRUE
  if key supports encryption<sup>9</sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=204 valign=top style='width:153.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_VERIFY<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=270 valign=top style='width:202.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_TRUE
  if key supports verification where the signature is an appendix to the data<sup>9</sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=204 valign=top style='width:153.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_VERIFY_RECOVER<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=270 valign=top style='width:202.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_TRUE
  if key supports verification where the data is recovered from the signature<sup>9</sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=204 valign=top style='width:153.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_WRAP<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=270 valign=top style='width:202.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_TRUE
  if key supports wrapping (<i>i.e.</i>, can be used to wrap other keys)<sup>9</sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=204 valign=top style='width:153.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><a name="_Toc323024086"></a><a name="_Toc323000692"></a><a
  name="_Toc322945125"></a><a name="_Toc322855283"><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_TRUSTED<sup>10</sup></span></a></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=270 valign=top style='width:202.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>The
  key can be trusted for the application that it was created.</span></p>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>The
  wrapping key can be used to wrap keys with  CKA_WRAP_WITH_TRUSTED set to
  CK_TRUE.</span></p>
  </td>
 </tr>
 <tr>
  <td width=204 valign=top style='width:153.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_WRAP_TEMPLATE</span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_ATTRIBUTE_PTR</span></p>
  </td>
  <td width=270 valign=top style='width:202.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>For wrapping keys. The attribute template
  to match against any keys wrapped using this wrapping key. Keys that do not
  match cannot be wrapped. The number of attributes in the array is the <i>ulValueLen</i>
  component of the attribute divided by the size of CK_ATTRIBUTE.</span></p>
  </td>
 </tr>
 <tr>
  <td width=204 valign=top style='width:153.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_PUBLIC_KEY_INFO</span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Byte array</span></p>
  </td>
  <td width=270 valign=top style='width:202.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>DER-encoding of the SubjectPublicKeyInfo
  for this public key.  (MAY be empty, DEFAULT derived from the underlying
  public key data)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><sup>- </sup>Refer to Table 10 for footnotes</p>

<p class=MsoNormal>It is intended in the interests of interoperability that the
subject name and key identifier for a public key will be the same as those for
the corresponding certificate and private key.  However, Cryptoki does not
enforce this, and it is not required that the certificate and private key also
be stored on the token.</p>

<p class=MsoNormal><span style='layout-grid-mode:line'>To </span>map<span
style='layout-grid-mode:line'> between ISO/IEC 9594-8 (X.509) <b>keyUsage </b>flags
for public keys and the PKCS #11 attributes for public keys, use the following
table.</span></p>

<p class=MsoCaption><a name="_Toc225305961">Table </a>24, Mapping of X.509 key
usage flags to Cryptoki attributes for public keys</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 align=left
 style='border-collapse:collapse;border:none;margin-left:6.75pt;margin-right:
 6.75pt'>
 <tr>
  <td width=288 valign=top style='width:3.0in;border-top:1.5pt;border-left:
  1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:windowtext;
  border-style:solid;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Key usage flags for public keys in X.509
  public key certificates</span></b></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:solid windowtext 1.5pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Corresponding cryptoki attributes for
  public keys.</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:solid windowtext 1.5pt;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>dataEncipherment</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_ENCRYPT</span></p>
  </td>
 </tr>
 <tr>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:solid windowtext 1.5pt;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>digitalSignature, keyCertSign, cRLSign</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_VERIFY</span></p>
  </td>
 </tr>
 <tr>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:solid windowtext 1.5pt;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>digitalSignature, keyCertSign, cRLSign</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_VERIFY_RECOVER</span></p>
  </td>
 </tr>
 <tr>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:solid windowtext 1.5pt;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>keyAgreement</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_DERIVE</span></p>
  </td>
 </tr>
 <tr>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:solid windowtext 1.5pt;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>keyEncipherment</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_WRAP</span></p>
  </td>
 </tr>
 <tr>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:solid windowtext 1.5pt;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>nonRepudiation</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_VERIFY</span></p>
  </td>
 </tr>
 <tr>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:solid windowtext 1.5pt;
  border-bottom:solid windowtext 1.5pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>nonRepudiation</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.5pt;border-right:solid windowtext 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_VERIFY_RECOVER</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span style='layout-grid-mode:line'>The value of the
CKA_PUBLIC_KEY_INFO attribute is the DER encoded value of SubjectPublicKeyInfo:</span></p>

<p class=MsoNormal><span style='layout-grid-mode:line'>            SubjectPublicKeyInfo    <b>::</b>=
SEQUENCE {</span></p>

<p class=MsoNormal><span style='layout-grid-mode:line'>                        algorithm                      AlgorithmIdentifier,</span></p>

<p class=MsoNormal><span style='layout-grid-mode:line'>                        subjectPublicKey          BIT_STRING
}</span></p>

<p class=MsoNormal><span style='layout-grid-mode:line'>The encodings for the
subjectPublicKey field are specified in the description of the public key types
in the appropriate </span>[PKCS11-Curr]<b> </b><span style='layout-grid-mode:
line'>document for the key types defined within this specification.</span></p>

<h2><a name="_Toc319315688"></a><a name="_Toc319313695"></a><a
name="_Toc319313502"></a><a name="_Toc319287661"></a><a name="_Toc416959719"></a><a
name="_Toc395183792"></a><a name="_Toc391468796"></a><a name="_Toc370634005"></a><a
name="_Toc235002301"></a><a name="_Toc72656083"></a><a name="_Ref72646937"></a><a
name="_Ref72646759"></a><a name="_Ref72643709"></a><a name="_Ref457140239"></a><a
name="_Ref457140112"></a><a name="_Ref457139268"></a><a name="_Toc405794680"></a><a
name="_Ref399153802"></a><a name="_Toc385057862"></a><a name="_Toc383864858"></a><a
name="_Toc323610851"></a><a name="_Toc323205421"></a><a name="_Toc323024089"></a><a
name="_Toc323000695"></a><a name="_Toc322945128"></a><a name="_Toc322855286">4.9
Private key </a>objects</h2>

<p class=MsoNormal>Private key objects (object class <b>CKO_PRIVATE_KEY</b>)
hold private keys. The following table defines the attributes common to all
private keys, in addition to the common attributes defined for this object
class:</p>

<p class=MsoCaption><a name="_Toc225305962"></a><a name="_Toc405794988"></a><a
name="_Toc383864522"></a><a name="_Toc323204887"></a><a name="_Ref320440894"></a><a
name="_Ref384003347">Table </a>25, Common Private Key Attributes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=258 valign=top style='width:193.5pt;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Attribute</span></b></p>
   </td>
   <td width=102 valign=top style='width:76.5pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Data type</span></b></p>
   </td>
   <td width=216 valign=top style='width:2.25in;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_SUBJECT<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Byte array</span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>DER-encoding of certificate subject name
  (default empty)</span></p>
  </td>
 </tr>
 <tr>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_SENSITIVE<sup>8,11</sup>
  </span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_TRUE
  if key is sensitive<sup>9 </sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_DECRYPT<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_TRUE
  if key supports decryption<sup>9</sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_SIGN<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_TRUE
  if key supports signatures where the signature is an appendix to the data<sup>9</sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_SIGN_RECOVER<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_TRUE
  if key supports signatures where the data can be recovered from the signature<sup>9</sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_UNWRAP<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_TRUE
  if key supports unwrapping (<i>i.e.</i>, can be used to unwrap other keys)<sup>9</sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_EXTRACTABLE<sup>8,12</sup>
  </span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_TRUE
  if key is extractable and can be wrapped<sup> 9</sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_ALWAYS_SENSITIVE<sup>2,4,6</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_TRUE
  if key has <i>always</i> had the CKA_SENSITIVE attribute set to CK_TRUE</span></p>
  </td>
 </tr>
 <tr>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_NEVER_EXTRACTABLE<sup>2,4,6</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_TRUE
  if key has <i>never</i> had the CKA_EXTRACTABLE attribute set to CK_TRUE</span></p>
  </td>
 </tr>
 <tr>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_WRAP_WITH_TRUSTED<sup>11</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_TRUE
  if the key can only be wrapped with a wrapping key that has CKA_TRUSTED set
  to CK_TRUE.</span></p>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Default
  is CK_FALSE.</span></p>
  </td>
 </tr>
 <tr>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_UNWRAP_TEMPLATE</span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_ATTRIBUTE_PTR</span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>For
  wrapping keys. The attribute template to apply to any keys unwrapped using
  this wrapping key. Any user supplied template is applied after this template
  as if the object has already been created. The number of attributes in the
  array is the <i>ulValueLen</i> component of the attribute divided by the size
  of</span></p>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_ATTRIBUTE.</span></p>
  </td>
 </tr>
 <tr>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_ALWAYS_AUTHENTICATE</span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>If
  CK_TRUE, the user has to supply the PIN for each use (sign or decrypt) with
  the key. Default is CK_FALSE.</span></p>
  </td>
 </tr>
 <tr>
  <td width=258 valign=top style='width:193.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>CKA_PUBLIC_KEY_INFO<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Byte
  Array</span></p>
  </td>
  <td width=216 valign=top style='width:2.25in;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>DER-encoding
  of the SubjectPublicKeyInfo for the associated public key (MAY be empty;
  DEFAULT derived from the underlying private key data; MAY be manually set for
  specific key types; if set; MUST be consistent with the underlying private
  key data)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><sup>- </sup>Refer to Table 10 for footnotes</p>

<p class=MsoNormal><a name="_Toc385057863"></a><a name="_Ref384871793"></a><a
name="_Ref384665978"></a><a name="_Toc383864859"></a><a name="_Toc323610852"></a><a
name="_Toc323205422"></a><a name="_Toc323024090"></a><a name="_Toc323000696"></a><a
name="_Toc322945129"></a><a name="_Toc322855287">It is intended in the
interests of interoperability that the subject name and key identifier for a
private key will be the same as those for the corresponding certificate and
public key.  However, this is not enforced by Cryptoki, and it is not required
that the certificate and public key also be stored on the token.</a></p>

<p class=MsoNormal>If the <b>CKA_SENSITIVE</b> attribute is CK_TRUE, or if the <b>CKA_EXTRACTABLE</b>
attribute is CK_FALSE, then certain attributes of the private key cannot be
revealed in plaintext outside the token.  Which attributes these are is
specified for each type of private key in the attribute table in the section
describing that type of key.</p>

<p class=MsoNormal>The <b>CKA_ALWAYS_AUTHENTICATE</b> attribute can be used to
force re-authentication (i.e. force the user to provide a PIN) for each use of
a private key. “Use” in this case means a cryptographic operation such as sign
or decrypt. This attribute may only be set to CK_TRUE when <b>CKA_PRIVATE</b>
is also CK_TRUE. </p>

<p class=MsoNormal>Re-authentication occurs by calling <b>C_Login</b> with <i>userType</i>
set to <b>CKU_CONTEXT_SPECIFIC</b> immediately after a cryptographic operation
using the key has been initiated (e.g. after <b>C_SignInit</b>). In this call,
the actual user type is implicitly given by the usage requirements of the
active key. If <b>C_Login</b> returns CKR_OK the user was successfully
authenticated and this sets the active key in an authenticated state that lasts
until the cryptographic operation has successfully or unsuccessfully been
completed (e.g. by <b>C_Sign</b>, <b>C_SignFinal</b>,..). A return value
CKR_PIN_INCORRECT from <b>C_Login</b> means that the user was denied permission
to use the key and continuing the cryptographic operation will result in a
behavior as if <b>C_Login</b> had not been called. In both of these cases the
session state will remain the same, however repeated failed re-authentication
attempts may cause the PIN to be locked. <b>C_Login</b> returns in this case
CKR_PIN_LOCKED and this also logs the user out from the token. Failing or
omitting to re-authenticate when CKA_ALWAYS_AUTHENTICATE is set to CK_TRUE will
result in CKR_USER_NOT_LOGGED_IN to be returned from calls using the key. <b>C_Login</b>
will return CKR_OPERATION_NOT_INITIALIZED, but the active cryptographic
operation will not be affected, if an attempt is made to re-authenticate when
CKA_ALWAYS_AUTHENTICATE is set to CK_FALSE.</p>

<p class=MsoNormal>The <b>CKA_PUBLIC_KEY_INFO</b> attribute represents the
public key associated with this private key.  The data it represents may either
be stored as part of the private key data, or regenerated as needed from the
private key.</p>

<p class=MsoNormal>If this attribute is supplied as part of a template for <b>C_CreateObject,
C_CopyObject </b>or C<b>_SetAttributeValue</b> for a private key, the token
MUST verify correspondence between the private key data and the public key data
as supplied in <b>CKA_PUBLIC_KEY_INFO</b>. This can be done either by deriving
a public key from the private key and comparing the values, or by doing a sign
and verify operation. If there is a mismatch, the command SHALL return <b>CKR_ATTRIBUTE_VALUE_INVALID.</b>
A token MAY choose not to support the <b>CKA_PUBLIC_KEY_INFO </b>attribute for
commands which create new private keys. If it does not support the attribute,
the command SHALL return <b>CKR_ATTRIBUTE_TYPE_INVALID</b>.</p>

<p class=MsoNormal>As a general guideline, private keys of any type SHOULD
store sufficient information to retrieve the public key information.  In
particular, the RSA private key description has been modified in &lt;this
version&gt; to add the CKA_PUBLIC_EXPONENT to the list of attributes required
for an RSA private key.  All other private key types described in this
specification contain sufficient information to recover the associated public
key.</p>

<h3><a name="_Toc416959720"></a><a name="_Toc395183793"></a><a
name="_Toc391468797"></a><a name="_Toc370634006"></a><a name="_Toc72656200"></a><a
name="_Toc235853652">4.9.1 RSA private key objects</a></h3>

<p class=MsoNormal>RSA private key objects (object class <b>CKO_PRIVATE_KEY, </b>key
type <b>CKK_RSA</b>) hold RSA private keys.  The following table defines the
RSA private key object attributes, in addition to the common attributes defined
for this object class:</p>

<p class=MsoCaption><a name="_Toc323204888"></a><a name="_Toc383864523"></a><a
name="_Toc405794989"></a><a name="_Toc235853988"></a><a name="_Toc319314015"></a><a
name="_Toc319314557"></a><a name="_Toc319314972"></a><a name="_Toc319315844"></a><a
name="_Ref384613038">Table </a>26, RSA Private Key Object Attributes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=246 valign=top style='width:184.5pt;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='line-height:115%;page-break-after:avoid'><b><span
   style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Attribute</span></b></p>
   </td>
   <td width=90 valign=top style='width:67.5pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='line-height:115%;page-break-after:avoid'><b><span
   style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Data
   type</span></b></p>
   </td>
   <td width=240 valign=top style='width:2.5in;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='line-height:115%;page-break-after:avoid'><b><span
   style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=246 valign=top style='width:184.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>CKA_MODULUS<sup><span
  style='background:yellow'>1,</span>4,6</sup></span></p>
  </td>
  <td width=90 valign=top style='width:67.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Big
  integer</span></p>
  </td>
  <td width=240 valign=top style='width:2.5in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Modulus
  <i>n</i></span></p>
  </td>
 </tr>
 <tr>
  <td width=246 valign=top style='width:184.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>CKA_PUBLIC_EXPONENT<sup>1,4,6</sup></span></p>
  </td>
  <td width=90 valign=top style='width:67.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Big
  integer</span></p>
  </td>
  <td width=240 valign=top style='width:2.5in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Public
  exponent <i>e</i></span></p>
  </td>
 </tr>
 <tr>
  <td width=246 valign=top style='width:184.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>CKA_PRIVATE_EXPONENT<sup>1,4,6,7</sup></span></p>
  </td>
  <td width=90 valign=top style='width:67.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Big
  integer</span></p>
  </td>
  <td width=240 valign=top style='width:2.5in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Private
  exponent <i>d</i></span></p>
  </td>
 </tr>
 <tr>
  <td width=246 valign=top style='width:184.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>CKA_PRIME_1<sup>4,6,7</sup></span></p>
  </td>
  <td width=90 valign=top style='width:67.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Big
  integer</span></p>
  </td>
  <td width=240 valign=top style='width:2.5in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Prime
  <i>p</i></span></p>
  </td>
 </tr>
 <tr>
  <td width=246 valign=top style='width:184.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>CKA_PRIME_2<sup>4,6,7</sup></span></p>
  </td>
  <td width=90 valign=top style='width:67.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Big
  integer</span></p>
  </td>
  <td width=240 valign=top style='width:2.5in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Prime
  <i>q</i></span></p>
  </td>
 </tr>
 <tr>
  <td width=246 valign=top style='width:184.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span lang=SV
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>CKA_EXPONENT_1<sup>4,6,7</sup></span></p>
  </td>
  <td width=90 valign=top style='width:67.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span lang=SV
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Big
  integer</span></p>
  </td>
  <td width=240 valign=top style='width:2.5in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Private
  exponent <i>d</i> modulo <i>p</i>-1 </span></p>
  </td>
 </tr>
 <tr>
  <td width=246 valign=top style='width:184.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span lang=SV
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>CKA_EXPONENT_2<sup>4,6,7</sup></span></p>
  </td>
  <td width=90 valign=top style='width:67.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span lang=SV
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Big
  integer</span></p>
  </td>
  <td width=240 valign=top style='width:2.5in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Private
  exponent <i>d</i> modulo <i>q</i>-1 </span></p>
  </td>
 </tr>
 <tr>
  <td width=246 valign=top style='width:184.5pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>CKA_COEFFICIENT<sup>4,6,7</sup></span></p>
  </td>
  <td width=90 valign=top style='width:67.5pt;border-top:none;border-left:none;
  border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>Big
  integer</span></p>
  </td>
  <td width=240 valign=top style='width:2.5in;border-top:none;border-left:none;
  border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='line-height:115%;page-break-after:avoid'><span lang=FR
  style='font-size:10.0pt;line-height:115%;font-family:"Arial","sans-serif"'>CRT
  coefficient <i>q</i><sup>-1</sup> mod <i>p</i>  </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><sup><span lang=FR-CH> </span></sup>Refer to Table 10 for
footnotes</p>

<p class=MsoNormal>Depending on the token, there may be limits on the length of
the key components.  See PKCS #1 for more information on RSA keys.</p>

<p class=MsoNormal>Tokens vary in what they actually store for RSA private
keys.  Some tokens store all of the above attributes, which can assist in
performing rapid RSA computations.  Other tokens might store only the <b>CKA_MODULUS</b>
and <b>CKA_PRIVATE_EXPONENT</b> values. Effective with version 2.40, tokens MUST
also store CKA_PUBLIC_EXPONENT.  This permits the retrieval of sufficient data
to reconstitute the associated public key.</p>

<p class=MsoNormal>Because of this, Cryptoki is flexible in dealing with RSA
private key objects.  When a token generates an RSA private key, it stores
whichever of the fields in Table 26 it keeps track of.  Later, if an
application asks for the values of the key’s various attributes, Cryptoki
supplies values only for attributes whose values it can obtain (<i>i.e.</i>, if
Cryptoki is asked for the value of an attribute it cannot obtain, the request
fails).  Note that a Cryptoki implementation may or may not be able and/or
willing to supply various attributes of RSA private keys which are not actually
stored on the token.  <i>E.g.</i>, if a particular token stores values only for
the <b>CKA_PRIVATE_EXPONENT, CKA_PUBLIC_EXPONENT</b>, <b>CKA_PRIME_1</b>, and <b>CKA_PRIME_2</b>
attributes, then Cryptoki is certainly <i>able</i> to report values for all the
attributes above (since they can all be computed efficiently from these four
values).  However, a Cryptoki implementation may or may not actually do this
extra computation.  The only attributes from Table 26 for which a Cryptoki
implementation is <i>required</i> to be able to return values are <b>CKA_MODULUS,
CKA_PRIVATE_EXPONENT, and CKA_PUBLIC_EXPONENT</b>.  A token SHOULD also be able
to return <b>CKA_PUBLIC_KEY_INFO </b>for an RSA private key.  See the general
guidance for Private Keys above.</p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc319315691"></a><a name="_Toc319313698"></a><a
name="_Toc319313505"></a><a name="_Toc319287664"></a><a name="_Toc416959721"></a><a
name="_Toc395183794"></a><a name="_Toc391468798"></a><a name="_Toc370634007"></a><a
name="_Toc235002302"></a><a name="_Toc72656084"></a><a name="_Toc405794686"></a><a
name="_Toc385057869"></a><a name="_Toc383864862"></a><a name="_Toc323610855"></a><a
name="_Toc323205425"></a><a name="_Toc323024093"></a><a name="_Toc323000699"></a><a
name="_Toc322945132"></a><a name="_Toc322855290">4.10 Secret key objects</a></h2>

<p class=MsoNormal>Secret key objects (object class <b>CKO_SECRET_KEY</b>) hold
secret keys.  The following table defines the attributes common to all secret
keys, in addition to the common attributes defined for this object class:</p>

<p class=MsoCaption><a name="_Toc225305963"></a><a name="_Toc405794994"></a><a
name="_Toc383864526"></a><a name="_Toc323204891"></a><a name="_Ref384003560">Table
</a>27, Common Secret Key Attributes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=588
 style='width:441.0pt;margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=252 valign=top style='width:189.0pt;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Attribute</span></b></p>
   </td>
   <td width=102 valign=top style='width:76.5pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Data type</span></b></p>
   </td>
   <td width=234 valign=top style='width:175.5pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.75pt 0in 5.75pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_SENSITIVE<sup>8,11</sup> </span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=234 valign=top style='width:175.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_TRUE if object is sensitive (default
  CK_FALSE)</span></p>
  </td>
 </tr>
 <tr>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_ENCRYPT<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=234 valign=top style='width:175.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_TRUE if key supports encryption<sup>9</sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_DECRYPT<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=234 valign=top style='width:175.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_TRUE if key supports decryption<sup>9</sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_SIGN<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=234 valign=top style='width:175.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_TRUE if key supports signatures (<i>i.e.</i>,
  authentication codes) where the signature is an appendix to the data<sup>9</sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_VERIFY<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=234 valign=top style='width:175.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_TRUE if key supports verification (<i>i.e.</i>,
  of authentication codes) where the signature is an appendix to the data<sup>9</sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_WRAP<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=234 valign=top style='width:175.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_TRUE if key supports wrapping (<i>i.e.</i>,
  can be used to wrap other keys)<sup>9</sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_UNWRAP<sup>8</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=234 valign=top style='width:175.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_TRUE if key supports unwrapping (<i>i.e.</i>,
  can be used to unwrap other keys)<sup>9</sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_EXTRACTABLE<sup>8,12</sup> </span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=234 valign=top style='width:175.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_TRUE if key is extractable and can be
  wrapped <sup>9</sup></span></p>
  </td>
 </tr>
 <tr>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_ALWAYS_SENSITIVE<sup>2,4,6</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=234 valign=top style='width:175.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_TRUE if key has <i>always</i> had the
  CKA_SENSITIVE attribute set to CK_TRUE</span></p>
  </td>
 </tr>
 <tr>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_NEVER_EXTRACTABLE<sup>2,4,6</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=234 valign=top style='width:175.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_TRUE if key has <i>never</i> had the
  CKA_EXTRACTABLE attribute set to CK_TRUE</span></p>
  </td>
 </tr>
 <tr>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_CHECK_VALUE</span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span lang=SV style='font-size:
  10.0pt;font-family:"Arial","sans-serif"'>Byte array</span></p>
  </td>
  <td width=234 valign=top style='width:175.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Key checksum</span></p>
  </td>
 </tr>
 <tr>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_WRAP_WITH_TRUSTED<sup>11</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=234 valign=top style='width:175.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_TRUE if the key can only be wrapped with
  a wrapping key that has CKA_TRUSTED set to CK_TRUE.</span></p>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Default is CK_FALSE.</span></p>
  </td>
 </tr>
 <tr>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_TRUSTED<sup>10</sup></span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=234 valign=top style='width:175.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>The wrapping key can be used to wrap keys
  with  CKA_WRAP_WITH_TRUSTED set to CK_TRUE.</span></p>
  </td>
 </tr>
 <tr>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_WRAP_TEMPLATE</span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_ATTRIBUTE_PTR</span></p>
  </td>
  <td width=234 valign=top style='width:175.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>For wrapping keys. The attribute template
  to match against any keys wrapped using this wrapping key. Keys that do not
  match cannot be wrapped. The number of attributes in the array is the</span></p>
  <p class=Table style='page-break-after:avoid'><i><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>ulValueLen</span></i><span
  style='font-size:10.0pt;font-family:"Arial","sans-serif"'> component of the
  attribute divided by the size of</span></p>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_ATTRIBUTE</span></p>
  </td>
 </tr>
 <tr>
  <td width=252 valign=top style='width:189.0pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_UNWRAP_TEMPLATE</span></p>
  </td>
  <td width=102 valign=top style='width:76.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_ATTRIBUTE_PTR</span></p>
  </td>
  <td width=234 valign=top style='width:175.5pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>For wrapping keys. The attribute template
  to apply to any keys unwrapped using this wrapping key. Any user supplied
  template is applied after this template as if the object has already been
  created. The number of attributes in the array is the <i>ulValueLen</i>
  component of the attribute divided by the size of</span></p>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_ATTRIBUTE.</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><sup>- </sup>Refer to Table 10 for footnotes</p>

<p class=MsoNormal>If the <b>CKA_SENSITIVE</b> attribute is CK_TRUE, or if the <b>CKA_EXTRACTABLE</b>
attribute is CK_FALSE, then certain attributes of the secret key cannot be
revealed in plaintext outside the token.  Which attributes these are is
specified for each type of secret key in the attribute table in the section
describing that type of key.</p>

<p class=MsoNormal><a name="_Toc383864869"></a><a name="_Toc323610862"></a><a
name="_Toc323205432"></a><a name="_Toc323024100"></a><a name="_Toc323000706"></a><a
name="_Toc322945139"></a><a name="_Toc322855297"></a><a name="_Ref320515101">The
key check value (KCV) attribute for symmetric key objects to be called <b>CKA_CHECK_VALUE,</b>
of type byte array, length 3 bytes, operates like a fingerprint, or checksum of
the key. They are intended to be used to cross-check symmetric keys against
other systems where the same key is shared, and as a validity check after
manual key entry or restore from backup. Refer to object definitions of
specific key types for KCV algorithms.</a></p>

<p class=MsoNormal>Properties:</p>

<ol style='margin-top:0in' start=1 type=1>
 <li class=MsoNormal style='margin-top:0in;margin-bottom:12.0pt;text-align:
     justify'>For two keys that are cryptographically identical the value of
     this attribute should be identical.</li>
 <li class=MsoNormal style='margin-top:0in;margin-bottom:12.0pt;text-align:
     justify'>CKA_CHECK_VALUE should not be usable to obtain any part of the
     key value.</li>
 <li class=MsoNormal style='margin-top:0in;margin-bottom:12.0pt;text-align:
     justify'>Non-uniqueness. Two different keys can have the same
     CKA_CHECK_VALUE. This is unlikely (the probability can easily be
     calculated) but possible.</li>
</ol>

<p class=MsoNormal>The attribute is optional, but if supported, regardless of
how the key object is created or derived, the value of the attribute is always
supplied. It SHALL be supplied even if the encryption operation for the key is
forbidden (i.e. when CKA_ENCRYPT is set to CK_FALSE).</p>

<p class=MsoNormal>If a value is supplied in the application template (allowed
but never necessary) then, if supported, it MUST match what the library
calculates it to be or the library returns a CKR_ATTRIBUTE_VALUE_INVALID. If
the library does not support the attribute then it should ignore it. Allowing
the attribute in the template this way does no harm and allows the attribute to
be treated like any other attribute for the purposes of key wrap and unwrap
where the attributes are preserved also.</p>

<p class=MsoNormal>The generation of the KCV may be prevented by the
application supplying the attribute in the template as a no-value (0 length)
entry. The application can query the value at any time like any other attribute
using C_GetAttributeValue. C_SetAttributeValue may be used to destroy the
attribute, by supplying no-value.</p>

<p class=MsoNormal>Unless otherwise specified for the object definition, the
value of this attribute is derived from the key object by taking the first
three bytes of an encryption of a single block of null (0x00) bytes, using the
default cipher and mode (e.g. ECB) associated with the key type of the secret
key object.</p>

<span style='font-size:10.0pt;font-family:"Arial","sans-serif"'><br clear=all
style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc416959722"></a><a name="_Toc395183795"></a><a
name="_Toc391468799"></a><a name="_Toc370634008"></a><a name="_Toc235002303"></a><a
name="_Toc72656085">4.11 Domain parameter objects</a></h2>

<h3><a name="_Toc416959723"></a><a name="_Toc395183796"></a><a
name="_Toc391468800"></a><a name="_Toc370634009"></a><a name="_Toc235002304"></a><a
name="_Toc72656086">4.11.1 Definitions</a></h3>

<p class=MsoNormal>This section defines the object class CKO_DOMAIN_PARAMETERS
for type CK_OBJECT_CLASS as used in the CKA_CLASS attribute of  objects.</p>

<h3><a name="_Toc416959724"></a><a name="_Toc395183797"></a><a
name="_Toc391468801"></a><a name="_Toc370634010"></a><a name="_Toc235002305"></a><a
name="_Toc72656087">4.11.2 Overview</a></h3>

<p class=MsoNormal>This object class was created to support the storage of
certain algorithm's extended parameters. DSA and DH both use domain parameters
in the key-pair generation step. In particular, some libraries support the
generation of domain parameters (originally out of scope for PKCS11) so the
object class was added.</p>

<p class=MsoNormal>To use a domain parameter object you MUST extract the
attributes into a template and supply them (still in the template) to the
corresponding key-pair generation function.</p>

<p class=MsoNormal>Domain parameter objects (object class <b>CKO_DOMAIN_PARAMETERS</b>)
hold public domain parameters. </p>

<p class=MsoNormal>The following table defines the attributes common to domain
parameter objects in addition to the common attributes defined for this object
class:</p>

<p class=MsoCaption><a name="_Toc225305964"></a><a name="_Ref505614849">Table</a>
28, Common Domain Parameter Attributes</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=168 valign=top style='width:1.75in;border-top:1.5pt;border-left:
   1.5pt;border-bottom:1.0pt;border-right:1.0pt;border-color:black;border-style:
   solid;padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Attribute</span></b></p>
   </td>
   <td width=132 valign=top style='width:99.0pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Data Type</span></b></p>
   </td>
   <td width=276 valign=top style='width:207.0pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table style='page-break-after:avoid'><b><span style='font-size:
   10.0pt;font-family:"Arial","sans-serif"'>Meaning</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=168 valign=top style='width:1.75in;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_KEY_TYPE<sup>1</sup></span></p>
  </td>
  <td width=132 valign=top style='width:99.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_KEY_TYPE</span></p>
  </td>
  <td width=276 valign=top style='width:207.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Type of key the domain parameters can be
  used to generate.</span></p>
  </td>
 </tr>
 <tr>
  <td width=168 valign=top style='width:1.75in;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_LOCAL<sup>2,4</sup></span></p>
  </td>
  <td width=132 valign=top style='width:99.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_BBOOL</span></p>
  </td>
  <td width=276 valign=top style='width:207.0pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_TRUE only if domain parameters were
  either</span></p>
  <p class=Table style='margin-left:.25in;text-indent:-.25in;page-break-after:
  avoid'><span style='font-size:10.0pt;font-family:Symbol'>·<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>generated
  locally (<i>i.e.</i>, on the token) with a <b>C_GenerateKey</b></span></p>
  <p class=Table style='margin-left:.25in;text-indent:-.25in;page-break-after:
  avoid'><span style='font-size:10.0pt;font-family:Symbol'>·<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>created
  with a <b>C_CopyObject</b> call as a copy of domain parameters which had its <b>CKA_LOCAL</b>
  attribute set to CK_TRUE</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><sup>- </sup>Refer to Table 10 for footnotes</p>

<p class=MsoNormal>The <b>CKA_LOCAL</b> attribute has the value CK_TRUE if and
only if the values of the domain parameters were originally generated on the
token by a <b>C_GenerateKey</b> call.</p>

<h2><a name="_Toc405794702"></a><a name="_Toc385057885"></a><a
name="_Ref384459053"></a><a name="_Toc416959725"></a><a name="_Toc395183798"></a><a
name="_Toc391468802"></a><a name="_Toc370634011"></a><a name="_Toc235002306"></a><a
name="_Toc72656088">4.12 Mechanism objects</a></h2>

<h3><a name="_Toc416959726"></a><a name="_Toc395183799"></a><a
name="_Toc391468803"></a><a name="_Toc370634012"></a><a name="_Toc235002307"></a><a
name="_Toc72656089">4.12.1 Definitions</a></h3>

<p class=MsoNormal>This section defines the object class CKO_MECHANISM for type
CK_OBJECT_CLASS as used in the CKA_CLASS attribute of  objects.</p>

<h3><a name="_Toc416959727"></a><a name="_Toc395183800"></a><a
name="_Toc391468804"></a><a name="_Toc370634013"></a><a name="_Toc235002308"></a><a
name="_Toc72656090">4.12.2 Overview</a></h3>

<p class=MsoNormal>Mechanism objects provide information about mechanisms
supported by a device beyond that given by the <b>CK_MECHANISM_INFO</b>
structure.</p>

<p class=MsoNormal>When searching for objects using <b>C_FindObjectsInit</b>
and <b>C_FindObjects</b>, mechanism objects are not returned unless the <b>CKA_CLASS</b>
attribute in the template has the value <b>CKO_MECHANISM</b>. This protects
applications written to previous versions of Cryptoki from finding objects that
they do not understand.</p>

<p class=MsoCaption><a name="_Toc225305965">Table 29, Common Mechanism
Attributes</a></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <tr>
  <td width=208 valign=top style='width:155.95pt;border:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Attribute</span></b></p>
  </td>
  <td width=198 valign=top style='width:148.85pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Data Type</span></b></p>
  </td>
  <td width=177 valign=top style='width:132.6pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><b><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Meaning</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=208 valign=top style='width:155.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CKA_MECHANISM_TYPE</span></p>
  </td>
  <td width=198 valign=top style='width:148.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>CK_MECHANISM_TYPE</span></p>
  </td>
  <td width=177 valign=top style='width:132.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>The type of mechanism object</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>The <b>CKA_MECHANISM_TYPE</b> attribute may not be set.</p>

<div style='border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in'>

<h1><a name="_Toc416959728"></a><a name="_Toc395183801"></a><a
name="_Toc391468805"></a><a name="_Toc370634014"></a><a name="_Toc235002309"></a><a
name="_Toc72656091">5<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Functions</a></h1>

</div>

<p class=MsoNormal>Cryptoki's functions are organized into the following
categories:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>general-purpose functions (4 functions)</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>slot and token management functions (9 functions)</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>session management functions (8 functions)</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>object management functions (9 functions)</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>encryption functions (4 functions)</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>decryption functions (4 functions)</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>message digesting functions (5 functions)</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>signing and MACing functions (6 functions)</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>functions for verifying signatures and MACs (6 functions)</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>dual-purpose cryptographic functions (4 functions)</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>key management functions (5 functions)</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>random number generation functions (2 functions)</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>parallel function management functions (2 functions)</p>

<p class=MsoNormal style='margin-left:.25in'>&nbsp;</p>

<p class=MsoNormal>In addition to these functions, Cryptoki can use
application-supplied callback functions to notify an application of certain
events, and can also use application-supplied functions to handle mutex objects
for safe multi-threaded library access.</p>

<p class=MsoNormal>The Cryptoki API functions are presented in the following
table:</p>

<p class=MsoCaption>Table 30, Summary of Cryptoki Functions</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='margin-left:5.4pt;border-collapse:collapse;border:none'>
 <thead>
  <tr>
   <td width=116 valign=top style='width:87.1pt;border-top:black 1.5pt;
   border-left:black 1.5pt;border-bottom:windowtext 1.0pt;border-right:black 1.0pt;
   border-style:solid;padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table><b><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Category</span></b></p>
   </td>
   <td width=178 valign=top style='width:133.4pt;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table><b><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Function</span></b></p>
   </td>
   <td width=288 valign=top style='width:3.0in;border-top:solid black 1.5pt;
   border-left:none;border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;
   padding:0in 5.4pt 0in 5.4pt'>
   <p class=Table><b><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Description</span></b></p>
   </td>
  </tr>
 </thead>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>General</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_Initialize</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>initializes
  Cryptoki</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>purpose
  functions</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_Finalize</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>clean
  up miscellaneous Cryptoki-associated resources</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_GetInfo</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>obtains
  general information about Cryptoki</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_GetFunctionList</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>obtains
  entry points of Cryptoki library functions</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:solid black 1.0pt;
  border-left:solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Slot
  and token</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_GetSlotList</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>obtains
  a list of slots in the system</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>management</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_GetSlotInfo</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>obtains
  information about a particular slot</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>functions</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_GetTokenInfo</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>obtains
  information about a particular token</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_WaitForSlotEvent</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>waits
  for a slot event (token insertion, removal, etc.) to occur</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_GetMechanismList</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>obtains
  a list of mechanisms supported by a token</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_GetMechanismInfo</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>obtains
  information about a particular mechanism</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_InitToken</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>initializes
  a token</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_InitPIN</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>initializes
  the normal user’s PIN</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_SetPIN</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>modifies
  the PIN of the current user</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Session
  management functions</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_OpenSession</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>opens
  a connection between an application and a particular token or sets up an
  application callback for token insertion</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_CloseSession</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>closes
  a session</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_CloseAllSessions</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>closes
  all sessions with a token</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_GetSessionInfo</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>obtains
  information about the session</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_GetOperationState</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>obtains
  the cryptographic operations state of a session</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_SetOperationState</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>sets
  the cryptographic operations state of a session</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_Login</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>logs
  into a token</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_Logout</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>logs
  out from a token</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:solid black 1.0pt;
  border-left:solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Object</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_CreateObject</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>creates
  an object</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>management</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_CopyObject</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>creates
  a copy of an object</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>functions</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_DestroyObject</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>destroys
  an object</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_GetObjectSize</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>obtains
  the size of an object in bytes</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_GetAttributeValue</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>obtains
  an attribute value of an object</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_SetAttributeValue</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>modifies
  an attribute value of an object</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_FindObjectsInit</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>initializes
  an object search operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_FindObjects</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>continues
  an object search operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_FindObjectsFinal</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>finishes
  an object search operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Encryption</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_EncryptInit</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>initializes
  an encryption operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>functions</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_Encrypt</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>encrypts
  single-part data</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_EncryptUpdate</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>continues
  a multiple-part encryption operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_EncryptFinal</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>finishes
  a multiple-part encryption operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Decryption</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_DecryptInit</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>initializes
  a decryption operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>functions</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_Decrypt</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>decrypts
  single-part encrypted data</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_DecryptUpdate</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>continues
  a multiple-part decryption operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_DecryptFinal</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>finishes
  a multiple-part decryption operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:solid black 1.0pt;
  border-left:solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Message</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_DigestInit</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>initializes
  a message-digesting operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span lang=SV style='font-size:10.0pt;font-family:"Arial","sans-serif"'>digesting</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span lang=SV style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_Digest</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>digests
  single-part data</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>functions</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_DigestUpdate</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>continues
  a multiple-part digesting operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_DigestKey</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>digests
  a key</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_DigestFinal</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>finishes
  a multiple-part digesting operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:solid black 1.0pt;
  border-left:solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span lang=SV style='font-size:
  10.0pt;font-family:"Arial","sans-serif"'>Signing</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span lang=SV style='font-size:
  10.0pt;font-family:"Arial","sans-serif"'>C_SignInit</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>initializes a signature operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>and MACing</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_Sign</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>signs single-part data</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>functions</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_SignUpdate</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>continues a multiple-part signature
  operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_SignFinal</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>finishes a multiple-part signature
  operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_SignRecoverInit</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>initializes a signature operation, where
  the data can be recovered from the signature</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_SignRecover</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>signs single-part data, where the data can
  be recovered from the signature</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Functions for verifying</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_VerifyInit</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>initializes a verification operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>signatures</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_Verify</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>verifies a signature on single-part data</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>and MACs</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_VerifyUpdate</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>continues a multiple-part verification
  operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_VerifyFinal</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>finishes a multiple-part verification
  operation</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_VerifyRecoverInit</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>initializes a verification operation where
  the data is recovered from the signature</span></p>
  </td>
 </tr>
 <tr style='height:27.6pt'>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:27.6pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:27.6pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_VerifyRecover</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt;
  height:27.6pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>verifies a signature on single-part data,
  where the data is recovered from the signature</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:solid black 1.0pt;
  border-left:solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Dual-purpose cryptographic</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_DigestEncryptUpdate</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>continues simultaneous multiple-part
  digesting and encryption operations</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>functions</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_DecryptDigestUpdate</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>continues simultaneous multiple-part
  decryption and digesting operations</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_SignEncryptUpdate</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>continues simultaneous multiple-part
  signature and encryption operations</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_DecryptVerifyUpdate</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>continues simultaneous multiple-part
  decryption and verification operations</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:solid black 1.0pt;
  border-left:solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Key</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_GenerateKey</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>generates
  a secret key</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>management</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_GenerateKeyPair</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>generates
  a public-key/private-key pair</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>functions</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_WrapKey</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>wraps
  (encrypts) a key</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_UnwrapKey</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>unwraps
  (decrypts) a key</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>C_DeriveKey</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>derives
  a key from a base key</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span lang=SV style='font-size:
  10.0pt;font-family:"Arial","sans-serif"'>Random number generation</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_SeedRandom</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>mixes in additional seed material to the
  random number generator</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>functions</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_GenerateRandom</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>generates random data</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:solid black 1.0pt;
  border-left:solid black 1.5pt;border-bottom:none;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>Parallel function management</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_GetFunctionStatus</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>legacy function which always returns
  CKR_FUNCTION_NOT_PARALLEL</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>functions</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>C_CancelFunction</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.0pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table style='page-break-after:avoid'><span style='font-size:10.0pt;
  font-family:"Arial","sans-serif"'>legacy function which always returns
  CKR_FUNCTION_NOT_PARALLEL</span></p>
  </td>
 </tr>
 <tr>
  <td width=116 valign=top style='width:87.1pt;border-top:none;border-left:
  solid black 1.5pt;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>Callback
  function</span></p>
  </td>
  <td width=178 valign=top style='width:133.4pt;border-top:none;border-left:
  none;border-bottom:solid black 1.5pt;border-right:solid black 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>&nbsp;</span></p>
  </td>
  <td width=288 valign=top style='width:3.0in;border-top:none;border-left:none;
  border-bottom:solid black 1.5pt;border-right:solid black 1.5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=Table><span style='font-size:10.0pt;font-family:"Arial","sans-serif"'>application-supplied
  function to process notifications from Cryptoki</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Execution of a Cryptoki function call is in general an
all-or-nothing affair, <i>i.e.</i>, a function call accomplishes either its
entire goal, or nothing at all.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>If a Cryptoki function executes successfully, it returns the
value CKR_OK.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>If a Cryptoki function does not execute successfully, it returns
some value other than CKR_OK, and the token is in the same state as it was in
prior to the function call.  If the function call was supposed to modify the
contents of certain memory addresses on the host computer, these memory
addresses may have been modified, despite the failure of the function.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>In unusual (and extremely unpleasant!) circumstances, a function
can fail with the return value CKR_GENERAL_ERROR.  When this happens, the token
and/or host computer may be in an inconsistent state, and the goals of the
function may have been partially achieved.</p>

<p class=MsoNormal>There are a small number of Cryptoki functions whose return
values do not behave precisely as described above; these exceptions are
documented individually with the description of the functions themselves.</p>

<p class=MsoNormal>A Cryptoki library need not support every function in the
Cryptoki API.  However, even an unsupported function MUST have a “stub” in the
library which simply returns the value CKR_FUNCTION_NOT_SUPPORTED.  The
function’s entry in the library’s <b>CK_FUNCTION_LIST</b> structure (as
obtained by <b>C_GetFunctionList</b>) should point to this stub function (see
Section 3.6).</p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc416959729"></a><a name="_Toc395183802"></a><a
name="_Toc391468806"></a><a name="_Toc370634015"></a><a name="_Toc235002310"></a><a
name="_Toc72656092"></a><a name="_Toc405794703"></a><a name="_Toc385057886"></a><a
name="_Ref384634295">5.1 Function return values</a></h2>

<p class=MsoNormal>The Cryptoki interface possesses a large number of functions
and return values.  In Section 5.1, we enumerate the various possible return
values for Cryptoki functions; most of the remainder of Section 5.1 details the behavior of Cryptoki functions, including what values each of them
may return.</p>

<p class=MsoNormal>Because of the complexity of the Cryptoki specification, it
is recommended that Cryptoki applications attempt to give some leeway when
interpreting Cryptoki functions’ return values.  We have attempted to specify
the behavior of Cryptoki functions as completely as was feasible; nevertheless,
there are presumably some gaps.  For example, it is possible that a particular
error code which might apply to a particular Cryptoki function is unfortunately
not actually listed in the description of that function as a possible error
code.  It is conceivable that the developer of a Cryptoki library might
nevertheless permit his/her implementation of that function to return that
error code.  It would clearly be somewhat ungraceful if a Cryptoki application
using that library were to terminate by abruptly dumping core upon receiving
that error code for that function.  It would be far preferable for the
application to examine the function’s return value, see that it indicates some
sort of error (even if the application doesn’t know precisely <i>what</i> kind
of error), and behave accordingly.</p>

<p class=MsoNormal>See Section 5.1.8 for some specific details on how a
developer might attempt to make an application that accommodates a range of
behaviors from Cryptoki libraries.</p>

<h3><a name="_Toc383864870"></a><a name="_Toc323610863"></a><a
name="_Toc323205433"></a><a name="_Toc323024101"></a><a name="_Toc323000707"></a><a
name="_Toc322945140"></a><a name="_Toc322855298"></a><a name="_Toc319315697"></a><a
name="_Toc319313704"></a><a name="_Toc319313511"></a><a name="_Toc405794704"></a><a
name="_Toc385057887"></a><a name="_Ref384823451">5.1.1  </a><a
name="_Toc416959730"></a><a name="_Toc395183803"></a><a name="_Toc391468807"></a><a
name="_Toc370634016"></a><a name="_Toc235002311"></a><a name="_Toc72656093">Universal
Cryptoki function return values</a></h3>

<p class=MsoNormal>Any Cryptoki function can return any of the following
values:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_GENERAL_ERROR: Some horrible, unrecoverable error has
occurred.  In the worst case, it is possible that the function only partially
succeeded, and that the computer and/or token is in an inconsistent state.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_HOST_MEMORY: The computer that the Cryptoki library is
running on has insufficient memory to perform the requested function.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_FUNCTION_FAILED: The requested function could not be
performed, but detailed information about why not is not available in this
error return.  If the failed function uses a session, it is possible that the <b>CK_SESSION_INFO</b>
structure that can be obtained by calling <b>C_GetSessionInfo</b> will hold
useful information about what happened in its <i>ulDeviceError</i> field.  In
any event, although the function call failed, the situation is not necessarily
totally hopeless, as it is likely to be when CKR_GENERAL_ERROR is returned. 
Depending on what the root cause of the error actually was, it is possible that
an attempt to make the exact same function call again would succeed.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_OK: The function executed successfully.  Technically, CKR_OK
is not <i>quite</i> a “universal” return value; in particular, the legacy
functions <b>C_GetFunctionStatus</b> and <b>C_CancelFunction</b> (see Section 5.15) cannot return CKR_OK.</p>

<p class=MsoNormal>The relative priorities of these errors are in the order
listed above, <i>e.g.</i>, if either of CKR_GENERAL_ERROR or CKR_HOST_MEMORY
would be an appropriate error return, then CKR_GENERAL_ERROR should be
returned.</p>

<h3><a name="_Toc405794705"></a><a name="_Toc385057888"></a><a
name="_Ref384823481">5.1.2  </a><a name="_Toc416959731"></a><a
name="_Toc395183804"></a><a name="_Toc391468808"></a><a name="_Toc370634017"></a><a
name="_Toc235002312"></a><a name="_Toc72656094">Cryptoki function return values
for functions that use a session handle</a></h3>

<p class=MsoNormal>Any Cryptoki function that takes a session handle as one of
its arguments (i.e., any Cryptoki function except for C_Initialize, C_Finalize,
C_GetInfo, C_GetFunctionList, C_GetSlotList, C_GetSlotInfo, C_GetTokenInfo,
C_WaitForSlotEvent, C_GetMechanismList, C_GetMechanismInfo, C_InitToken,
C_OpenSession, and C_CloseAllSessions) can return the following values<span
style='font-size:12.0pt'>:</span></p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_SESSION_HANDLE_INVALID: The specified session handle was
invalid <i>at the time that the function was invoked</i>.  Note that this can
happen if the session’s token is removed before the function invocation, since
removing a token closes all sessions with it.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_DEVICE_REMOVED: The token was removed from its slot <i>during
the execution of the function</i>.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_SESSION_CLOSED: The session was closed <i>during the
execution of the function</i>.  Note that, as stated in <b><span
style='color:#3B006F'>[PKCS11-UG]</span></b>, the behavior of Cryptoki is <i>undefined</i>
if multiple threads of an application attempt to access a common Cryptoki
session simultaneously.  Therefore, there is actually no guarantee that a
function invocation could ever return the value CKR_SESSION_CLOSED.  An example
of multiple threads accessing a common session simultaneously is where one thread
is using a session when another thread closes that same session.</p>

<p class=MsoNormal>The relative priorities of these errors are in the order
listed above, <i>e.g.</i>, if either of CKR_SESSION_HANDLE_INVALID or
CKR_DEVICE_REMOVED would be an appropriate error return, then
CKR_SESSION_HANDLE_INVALID should be returned.</p>

<p class=MsoNormal>In practice, it is often not crucial (or possible) for a
Cryptoki library to be able to make a distinction between a token being removed
<i>before</i> a function invocation and a token being removed <i>during</i> a
function execution.</p>

<h3><a name="_Toc405794706"></a><a name="_Toc385057889"></a><a
name="_Ref384823523">5.1.3  </a><a name="_Toc416959732"></a><a
name="_Toc395183805"></a><a name="_Toc391468809"></a><a name="_Toc370634018"></a><a
name="_Toc235002313"></a><a name="_Toc72656095">Cryptoki function return values
for functions that use a token</a></h3>

<p class=MsoNormal>Any Cryptoki function that uses a particular token (<i>i.e.</i>,
any Cryptoki function except for <b>C_Initialize</b>, <b>C_Finalize</b>, <b>C_GetInfo</b>,
<b>C_GetFunctionList</b>, <b>C_GetSlotList</b>, <b>C_GetSlotInfo</b>, or<b>
C_WaitForSlotEvent</b>) can return any of the following values:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_DEVICE_MEMORY: The token does not have sufficient memory to
perform the requested function.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_DEVICE_ERROR: Some problem has occurred with the token and/or
slot.  This error code can be returned by more than just the functions
mentioned above; in particular, it is possible for <b>C_GetSlotInfo</b> to
return CKR_DEVICE_ERROR.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_TOKEN_NOT_PRESENT: The token was not present in its slot <i>at
the time that the function was invoked</i>.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_DEVICE_REMOVED: The token was removed from its slot <i>during
the execution of the function</i>.</p>

<p class=MsoNormal>The relative priorities of these errors are in the order
listed above, <i>e.g.</i>, if either of CKR_DEVICE_MEMORY or CKR_DEVICE_ERROR
would be an appropriate error return, then CKR_DEVICE_MEMORY should be
returned.</p>

<p class=MsoNormal>In practice, it is often not critical (or possible) for a
Cryptoki library to be able to make a distinction between a token being removed
<i>before</i> a function invocation and a token being removed <i>during</i> a
function execution.</p>

<h3><a name="_Ref385060159"></a><a name="_Toc385057890"></a><a
name="_Toc405794707">5.1.4  </a><a name="_Toc416959733"></a><a
name="_Toc395183806"></a><a name="_Toc391468810"></a><a name="_Toc370634019"></a><a
name="_Toc235002314"></a><a name="_Toc72656096">Special return value for
application-supplied callbacks</a></h3>

<p class=MsoNormal>There is a special-purpose return value which is not
returned by any function in the actual Cryptoki API, but which may be returned
by an application-supplied callback function.  It is:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_CANCEL: When a function executing in serial with an
application decides to give the application a chance to do some work, it calls
an application-supplied function with a CKN_SURRENDER callback (see Section 5.16).  If the callback returns the value CKR_CANCEL, then the function aborts and
returns CKR_FUNCTION_CANCELED.</p>

<h3><a name="_Toc405794708">5.1.5  </a><a name="_Toc416959734"></a><a
name="_Toc395183807"></a><a name="_Toc391468811"></a><a name="_Toc370634020"></a><a
name="_Toc235002315"></a><a name="_Toc72656097">Special return values for
mutex-handling functions</a></h3>

<p class=MsoNormal>There are two other special-purpose return values which are
not returned by any actual Cryptoki functions.  These values may be returned by
application-supplied mutex-handling functions, and they may safely be ignored
by application developers who are not using their own threading model.  They
are:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_MUTEX_BAD: This error code can be returned by mutex-handling
functions that are passed a bad mutex object as an argument.  Unfortunately, it
is possible for such a function not to recognize a bad mutex object.  There is
therefore no guarantee that such a function will successfully detect bad mutex
objects and return this value.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_MUTEX_NOT_LOCKED: This error code can be returned by
mutex-unlocking functions.  It indicates that the mutex supplied to the
mutex-unlocking function was not locked.</p>

<h3><a name="_Toc405794709"></a><a name="_Ref395516454">5.1.6  </a><a
name="_Toc416959735"></a><a name="_Toc395183808"></a><a name="_Toc391468812"></a><a
name="_Toc370634021"></a><a name="_Toc235002316"></a><a name="_Toc72656098">All
other Cryptoki function return values</a></h3>

<p class=MsoNormal>Descriptions of the other Cryptoki function return values
follow.  Except as mentioned in the descriptions of particular error codes,
there are in general no particular priorities among the errors listed below, <i>i.e.</i>,
if more than one error code might apply to an execution of a function, then the
function may return any applicable error code.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_ACTION_PROHIBITED:  This value can only be returned by
C_CopyObject, C_SetAttributeValue and C_DestroyObject. It denotes that the
action may not be taken, either because of underlying policy restrictions on
the token, or because the object has the the relevant CKA_COPYABLE,
CKA_MODIFIABLE or CKA_DESTROYABLE policy attribute set to CK_FALSE.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_ARGUMENTS_BAD: This is a rather generic error code which
indicates that the arguments supplied to the Cryptoki function were in some way
not appropriate.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_ATTRIBUTE_READ_ONLY: An attempt was made to set a value for
an attribute which may not be set by the application, or which may not be
modified by the application.  See Section 4.1 for more information.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_ATTRIBUTE_SENSITIVE: An attempt was made to obtain the value
of an attribute of an object which cannot be satisfied because the object is
either sensitive or un-extractable.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_ATTRIBUTE_TYPE_INVALID: An invalid attribute type was
specified in a template.  See Section 4.1 for more information.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_ATTRIBUTE_VALUE_INVALID: An invalid value was specified for a
particular attribute in a template.  See Section 4.1 for more information.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_BUFFER_TOO_SMALL: The output of the function is too large to
fit in the supplied buffer.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_CANT_LOCK: This value can only be returned by <b>C_Initialize</b>. 
It means that the type of locking requested by the application for
thread-safety is not available in this library, and so the application cannot
make use of this library in the specified fashion.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_CRYPTOKI_ALREADY_INITIALIZED: This value can only be returned
by <b>C_Initialize</b>.  It means that the Cryptoki library has already been
initialized (by a previous call to <b>C_Initialize</b> which did not have a
matching <b>C_Finalize</b> call).</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_CRYPTOKI_NOT_INITIALIZED: This value can be returned by any
function other than <b>C_Initialize</b> and <b>C_GetFunctionList</b>.  It
indicates that the function cannot be executed because the Cryptoki library has
not yet been initialized by a call to <b>C_Initialize</b>.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_CURVE_NOT_SUPPORTED:  This curve is not supported by this
token.  Used with Elliptic Curve mechanisms.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_DATA_INVALID: The plaintext input data to a cryptographic
operation is invalid.  This return value has lower priority than
CKR_DATA_LEN_RANGE.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_DATA_LEN_RANGE: The plaintext input data to a cryptographic
operation has a bad length.  Depending on the operation’s mechanism, this could
mean that the plaintext data is too short, too long, or is not a multiple of
some particular block size.  This return value has higher priority than
CKR_DATA_INVALID.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_DOMAIN_PARAMS_INVALID: Invalid or unsupported domain
parameters were supplied to the function.  Which representation methods of
domain parameters are supported by a given mechanism can vary from token to
token.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_ENCRYPTED_DATA_INVALID: The encrypted input to a decryption
operation has been determined to be invalid ciphertext.  This return value has
lower priority than CKR_ENCRYPTED_DATA_LEN_RANGE.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_ENCRYPTED_DATA_LEN_RANGE: The ciphertext input to a
decryption operation has been determined to be invalid ciphertext solely on the
basis of its length.  Depending on the operation’s mechanism, this could mean
that the ciphertext is too short, too long, or is not a multiple of some
particular block size.  This return value has higher priority than
CKR_ENCRYPTED_DATA_INVALID.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_EXCEEDED_MAX_ITERATIONS: An iterative algorithm (for key pair
generation, domain parameter generation etc.) failed because we have exceeded
the maximum number of iterations.  This error code has precedence over
CKR_FUNCTION_FAILED. Examples of iterative algorithms include DSA signature
generation (retry if either r = 0 or s = 0) and generation of DSA primes p and
q specified in FIPS 186-4.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_FIPS_SELF_TEST_FAILED: A FIPS 140-2 power-up self-test or
conditional self-test failed.  The token entered an error state.  Future calls
to cryptographic functions on the token will return CKR_GENERAL_ERROR. 
CKR_FIPS_SELF_TEST_FAILED has a higher precedence over CKR_GENERAL_ERROR. This
error may be returned by C_Initialize, if a power-up self-test  failed, by
C_GenerateRandom or C_SeedRandom, if the continuous random number generator
test failed, or by C_GenerateKeyPair, if the pair-wise consistency test failed.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_FUNCTION_CANCELED: The function was canceled in
mid-execution.  This happens to a cryptographic function if the function makes
a <b>CKN_SURRENDER</b> application callback which returns CKR_CANCEL (see
CKR_CANCEL). It also happens to a function that performs PIN entry through a
protected path. The method used to cancel a protected path PIN entry operation
is device dependent.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_FUNCTION_NOT_PARALLEL: There is currently no function
executing in parallel in the specified session.  This is a legacy error code
which is only returned by the legacy functions <b>C_GetFunctionStatus</b> and <b>C_CancelFunction</b>.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_FUNCTION_NOT_SUPPORTED: The requested function is not
supported by this Cryptoki library.  Even unsupported functions in the Cryptoki
API should have a “stub” in the library; this stub should simply return the
value CKR_FUNCTION_NOT_SUPPORTED.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_FUNCTION_REJECTED: The signature request is rejected by the
user.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_INFORMATION_SENSITIVE: The information requested could not be
obtained because the token considers it sensitive, and is not able or willing
to reveal it.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_KEY_CHANGED: This value is only returned by <b>C_SetOperationState</b>. 
It indicates that one of the keys specified is not the same key that was being
used in the original saved session.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_KEY_FUNCTION_NOT_PERMITTED: An attempt has been made to use a
key for a cryptographic purpose that the key’s attributes are not set to allow
it to do.  For example, to use a key for performing encryption, that key MUST
have its <b>CKA_ENCRYPT</b> attribute set to CK_TRUE (the fact that the key MUST
have a <b>CKA_ENCRYPT</b> attribute implies that the key cannot be a private
key).  This return value has lower priority than CKR_KEY_TYPE_INCONSISTENT.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_KEY_HANDLE_INVALID: The specified key handle is not valid. 
It may be the case that the specified handle is a valid handle for an object
which is not a key.  We reiterate here that 0 is never a valid key handle.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_KEY_INDIGESTIBLE: This error code can only be returned by <b>C_DigestKey</b>. 
It indicates that the value of the specified key cannot be digested for some
reason (perhaps the key isn’t a secret key, or perhaps the token simply can’t
digest this kind of key).</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_KEY_NEEDED: This value is only returned by <b>C_SetOperationState</b>. 
It indicates that the session state cannot be restored because <b>C_SetOperationState</b>
needs to be supplied with one or more keys that were being used in the original
saved session.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_KEY_NOT_NEEDED: An extraneous key was supplied to <b>C_SetOperationState</b>. 
For example, an attempt was made to restore a session that had been performing
a message digesting operation, and an encryption key was supplied.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_KEY_NOT_WRAPPABLE: Although the specified private or secret
key does not have its CKA_EXTRACTABLE attribute set to CK_FALSE, Cryptoki (or
the token) is unable to wrap the key as requested (possibly the token can only
wrap a given key with certain types of keys, and the wrapping key specified is
not one of these types).  Compare with CKR_KEY_UNEXTRACTABLE.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_KEY_SIZE_RANGE: Although the requested keyed cryptographic
operation could in principle be carried out, this Cryptoki library (or the
token) is unable to actually do it because the supplied key‘s size is outside
the range of key sizes that it can handle.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_KEY_TYPE_INCONSISTENT: The specified key is not the correct
type of key to use with the specified mechanism.  This return value has a
higher priority than CKR_KEY_FUNCTION_NOT_PERMITTED.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_KEY_UNEXTRACTABLE: The specified private or secret key can’t
be wrapped because its CKA_EXTRACTABLE attribute is set to CK_FALSE.  Compare
with CKR_KEY_NOT_WRAPPABLE.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_LIBRARY_LOAD_FAILED: The Cryptoki library could not load <span
style='color:black'>a dependent shared library.</span></p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_MECHANISM_INVALID: An invalid mechanism was specified to the
cryptographic operation.  This error code is an appropriate return value if an
unknown mechanism was specified or if the mechanism specified cannot be used in
the selected token with the selected function.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_MECHANISM_PARAM_INVALID: Invalid parameters were supplied to
the mechanism specified to the cryptographic operation.  Which parameter values
are supported by a given mechanism can vary from token to token.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_NEED_TO_CREATE_THREADS: This value can only be returned by <b>C_Initialize</b>. 
It is returned when two conditions hold:</p>

<ol style='margin-top:0in' start=1 type=1>
 <li class=MsoNormal>The application called <b>C_Initialize</b> in a way which
     tells the Cryptoki library that application threads executing calls to the
     library cannot use native operating system methods to spawn new threads.</li>
 <li class=MsoNormal>The library cannot function properly without being able to
     spawn new threads in the above fashion.</li>
</ol>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_NO_EVENT: This value can only be returned by <b>C_GetSlotEvent</b>. 
It is returned when <b>C_GetSlotEvent</b> is called in non-blocking mode and
there are no new slot events to return.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_OBJECT_HANDLE_INVALID: The specified object handle is not
valid.  We reiterate here that 0 is never a valid object handle.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_OPERATION_ACTIVE: There is already an active operation (or
combination of active operations) which prevents Cryptoki from activating the
specified operation.  For example, an active object-searching operation would
prevent Cryptoki from activating an encryption operation with <b>C_EncryptInit</b>. 
Or, an active digesting operation and an active encryption operation would
prevent Cryptoki from activating a signature operation.  Or, on a token which
doesn’t support simultaneous dual cryptographic operations in a session (see
the description of the <b>CKF_DUAL_CRYPTO_OPERATIONS</b> flag in the <b>CK_TOKEN_INFO</b>
structure), an active signature operation would prevent Cryptoki from
activating an encryption operation.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_OPERATION_NOT_INITIALIZED: There is no active operation of an
appropriate type in the specified session.  For example, an application cannot
call <b>C_Encrypt</b> in a session without having called <b>C_EncryptInit</b>
first to activate an encryption operation.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_PIN_EXPIRED: The specified PIN has expired, and the requested
operation cannot be carried out unless C_SetPIN is called to change the PIN
value.  Whether or not the normal user’s PIN on a token ever expires varies from
token to token.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_PIN_INCORRECT: The specified PIN is incorrect, <i>i.e.</i>,
does not match the PIN stored on the token.  More generally-- when
authentication to the token involves something other than a PIN-- the attempt
to authenticate the user has failed.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_PIN_INVALID: The specified PIN has invalid characters in it. 
This return code only applies to functions which attempt to set a PIN.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_PIN_LEN_RANGE: The specified PIN is too long or too short. 
This return code only applies to functions which attempt to set a PIN.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_PIN_LOCKED: The specified PIN is “locked”, and cannot be
used.  That is, because some particular number of failed authentication
attempts has been reached, the token is unwilling to permit further attempts at
authentication.  Depending on the token, the specified PIN may or may not
remain locked indefinitely.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_PIN_TOO_WEAK: The specified PIN is too weak so that it could
be easy to guess.  If the PIN is too short, CKR_PIN_LEN_RANGE should be
returned instead. This return code only applies to functions which attempt to
set a PIN.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_PUBLIC_KEY_INVALID: The public key fails a public key
validation.  For example, an EC public key fails the public key validation
specified in Section 5.2.2 of ANSI X9.62. This error code may be returned by
C_CreateObject, when the public key is created, or by C_VerifyInit or
C_VerifyRecoverInit, when the public key is used.  It may also be returned by
C_DeriveKey, in preference to  CKR_MECHANISM_PARAM_INVALID, if the other
party's public key specified in the mechanism's parameters is invalid.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_RANDOM_NO_RNG: This value can be returned by <b>C_SeedRandom</b>
and <b>C_GenerateRandom</b>.  It indicates that the specified token doesn’t
have a random number generator.  This return value has higher priority than
CKR_RANDOM_SEED_NOT_SUPPORTED.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_RANDOM_SEED_NOT_SUPPORTED: This value can only be returned by
<b>C_SeedRandom</b>.  It indicates that the token’s random number generator
does not accept seeding from an application.  This return value has lower
priority than CKR_RANDOM_NO_RNG.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_SAVED_STATE_INVALID: This value can only be returned by <b>C_SetOperationState</b>. 
It indicates that the supplied saved cryptographic operations state is invalid,
and so it cannot be restored to the specified session.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_SESSION_COUNT: This value can only be returned by <b>C_OpenSession</b>. 
It indicates that the attempt to open a session failed, either because the
token has too many sessions already open, or because the token has too many
read/write sessions already open.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_SESSION_EXISTS: This value can only be returned by <b>C_InitToken</b>. 
It indicates that a session with the token is already open, and so the token
cannot be initialized.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_SESSION_PARALLEL_NOT_SUPPORTED: The specified token does not
support parallel sessions.  This is a legacy error code—in Cryptoki Version
2.01 and up, <i>no</i> token supports parallel sessions. 
CKR_SESSION_PARALLEL_NOT_SUPPORTED can only be returned by <b>C_OpenSession</b>,
and it is only returned when <b>C_OpenSession</b> is called in a particular
[deprecated] way.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_SESSION_READ_ONLY: The specified session was unable to
accomplish the desired action because it is a read-only session.  This return
value has lower priority than CKR_TOKEN_WRITE_PROTECTED.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_SESSION_READ_ONLY_EXISTS: A read-only session already exists,
and so the SO cannot be logged in.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_SESSION_READ_WRITE_SO_EXISTS: A read/write SO session already
exists, and so a read-only session cannot be opened.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_SIGNATURE_LEN_RANGE: The provided signature/MAC can be seen
to be invalid solely on the basis of its length.  This return value has higher
priority than CKR_SIGNATURE_INVALID.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_SIGNATURE_INVALID: The provided signature/MAC is invalid. 
This return value has lower priority than CKR_SIGNATURE_LEN_RANGE.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_SLOT_ID_INVALID: The specified slot ID is not valid.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_STATE_UNSAVEABLE: The cryptographic operations state of the
specified session cannot be saved for some reason (possibly the token is simply
unable to save the current state).  This return value has lower priority than
CKR_OPERATION_NOT_INITIALIZED.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_TEMPLATE_INCOMPLETE: The template specified for creating an
object is incomplete, and lacks some necessary attributes.  See Section 4.1 for more information.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_TEMPLATE_INCONSISTENT: The template specified for creating an
object has conflicting attributes.  See Section 4.1 for more information.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_TOKEN_NOT_RECOGNIZED: The Cryptoki library and/or slot does
not recognize the token in the slot.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_TOKEN_WRITE_PROTECTED: The requested action could not be
performed because the token is write-protected.  This return value has higher
priority than CKR_SESSION_READ_ONLY.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_UNWRAPPING_KEY_HANDLE_INVALID: This value can only be
returned by <b>C_UnwrapKey</b>.  It indicates that the key handle specified to
be used to unwrap another key is not valid.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_UNWRAPPING_KEY_SIZE_RANGE: This value can only be returned by
<b>C_UnwrapKey</b>.  It indicates that although the requested unwrapping
operation could in principle be carried out, this Cryptoki library (or the
token) is unable to actually do it because the supplied key’s size is outside
the range of key sizes that it can handle.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_UNWRAPPING_KEY_TYPE_INCONSISTENT: This value can only be
returned by <b>C_UnwrapKey</b>.  It indicates that the type of the key specified
to unwrap another key is not consistent with the mechanism specified for
unwrapping.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_USER_ALREADY_LOGGED_IN: This value can only be returned by <b>C_Login</b>. 
It indicates that the specified user cannot be logged into the session, because
it is already logged into the session.  For example, if an application has an
open SO session, and it attempts to log the SO into it, it will receive this
error code.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_USER_ANOTHER_ALREADY_LOGGED_IN: This value can only be
returned by <b>C_Login</b>.  It indicates that the specified user cannot be
logged into the session, because another user is already logged into the
session.  For example, if an application has an open SO session, and it
attempts to log the normal user into it, it will receive this error code.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_USER_NOT_LOGGED_IN: The desired action cannot be performed
because the appropriate user (or <i>an</i> appropriate user) is not logged in. 
One example is that a session cannot be logged out unless it is logged in. 
Another example is that a private object cannot be created on a token unless
the session attempting to create it is logged in as the normal user.  A final
example is that cryptographic operations on certain tokens cannot be performed
unless the normal user is logged in.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_USER_PIN_NOT_INITIALIZED: This value can only be returned by <b>C_Login</b>. 
It indicates that the normal user’s PIN has not yet been initialized with <b>C_InitPIN</b>.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_USER_TOO_MANY_TYPES: An attempt was made to have more
distinct users simultaneously logged into the token than the token and/or
library permits.  For example, if some application has an open SO session, and
another application attempts to log the normal user into a session, the attempt
may return this error.  It is not required to, however.  Only if the
simultaneous distinct users cannot be supported does <b>C_Login</b> have to
return this value.  Note that this error code generalizes to true multi-user
tokens.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_USER_TYPE_INVALID: An invalid value was specified as a <b>CK_USER_TYPE</b>. 
Valid types are <b>CKU_SO</b>, <b>CKU_USER</b>, and <b>CKU_CONTEXT_SPECIFIC</b>.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_WRAPPED_KEY_INVALID: This value can only be returned by <b>C_UnwrapKey</b>. 
It indicates that the provided wrapped key is not valid.  If a call is made to <b>C_UnwrapKey</b>
to unwrap a particular type of key (<i>i.e.</i>, some particular key type is
specified in the template provided to <b>C_UnwrapKey</b>), and the wrapped key
provided to <b>C_UnwrapKey</b> is recognizably not a wrapped key of the proper
type, then <b>C_UnwrapKey</b> should return CKR_WRAPPED_KEY_INVALID.  This
return value has lower priority than CKR_WRAPPED_KEY_LEN_RANGE.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_WRAPPED_KEY_LEN_RANGE: This value can only be returned by <b>C_UnwrapKey</b>. 
It indicates that the provided wrapped key can be seen to be invalid solely on
the basis of its length.  This return value has higher priority than
CKR_WRAPPED_KEY_INVALID.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_WRAPPING_KEY_HANDLE_INVALID: This value can only be returned
by <b>C_WrapKey</b>.  It indicates that the key handle specified to be used to
wrap another key is not valid.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_WRAPPING_KEY_SIZE_RANGE: This value can only be returned by <b>C_WrapKey</b>. 
It indicates that although the requested wrapping operation could in principle
be carried out, this Cryptoki library (or the token) is unable to actually do
it because the supplied wrapping key’s size is outside the range of key sizes
that it can handle.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CKR_WRAPPING_KEY_TYPE_INCONSISTENT: This value can only be
returned by <b>C_WrapKey</b>.  It indicates that the type of the key specified
to wrap another key is not consistent with the mechanism specified for
wrapping.</p>

<h3><a name="_Toc405794710"></a><a name="_Toc385057891">5.1.7  </a><a
name="_Toc416959736"></a><a name="_Toc395183809"></a><a name="_Toc391468813"></a><a
name="_Toc370634022"></a><a name="_Toc235002317"></a><a name="_Toc72656099">More
on relative priorities of Cryptoki errors</a></h3>

<p class=MsoNormal>In general, when a Cryptoki call is made, error codes from
Section 5.1.1 (other than CKR_OK) take precedence over error codes from Section
5.1.2, which take precedence over error codes from Section 5.1.3, which take precedence over error codes from Section 5.1.6.  One minor implication of this is
that functions that use a session handle (<i>i.e.</i>, <i>most</i> functions!)
never return the error code CKR_TOKEN_NOT_PRESENT (they return
CKR_SESSION_HANDLE_INVALID instead).  Other than these precedences, if more
than one error code applies to the result of a Cryptoki call, any of the
applicable error codes may be returned.  Exceptions to this rule will be
explicitly mentioned in the descriptions of functions.</p>

<h3><a name="_Ref406906262">5.1.8  </a><a name="_Toc416959737"></a><a
name="_Toc395183810"></a><a name="_Toc391468814"></a><a name="_Toc370634023"></a><a
name="_Toc235002318"></a><a name="_Toc72656100">Error code “gotchas”</a></h3>

<p class=MsoNormal>Here is a short list of a few particular things about return
values that Cryptoki developers might want to be aware of:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>As
mentioned in Sections 5.1.2 and 5.1.3, a Cryptoki library may not be able to
make a distinction between a token being removed <i>before</i> a function
invocation and a token being removed <i>during</i> a function invocation.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>As
mentioned in Section 5.1.2, an application should never count on getting a
CKR_SESSION_CLOSED error.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>The
difference between CKR_DATA_INVALID and CKR_DATA_LEN_RANGE can be somewhat
subtle.  Unless an application <i>needs</i> to be able to distinguish between
these return values, it is best to always treat them equivalently.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Similarly,
the difference between CKR_ENCRYPTED_DATA_INVALID and
CKR_ENCRYPTED_DATA_LEN_RANGE, and between CKR_WRAPPED_KEY_INVALID and
CKR_WRAPPED_KEY_LEN_RANGE, can be subtle, and it may be best to treat these
return values equivalently.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Even with
the guidance of Section 4.1, it can be difficult for a Cryptoki library
developer to know which of CKR_ATTRIBUTE_VALUE_INVALID,
CKR_TEMPLATE_INCOMPLETE, or CKR_TEMPLATE_INCONSISTENT to return.  When
possible, it is recommended that application developers be generous in their
interpretations of these error codes.</p>

<h2><a name="_Ref384632513"></a><a name="_Toc416959738"></a><a
name="_Toc395183811"></a><a name="_Toc391468815"></a><a name="_Toc370634024"></a><a
name="_Toc235002319"></a><a name="_Toc72656101"></a><a name="_Toc405794711"></a><a
name="_Toc385057892"></a><a name="_Ref384959982"></a><a name="_Ref384895442">5.2
Conventions for functions returning </a>output in a variable-length buffer</h2>

<p class=MsoNormal>A number of the functions defined in Cryptoki return output
produced by some cryptographic mechanism.  The amount of output returned by
these functions is returned in a variable-length application-supplied buffer. 
An example of a function of this sort is <b>C_Encrypt</b>, which takes some
plaintext as an argument, and outputs a buffer full of ciphertext.</p>

<p class=MsoNormal>These functions have some common calling conventions, which
we describe here.  Two of the arguments to the function are a pointer to the
output buffer (say <i>pBuf</i>) and a pointer to a location which will hold the
length of the output produced (say <i>pulBufLen</i>).  There are two ways for
an application to call such a function:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>If <i>pBuf</i>
is NULL_PTR, then all that the function does is return (in *<i>pulBufLen</i>) a
number of bytes which would suffice to hold the cryptographic output produced
from the input to the function.  This number may somewhat exceed the precise
number of bytes needed, but should not exceed it by a large amount.  CKR_OK is
returned by the function.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>If <i>pBuf</i>
is not NULL_PTR, then *<i>pulBufLen</i> MUST contain the size in bytes of the
buffer pointed to by <i>pBuf</i>.  If that buffer is large enough to hold the
cryptographic output produced from the input to the function, then that
cryptographic output is placed there, and CKR_OK is returned by the function. 
If the buffer is not large enough, then CKR_BUFFER_TOO_SMALL is returned.  In
either case, *<i>pulBufLen</i> is set to hold the <i>exact</i> number of bytes
needed to hold the cryptographic output produced from the input to the
function.</p>

<p class=MsoNormal>All functions which use the above convention will explicitly
say so.</p>

<p class=MsoNormal>Cryptographic functions which return output in a
variable-length buffer should always return as much output as can be computed
from what has been passed in to them thus far.  As an example, consider a
session which is performing a multiple-part decryption operation with DES in
cipher-block chaining mode with PKCS padding.  Suppose that, initially, 8 bytes
of ciphertext are passed to the <b>C_DecryptUpdate</b> function.  The block
size of DES is 8 bytes, but the PKCS padding makes it unclear at this stage
whether the ciphertext was produced from encrypting a 0-byte string, or from
encrypting some string of length at least 8 bytes.  Hence the call to <b>C_DecryptUpdate</b>
should return 0 bytes of plaintext.  If a single additional byte of ciphertext
is supplied by a subsequent call to <b>C_DecryptUpdate</b>, then that call
should return 8 bytes of plaintext (one full DES block).</p>

<h2><a name="_Toc416959739"></a><a name="_Toc395183812"></a><a
name="_Toc391468816"></a><a name="_Toc370634025"></a><a name="_Toc235002320"></a><a
name="_Toc72656102"></a><a name="_Toc405794712"></a><a name="_Toc385057893">5.3
Disclaimer concerning sample code</a></h2>

<p class=MsoNormal>For the remainder of this section, we enumerate the various
functions defined in Cryptoki.  Most functions will be shown in use in at least
one sample code snippet.  For the sake of brevity, sample code will frequently
be somewhat incomplete.  In particular, sample code will generally ignore
possible error returns from C library functions, and also will not deal with
Cryptoki error returns in a realistic fashion.</p>

<h2><a name="_Toc416959740"></a><a name="_Toc395183813"></a><a
name="_Toc391468817"></a><a name="_Toc370634026"></a><a name="_Toc235002321"></a><a
name="_Toc72656103"></a><a name="_Toc405794713"></a><a name="_Ref394217726"></a><a
name="_Ref394217698"></a><a name="_Toc385057894">5.4 General-purpose</a>
functions</h2>

<p class=MsoNormal>Cryptoki provides the following general-purpose functions:</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal><a name="_Toc235002322"></a><a name="_Toc72656104"></a><a
     name="_Toc405794714"></a><a name="_Toc385057895"></a><a
     name="_Toc383864871"></a><a name="_Toc323610864"></a><a
     name="_Toc323205434"></a><a name="_Toc323024102"><strong><span
     style='font-size:12.0pt'>C_Initialize</span></strong></a></li>
</ul>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_Initialize) {</p>

<p class=BoxedCode>      CK_VOID_PTR pInitArgs</p>

<p class=BoxedCode>);</p>

</div>

<p class=MsoNormal><b>C_Initialize</b> initializes the Cryptoki library.  <i>pInitArgs</i>
either has the value NULL_PTR or points to a <b>CK_C_INITIALIZE_ARGS</b>
structure containing information on how the library should deal with multi-threaded
access.  If an application will not be accessing Cryptoki through multiple
threads simultaneously, it can generally supply the value NULL_PTR to <b>C_Initialize</b>
(the consequences of supplying this value will be explained below).</p>

<p class=MsoNormal>If <i>pInitArgs</i> is non-NULL_PTR, <b>C_Initialize</b>
should cast it to a <b>CK_C_INITIALIZE_ARGS_PTR</b> and then dereference the
resulting pointer to obtain the <b>CK_C_INITIALIZE_ARGS</b> fields <i>CreateMutex</i>,
<i>DestroyMutex</i>, <i>LockMutex</i>, <i>UnlockMutex</i>, <i>flags</i>, and <i>pReserved</i>. 
For this version of Cryptoki, the value of <i>pReserved</i> thereby obtained MUST
be NULL_PTR; if it’s not, then <b>C_Initialize</b> should return with the value
CKR_ARGUMENTS_BAD.</p>

<p class=MsoNormal>If the <b>CKF_LIBRARY_CANT_CREATE_OS_THREADS</b> flag in the
<i>flags</i> field is set, that indicates that application threads which are
executing calls to the Cryptoki library are not permitted to use the native
operation system calls to spawn off new threads.  In other words, the library’s
code may not create its own threads.  If the library is unable to function
properly under this restriction, <b>C_Initialize</b> should return with the
value CKR_NEED_TO_CREATE_THREADS.</p>

<p class=MsoNormal>A call to <b>C_Initialize</b> specifies one of four
different ways to support multi-threaded access via the value of the <b>CKF_OS_LOCKING_OK</b>
flag in the <i>flags</i> field and the values of the <i>CreateMutex</i>, <i>DestroyMutex</i>,
<i>LockMutex</i>, and <i>UnlockMutex</i> function pointer fields:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>If the
flag <i>isn’t</i> set, and the function pointer fields <i>aren’t</i> supplied (<i>i.e.</i>,
they all have the value NULL_PTR), that means that the application <i>won’t</i>
be accessing the Cryptoki library from multiple threads simultaneously.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>If the
flag <i>is</i> set, and the function pointer fields <i>aren’t</i> supplied (<i>i.e.</i>,
they all have the value NULL_PTR), that means that the application <i>will</i>
be performing multi-threaded Cryptoki access, and the library needs to use the
native operating system primitives to ensure safe multi-threaded access.  If
the library is unable to do this, <b>C_Initialize</b> should return with the
value CKR_CANT_LOCK.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>If the
flag <i>isn’t</i> set, and the function pointer fields <i>are</i> supplied (<i>i.e.</i>,
they all have non-NULL_PTR values), that means that the application <i>will</i>
be performing multi-threaded Cryptoki access, and the library needs to use the
supplied function pointers for mutex-handling to ensure safe multi-threaded
access.  If the library is unable to do this, <b>C_Initialize</b> should return
with the value CKR_CANT_LOCK.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>If the
flag <i>is</i> set, and the function pointer fields <i>are</i> supplied (<i>i.e.</i>,
they all have non-NULL_PTR values), that means that the application <i>will</i>
be performing multi-threaded Cryptoki access, and the library needs to use
either the native operating system primitives or the supplied function pointers
for mutex-handling to ensure safe multi-threaded access.  If the library is
unable to do this, <b>C_Initialize</b> should return with the value
CKR_CANT_LOCK.</p>

<p class=MsoNormal>If some, but not all, of the supplied function pointers to <b>C_Initialize</b>
are non-NULL_PTR, then <b>C_Initialize</b> should return with the value
CKR_ARGUMENTS_BAD.</p>

<p class=MsoNormal>A call to <b>C_Initialize</b> with <i>pInitArgs</i> set to
NULL_PTR is treated like a call to <b>C_Initialize</b> with <i>pInitArgs</i>
pointing to a <b>CK_C_INITIALIZE_ARGS</b> which has the <i>CreateMutex</i>, <i>DestroyMutex</i>,
<i>LockMutex</i>, <i>UnlockMutex</i>, and <i>pReserved</i> fields set to
NULL_PTR, and has the <i>flags</i> field set to 0.</p>

<p class=MsoNormal><b>C_Initialize</b> should be the first Cryptoki call made by
an application, except for calls to <b>C_GetFunctionList</b>.  What this
function actually does is implementation-dependent; typically, it might cause
Cryptoki to initialize its internal memory buffers, or any other resources it
requires.</p>

<p class=MsoNormal>If several applications are using Cryptoki, each one should
call <b>C_Initialize</b>.  Every call to <b>C_Initialize</b> should
(eventually) be succeeded by a single call to <b>C_Finalize</b>.  See <b><span
style='color:#3B006F'>[PKCS11-UG]</span></b> for further details.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_CANT_LOCK,
CKR_CRYPTOKI_ALREADY_INITIALIZED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR,
CKR_HOST_MEMORY, CKR_NEED_TO_CREATE_THREADS, CKR_OK.</p>

<p class=MsoNormal>Example: see <b>C_GetInfo</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc383864872"></a><a name="_Toc323610865"></a><a name="_Toc323205435"></a><a
name="_Toc323024103"></a><a name="_Toc235002323"></a><a name="_Toc72656105"></a><a
name="_Toc405794715"></a><a name="_Toc385057896"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_Finalize</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_Finalize)(</p>

<p class=BoxedCode>      CK_VOID_PTR pReserved</p>

<p class=BoxedCode><span style='font-family:"Arial","sans-serif"'>);</span></p>

</div>

<p class=MsoNormal><b>C_Finalize</b> is called to indicate that an application
is finished with the Cryptoki library.  It should be the last Cryptoki call
made by an application.  The <i>pReserved</i> parameter is reserved for future
versions; for this version, it should be set to NULL_PTR (if <b>C_Finalize</b>
is called with a non-NULL_PTR value for <i>pReserved</i>, it should return the
value CKR_ARGUMENTS_BAD.</p>

<p class=MsoNormal>If several applications are using Cryptoki, each one should
call <b>C_Finalize</b>.  Each application’s call to <b>C_Finalize</b> should be
preceded by a single call to <b>C_Initialize</b>; in between the two calls, an
application can make calls to other Cryptoki functions.  See <b><span
style='color:#3B006F'>[PKCS11-UG] </span></b>for further details.</p>

<p class=MsoNormal><i>Despite the fact that the parameters supplied to <b>C_Initialize</b>
can in general allow for safe multi-threaded access to a Cryptoki library, the
behavior of <b>C_Finalize</b> is nevertheless undefined if it is called by an
application while other threads of the application are making Cryptoki calls. 
The exception to this exceptional behavior of <b>C_Finalize</b> occurs when a
thread calls <b>C_Finalize</b> while another of the application’s threads is
blocking on Cryptoki’s <b>C_WaitForSlotEvent</b> function.  When this happens,
the blocked thread becomes unblocked and returns the value
CKR_CRYPTOKI_NOT_INITIALIZED.  See <b>C_WaitForSlotEvent</b> for more
information.</i></p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR,
CKR_HOST_MEMORY, CKR_OK.</p>

<p class=MsoNormal>Example: see <b>C_GetInfo</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002324"></a><a name="_Toc72656106"></a><a name="_Toc405794716"></a><a
name="_Toc385057897"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>C_GetInfo</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_GetInfo)(</p>

<p class=BoxedCode>      CK_INFO_PTR pInfo</p>

<p class=BoxedCode>);</p>

</div>

<p class=MsoNormal><b>C_GetInfo</b> returns general information about
Cryptoki.  <i>pInfo</i> points to the location that receives the information.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR,
CKR_HOST_MEMORY, CKR_OK.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_INFO info;</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>CK_C_INITIALIZE_ARGS InitArgs;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>InitArgs.CreateMutex = &amp;MyCreateMutex;</p>

<p class=BoxedCode>InitArgs.DestroyMutex = &amp;MyDestroyMutex;</p>

<p class=BoxedCode>InitArgs.LockMutex = &amp;MyLockMutex;</p>

<p class=BoxedCode>InitArgs.UnlockMutex = &amp;MyUnlockMutex;</p>

<p class=BoxedCode>InitArgs.flags = CKF_OS_LOCKING_OK;</p>

<p class=BoxedCode>InitArgs.pReserved = NULL_PTR;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>rv = C_Initialize((CK_VOID_PTR)&amp;InitArgs);</p>

<p class=BoxedCode>assert(rv == CKR_OK);</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>rv = C_GetInfo(&amp;info);</p>

<p class=BoxedCode>assert(rv == CKR_OK);</p>

<p class=BoxedCode>if(info.version.major == 2) {</p>

<p class=BoxedCode>  /* Do lots of interesting cryptographic things with the
token */</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>rv = C_Finalize(NULL_PTR);</p>

<p class=BoxedCode>assert(rv == CKR_OK);</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc383864873"></a><a name="_Toc323610866"></a><a name="_Toc323205436"></a><a
name="_Toc323024104"></a><a name="_Toc323000708"></a><a name="_Toc322945141"></a><a
name="_Toc322855299"></a><a name="_Toc319315698"></a><a name="_Toc319313705"></a><a
name="_Toc319313512"></a><a name="_Toc319287671"></a><a name="_Toc235002325"></a><a
name="_Toc72656107"></a><a name="_Toc405794717"></a><a name="_Toc385057898"><span
style='font-family:Symbol;font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_GetFunctionList</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_GetFunctionList)(</p>

<p class=BoxedCode>      CK_FUNCTION_LIST_PTR_PTR ppFunctionList</p>

<p class=BoxedCode>);</p>

</div>

<p class=MsoNormal><b>C_GetFunctionList</b> obtains a pointer to the Cryptoki
library’s list of function pointers.  <i>ppFunctionList</i> points to a value
which will receive a pointer to the library’s <b>CK_FUNCTION_LIST</b>
structure, which in turn contains function pointers for all the Cryptoki API
routines in the library.  <i>The pointer thus obtained may point into memory
which is owned by the Cryptoki library, and which may or may not be writable</i>. 
Whether or not this is the case, no attempt should be made to write to this
memory.</p>

<p class=MsoNormal><b>C_GetFunctionList</b> is the only Cryptoki function which
an application may call before calling <b>C_Initialize</b>.  It is provided to
make it easier and faster for applications to use shared Cryptoki libraries and
to use more than one Cryptoki library simultaneously.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_FUNCTION_LIST_PTR pFunctionList;</p>

<p class=BoxedCode>CK_C_Initialize pC_Initialize;</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* It’s OK to call C_GetFunctionList before calling
C_Initialize */</p>

<p class=BoxedCode>rv = C_GetFunctionList(&amp;pFunctionList);</p>

<p class=BoxedCode>assert(rv == CKR_OK);</p>

<p class=BoxedCode>pC_Initialize = pFunctionList -&gt; C_Initialize;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Call the C_Initialize function in the library */</p>

<p class=BoxedCode>rv = (*pC_Initialize)(NULL_PTR);</p>

</div>

<h2><a name="_Toc416959741"></a><a name="_Toc395183814"></a><a
name="_Toc391468818"></a><a name="_Toc370634027"></a><a name="_Toc235002326"></a><a
name="_Toc72656108"></a><a name="_Toc405794718"></a><a name="_Toc385057899">5.5
Slot and token management</a> functions</h2>

<p class=MsoNormal>Cryptoki provides the following functions for slot and token
management:</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002327"></a><a name="_Toc72656109"></a><a name="_Toc405794719"></a><a
name="_Toc385057900"></a><a name="_Toc383864874"></a><a name="_Toc323610867"></a><a
name="_Toc323205437"></a><a name="_Toc323024105"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_GetSlotList</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_GetSlotList)(</p>

<p class=BoxedCode>      CK_BBOOL tokenPresent,</p>

<p class=BoxedCode>      CK_SLOT_ID_PTR pSlotList,</p>

<p class=BoxedCode>      CK_ULONG_PTR pulCount</p>

<p class=BoxedCode>);</p>

</div>

<p class=MsoNormal><b>C_GetSlotList</b> is used to obtain a list of slots in
the system. <i>tokenPresent</i> indicates whether the list obtained includes
only those slots with a token present (CK_TRUE), or all slots (CK_FALSE); <i>pulCount</i>
points to the location that receives the number of slots.</p>

<p class=MsoNormal>There are two ways for an application to call <b>C_GetSlotList</b>:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>If <i>pSlotList</i>
is NULL_PTR, then all that <b>C_GetSlotList</b> does is return (in *<i>pulCount</i>)
the number of slots, without actually returning a list of slots.  The contents
of the buffer pointed to by <i>pulCount</i> on entry to <b>C_GetSlotList</b>
has no meaning in this case, and the call returns the value CKR_OK.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>If <i>pSlotList</i>
is not NULL_PTR, then *<i>pulCount</i> MUST contain the size (in terms of <b>CK_SLOT_ID</b>
elements) of the buffer pointed to by <i>pSlotList</i>.  If that buffer is
large enough to hold the list of slots, then the list is returned in it, and
CKR_OK is returned.  If not, then the call to <b>C_GetSlotList</b> returns the
value CKR_BUFFER_TOO_SMALL.  In either case, the value *<i>pulCount</i> is set
to hold the number of slots.</p>

<p class=MsoNormal>Because <b>C_GetSlotList</b> does not allocate any space of
its own, an application will often call <b>C_GetSlotList</b> twice (or
sometimes even more times—if an application is trying to get a list of all
slots with a token present, then the number of such slots can (unfortunately)
change between when the application asks for how many such slots there are and
when the application asks for the slots themselves).  However, multiple calls
to <b>C_GetSlotList</b> are by no means <i>required</i>.</p>

<p class=MsoNormal><span style='color:black'>All slots which <b>C_GetSlotList</b>
reports MUST be able to be queried as valid slots by <b>C_GetSlotInfo</b>. 
Furthermore, the set of slots accessible through a Cryptoki library is checked
at the time that <b>C_GetSlotList,</b> for list length prediction (NULL
pSlotList argument) is called. If an application calls <b>C_GetSlotList</b>
with a non-NULL pSlotList, and <i>then</i> the user adds or removes a hardware
device, the changed slot list will only be visible and effective if <b>C_GetSlotList</b>
is called again with NULL. Even if <b>C_ GetSlotList</b> is successfully called
this way, it may or may not be the case that the changed slot list will be
successfully recognized depending on the library implementation.  On some
platforms, or earlier PKCS11 compliant libraries, it may be necessary to
successfully call <b>C_Initialize</b> or to restart the entire system.</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR,
CKR_HOST_MEMORY, CKR_OK.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_ULONG ulSlotCount, ulSlotWithTokenCount;</p>

<p class=BoxedCode>CK_SLOT_ID_PTR pSlotList, pSlotWithTokenList;</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Get list of all slots */</p>

<p class=BoxedCode>rv = C_GetSlotList(CK_FALSE, NULL_PTR, &amp;ulSlotCount);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  pSlotList =</p>

<p class=BoxedCode>    (CK_SLOT_ID_PTR) malloc(ulSlotCount*sizeof(CK_SLOT_ID));</p>

<p class=BoxedCode>  rv = C_GetSlotList(CK_FALSE, pSlotList, &amp;ulSlotCount);</p>

<p class=BoxedCode>  if (rv == CKR_OK) {</p>

<p class=BoxedCode>    /* Now use that list of all slots */</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>  }</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>  free(pSlotList);</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Get list of all slots with a token present */</p>

<p class=BoxedCode>pSlotWithTokenList = (CK_SLOT_ID_PTR) malloc(0);</p>

<p class=BoxedCode>ulSlotWithTokenCount = 0;</p>

<p class=BoxedCode>while (1) {</p>

<p class=BoxedCode>  rv = C_GetSlotList(</p>

<p class=BoxedCode>    CK_TRUE, pSlotWithTokenList, ulSlotWithTokenCount);</p>

<p class=BoxedCode>  if (rv != CKR_BUFFER_TOO_SMALL)</p>

<p class=BoxedCode>    break;</p>

<p class=BoxedCode>  pSlotWithTokenList = realloc(</p>

<p class=BoxedCode>    pSlotWithTokenList,</p>

<p class=BoxedCode>    ulSlotWithTokenList*sizeof(CK_SLOT_ID));</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  /* Now use that list of all slots with a token present */</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>free(pSlotWithTokenList);</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002328"></a><a name="_Toc72656110"></a><a name="_Toc405794720"></a><a
name="_Toc385057901"></a><a name="_Toc383864875"></a><a name="_Toc323610868"></a><a
name="_Toc323205438"></a><a name="_Toc323024106"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_GetSlotInfo</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_GetSlotInfo)(</p>

<p class=BoxedCode>      CK_SLOT_ID slotID,</p>

<p class=BoxedCode>      CK_SLOT_INFO_PTR pInfo</p>

<p class=BoxedCode>);</p>

</div>

<p class=MsoNormal><b>C_GetSlotInfo</b> obtains information about a particular
slot in the system. <i>slotID</i> is the ID of the slot; <i>pInfo</i> points to
the location that receives the slot information.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK, CKR_SLOT_ID_INVALID.</p>

<p class=MsoNormal>Example: see <b>C_GetTokenInfo.</b></p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002329"></a><a name="_Toc72656111"></a><a name="_Toc405794721"></a><a
name="_Toc385057902"></a><a name="_Toc383864876"></a><a name="_Toc323610869"></a><a
name="_Toc323205439"></a><a name="_Toc323024107"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_GetTokenInfo</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_GetTokenInfo)(</p>

<p class=BoxedCode>      CK_SLOT_ID slotID,</p>

<p class=BoxedCode>      CK_TOKEN_INFO_PTR pInfo</p>

<p class=BoxedCode>);</p>

</div>

<p class=MsoNormal><b>C_GetTokenInfo</b> obtains information about a particular
token in the system.  <i>slotID</i> is the ID of the token’s slot; <i>pInfo</i>
points to the location that receives the token information.</p>

<p class=MsoNormal>Return values: CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK, CKR_SLOT_ID_INVALID,
CKR_TOKEN_NOT_PRESENT, CKR_TOKEN_NOT_RECOGNIZED, CKR_ARGUMENTS_BAD.</p>

<p class=MsoNormal><span style='font-size:12.0pt'>Example:</span></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_ULONG ulCount;</p>

<p class=BoxedCode>CK_SLOT_ID_PTR pSlotList;</p>

<p class=BoxedCode>CK_SLOT_INFO slotInfo;</p>

<p class=BoxedCode>CK_TOKEN_INFO tokenInfo;</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>rv = C_GetSlotList(CK_FALSE, NULL_PTR, &amp;ulCount);</p>

<p class=BoxedCode>if ((rv == CKR_OK) &amp;&amp; (ulCount &gt; 0)) {</p>

<p class=BoxedCode>  pSlotList = (CK_SLOT_ID_PTR)
malloc(ulCount*sizeof(CK_SLOT_ID));</p>

<p class=BoxedCode>  rv = C_GetSlotList(CK_FALSE, pSlotList, &amp;ulCount);</p>

<p class=BoxedCode>  assert(rv == CKR_OK);</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>  /* Get slot information for first slot */</p>

<p class=BoxedCode>  rv = C_GetSlotInfo(pSlotList[0], &amp;slotInfo);</p>

<p class=BoxedCode>  assert(rv == CKR_OK);</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>  /* Get token information for first slot */</p>

<p class=BoxedCode>  rv = C_GetTokenInfo(pSlotList[0], &amp;tokenInfo);</p>

<p class=BoxedCode>  if (rv == CKR_TOKEN_NOT_PRESENT) {</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>  }</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  free(pSlotList);</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc385057903"></a><a name="_Toc383864877"></a><a name="_Toc323610870"></a><a
name="_Toc323205440"></a><a name="_Toc323024108"></a><a name="_Toc235002330"></a><a
name="_Toc72656112"></a><a name="_Toc405794722"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_WaitForSlotEvent</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_WaitForSlotEvent)(</p>

<p class=BoxedCode>      CK_FLAGS flags,</p>

<p class=BoxedCode>      CK_SLOT_ID_PTR pSlot,</p>

<p class=BoxedCode>      CK_VOID_PTR pReserved</p>

<p class=BoxedCode>);</p>

</div>

<p class=MsoNormal><b>C_WaitForSlotEvent</b> waits for a slot event, such as
token insertion or token removal, to occur.  <i>flags</i> determines whether or
not the <b>C_WaitForSlotEvent</b> call blocks (<i>i.e.</i>, waits for a slot
event to occur); <i>pSlot</i> points to a location which will receive the ID of
the slot that the event occurred in.  <i>pReserved</i> is reserved for future
versions; for this version of Cryptoki, it should be NULL_PTR.</p>

<p class=MsoNormal>At present, the only flag defined for use in the <i>flags</i>
argument is <b>CKF_DONT_BLOCK</b>:</p>

<p class=MsoNormal>Internally, each Cryptoki application has a flag for each
slot which is used to track whether or not any unrecognized events involving
that slot have occurred.  When an application initially calls <b>C_Initialize</b>,
every slot’s event flag is cleared.  Whenever a slot event occurs, the flag
corresponding to the slot in which the event occurred is set.</p>

<p class=MsoNormal>If <b>C_WaitForSlotEvent</b> is called with the <b>CKF_DONT_BLOCK</b>
flag set in the <i>flags</i> argument, and some slot’s event flag is set, then
that event flag is cleared, and the call returns with the ID of that slot in
the location pointed to by <i>pSlot</i>.  If more than one slot’s event flag is
set at the time of the call, one such slot is chosen by the library to have its
event flag cleared and to have its slot ID returned.</p>

<p class=MsoNormal>If <b>C_WaitForSlotEvent</b> is called with the <b>CKF_DONT_BLOCK</b>
flag set in the <i>flags</i> argument, and no slot’s event flag is set, then
the call returns with the value CKR_NO_EVENT.  In this case, the contents of
the location pointed to by <i>pSlot</i> when <b>C_WaitForSlotEvent</b> are
undefined.</p>

<p class=MsoNormal>If <b>C_WaitForSlotEvent</b> is called with the <b>CKF_DONT_BLOCK</b>
flag clear in the <i>flags</i> argument, then the call behaves as above, except
that it will block.  That is, if no slot’s event flag is set at the time of the
call, <b>C_WaitForSlotEvent</b> will wait until some slot’s event flag becomes
set.  If a thread of an application has a <b>C_WaitForSlotEvent</b> call
blocking when another thread of that application calls <b>C_Finalize</b>, the <b>C_WaitForSlotEvent</b>
call returns with the value CKR_CRYPTOKI_NOT_INITIALIZED.</p>

<p class=MsoNormal><i>Although the parameters supplied to <b>C_Initialize</b>
can in general allow for safe multi-threaded access to a Cryptoki library, <b>C_WaitForSlotEvent</b>
is exceptional in that the behavior of Cryptoki is undefined if multiple
threads of a single application make simultaneous calls to <b>C_WaitForSlotEvent</b>.</i></p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR,
CKR_HOST_MEMORY, CKR_NO_EVENT, CKR_OK.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_FLAGS flags = 0;</p>

<p class=BoxedCode>CK_SLOT_ID slotID;</p>

<p class=BoxedCode>CK_SLOT_INFO slotInfo;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>/* Block and wait for a slot event */</p>

<p class=BoxedCode>rv = C_WaitForSlotEvent(flags, &amp;slotID, NULL_PTR);</p>

<p class=BoxedCode>assert(rv == CKR_OK);</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* See what’s up with that slot */</p>

<p class=BoxedCode>rv = C_GetSlotInfo(slotID, &amp;slotInfo);</p>

<p class=BoxedCode>assert(rv == CKR_OK);</p>

<p class=BoxedCode>&nbsp;</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002331"></a><a name="_Toc72656113"></a><a name="_Toc405794723"><span
style='font-family:Symbol;font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_GetMechanismList</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_GetMechanismList)(</p>

<p class=BoxedCode>      CK_SLOT_ID slotID,</p>

<p class=BoxedCode>      CK_MECHANISM_TYPE_PTR pMechanismList,</p>

<p class=BoxedCode>      CK_ULONG_PTR pulCount</p>

<p class=BoxedCode>);</p>

</div>

<p class=MsoNormal><b>C_GetMechanismList</b> is used to obtain a list of
mechanism types supported by a token.  <i>SlotID</i> is the ID of the token’s
slot; <i>pulCount</i> points to the location that receives the number of
mechanisms.</p>

<p class=MsoNormal>There are two ways for an application to call <b>C_GetMechanismList</b>:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>If <i>pMechanismList</i>
is NULL_PTR, then all that <b>C_GetMechanismList</b> does is return (in *<i>pulCount</i>)
the number of mechanisms, without actually returning a list of mechanisms.  The
contents of *<i>pulCount</i> on entry to <b>C_GetMechanismList</b> has no
meaning in this case, and the call returns the value CKR_OK.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>If <i>pMechanismList</i>
is not NULL_PTR, then *<i>pulCount</i> MUST contain the size (in terms of <b>CK_MECHANISM_TYPE</b>
elements) of the buffer pointed to by <i>pMechanismList</i>.  If that buffer is
large enough to hold the list of mechanisms, then the list is returned in it,
and CKR_OK is returned.  If not, then the call to <b>C_GetMechanismList</b>
returns the value CKR_BUFFER_TOO_SMALL.  In either case, the value *<i>pulCount</i>
is set to hold the number of mechanisms.</p>

<p class=MsoNormal>Because <b>C_GetMechanismList</b> does not allocate any
space of its own, an application will often call <b>C_GetMechanismList</b>
twice.  However, this behavior is by no means required.</p>

<p class=MsoNormal>Return values: CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY,
CKR_OK, CKR_SLOT_ID_INVALID, CKR_TOKEN_NOT_PRESENT, CKR_TOKEN_NOT_RECOGNIZED,
CKR_ARGUMENTS_BAD.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SLOT_ID slotID;</p>

<p class=BoxedCode>CK_ULONG ulCount;</p>

<p class=BoxedCode>CK_MECHANISM_TYPE_PTR pMechanismList;</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>rv = C_GetMechanismList(slotID, NULL_PTR, &amp;ulCount);</p>

<p class=BoxedCode>if ((rv == CKR_OK) &amp;&amp; (ulCount &gt; 0)) {</p>

<p class=BoxedCode>  pMechanismList =</p>

<p class=BoxedCode>    (CK_MECHANISM_TYPE_PTR)</p>

<p class=BoxedCode>    malloc(ulCount*sizeof(CK_MECHANISM_TYPE));</p>

<p class=BoxedCode>  rv = C_GetMechanismList(slotID, pMechanismList,
&amp;ulCount);</p>

<p class=BoxedCode>  if (rv == CKR_OK) {</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>  }</p>

<p class=BoxedCode>  free(pMechanismList);</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002332"></a><a name="_Toc72656114"></a><a name="_Toc405794724"></a><a
name="_Toc385057904"></a><a name="_Toc383864878"></a><a name="_Toc323610871"></a><a
name="_Toc323205441"></a><a name="_Toc323024109"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_GetMechanismInfo</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_GetMechanismInfo)(</p>

<p class=BoxedCode>      CK_SLOT_ID slotID,</p>

<p class=BoxedCode>      CK_MECHANISM_TYPE type,</p>

<p class=BoxedCode>      CK_MECHANISM_INFO_PTR pInfo</p>

<p class=BoxedCode>);</p>

</div>

<p class=MsoNormal><b>C_GetMechanismInfo</b> obtains information about a
particular mechanism possibly supported by a token. <i>slotID</i> is the ID of
the token’s slot; <i>type</i> is the type of mechanism; <i>pInfo</i> points to
the location that receives the mechanism information.</p>

<p class=MsoNormal>Return values: CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_MECHANISM_INVALID, CKR_OK,
CKR_SLOT_ID_INVALID, CKR_TOKEN_NOT_PRESENT, CKR_TOKEN_NOT_RECOGNIZED,
CKR_ARGUMENTS_BAD.</p>

<p class=MsoNormal><span style='font-size:12.0pt'>Example:</span></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SLOT_ID slotID;</p>

<p class=BoxedCode>CK_MECHANISM_INFO info;</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>/* Get information about the CKM_MD2 mechanism for this
token */</p>

<p class=BoxedCode>rv = C_GetMechanismInfo(slotID, CKM_MD2, &amp;info);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  if (info.flags &amp; CKF_DIGEST) {</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>  }</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002333"></a><a name="_Toc72656115"></a><a name="_Toc405794725"></a><a
name="_Toc385057905"></a><a name="_Toc383864879"></a><a name="_Toc323610872"></a><a
name="_Toc323205442"></a><a name="_Toc323024110"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_InitToken</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_InitToken)(</p>

<p class=BoxedCode>      CK_SLOT_ID slotID,</p>

<p class=BoxedCode>      CK_UTF8CHAR_PTR pPin,</p>

<p class=BoxedCode>      CK_ULONG ulPinLen,</p>

<p class=BoxedCode>      CK_UTF8CHAR_PTR pLabel</p>

<p class=BoxedCode>);</p>

</div>

<p class=MsoNormal><b>C_InitToken</b> initializes a token. <i>slotID</i> is the
ID of the token’s slot; <i>pPin</i> points to the SO’s initial PIN (which need <i>not</i>
be null-terminated); <i>ulPinLen</i> is the length in bytes of the PIN; <i>pLabel</i>
points to the 32-byte label of the token (which MUST be padded with blank
characters, and which MUST <i>not</i> be null-terminated). This standard allows
PIN values to contain any valid UTF8 character, but the token may impose subset
restrictions.</p>

<p class=MsoNormal>If the token has not been initialized (i.e. new from the
factory), then the <i>pPin </i>parameter becomes the initial value of the SO
PIN. If the token is being reinitialized, the <i>pPin</i> parameter is checked
against the existing SO PIN to authorize the initialization operation. In both
cases, the SO PIN is the value <i>pPin</i> after the function completes
successfully. If the SO PIN is lost, then the card MUST be reinitialized using
a mechanism outside the scope of this standard. The <b>CKF_TOKEN_INITIALIZED </b>flag
in the <b>CK_TOKEN_INFO</b> structure indicates the action that will result
from calling <b>C_InitToken</b>. If set, the token will be reinitialized, and
the client MUST supply the existing SO password in <i>pPin</i>.</p>

<p class=MsoNormal>When a token is initialized, all objects that can be
destroyed are destroyed (<i>i.e.</i>, all except for “indestructible” objects
such as keys built into the token).  Also, access by the normal user is
disabled until the SO sets the normal user’s PIN.  Depending on the token, some
“default” objects may be created, and attributes of some objects may be set to
default values.</p>

<p class=MsoNormal>If the token has a “protected authentication path”, as
indicated by the <b>CKF_PROTECTED_AUTHENTICATION_PATH</b> flag in its <b>CK_TOKEN_INFO</b>
being set, then that means that there is some way for a user to be
authenticated to the token without having the application send a PIN through
the Cryptoki library.  One such possibility is that the user enters a PIN on a
PINpad on the token itself, or on the slot device.  To initialize a token with
such a protected authentication path, the <i>pPin</i> parameter to <b>C_InitToken</b>
should be NULL_PTR.  During the execution of <b>C_InitToken</b>, the SO’s PIN
will be entered through the protected authentication path.</p>

<p class=MsoNormal>If the token has a protected authentication path other than
a PINpad, then it is token-dependent whether or not <b>C_InitToken</b> can be
used to initialize the token.</p>

<p class=MsoNormal>A token cannot be initialized if Cryptoki detects that <i>any</i>
application has an open session with it; when a call to <b>C_InitToken</b> is
made under such circumstances, the call fails with error CKR_SESSION_EXISTS. 
Unfortunately, it may happen when <b>C_InitToken</b> is called that some other
application <i>does</i> have an open session with the token, but Cryptoki
cannot detect this, because it cannot detect anything about other applications
using the token.  If this is the case, then the consequences of the <b>C_InitToken</b>
call are undefined.</p>

<p class=MsoNormal>The <b>C_InitToken</b> function may not be sufficient to
properly initialize complex tokens. In these situations, an initialization
mechanism outside the scope of Cryptoki MUST be employed. The definition of
“complex token” is product specific.</p>

<p class=MsoNormal>Return values: CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK,
CKR_PIN_INCORRECT, CKR_PIN_LOCKED, CKR_SESSION_EXISTS, CKR_SLOT_ID_INVALID,
CKR_TOKEN_NOT_PRESENT, CKR_TOKEN_NOT_RECOGNIZED, CKR_TOKEN_WRITE_PROTECTED,
CKR_ARGUMENTS_BAD.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SLOT_ID slotID;</p>

<p class=BoxedCode>CK_UTF8CHAR_PTR pin = “MyPIN”;</p>

<p class=BoxedCode>CK_UTF8CHAR label[32];</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>memset(label, ‘ ’, sizeof(label));</p>

<p class=BoxedCode>memcpy(label, “My first token”, strlen(“My first token”));</p>

<p class=BoxedCode>rv = C_InitToken(slotID, pin, strlen(pin), label);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002334"></a><a name="_Toc72656116"></a><a name="_Toc405794726"></a><a
name="_Toc385057906"></a><a name="_Toc383864880"></a><a name="_Toc323610873"></a><a
name="_Toc323205443"></a><a name="_Toc323024111"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_InitPIN</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_InitPIN)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_UTF8CHAR_PTR pPin,<br>
  CK_ULONG ulPinLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_InitPIN</b> initializes the normal user’s PIN.  <i>hSession</i>
is the session’s handle; <i>pPin</i> points to the normal user’s PIN;<i>
ulPinLen</i> is the length in bytes of the PIN. This standard allows PIN values
to contain any valid UTF8 character, but the token may impose subset
restrictions.</p>

<p class=MsoNormal><b>C_InitPIN</b> can only be called in the “R/W SO
Functions” state.  An attempt to call it from a session in any other state
fails with error CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>If the token has a “protected authentication path”, as
indicated by the CKF_PROTECTED_AUTHENTICATION_PATH flag in its <b>CK_TOKEN_INFO</b>
being set, then that means that there is some way for a user to be
authenticated to the token without having to send a PIN through the Cryptoki
library.  One such possibility is that the user enters a PIN on a PIN pad on
the token itself, or on the slot device.  To initialize the normal user’s PIN
on a token with such a protected authentication path, the <i>pPin</i> parameter
to <b>C_InitPIN</b> should be NULL_PTR.  During the execution of <b>C_InitPIN</b>,
the SO will enter the new PIN through the protected authentication path.</p>

<p class=MsoNormal>If the token has a protected authentication path other than
a PIN pad, then it is token-dependent whether or not <b>C_InitPIN</b> can be
used to initialize the normal user’s token access.</p>

<p class=MsoNormal>Return values: CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK,
CKR_PIN_INVALID, CKR_PIN_LEN_RANGE, CKR_SESSION_CLOSED, CKR_SESSION_READ_ONLY,
CKR_SESSION_HANDLE_INVALID, CKR_TOKEN_WRITE_PROTECTED, CKR_USER_NOT_LOGGED_IN,
CKR_ARGUMENTS_BAD.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_UTF8CHAR newPin[]= {“NewPIN”};</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>rv = C_InitPIN(hSession, newPin, sizeof(newPin)-1);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002335"></a><a name="_Toc72656117"></a><a name="_Toc405794727"></a><a
name="_Toc385057907"></a><a name="_Toc383864881"></a><a name="_Toc323610874"></a><a
name="_Toc323205444"></a><a name="_Toc323024112"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_SetPIN</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_SetPIN)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_UTF8CHAR_PTR pOldPin,<br>
  CK_ULONG ulOldLen,<br>
  CK_UTF8CHAR_PTR pNewPin,<br>
  CK_ULONG ulNewLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_SetPIN</b> modifies the PIN of the user that is
currently logged in, or the CKU_USER PIN if the session is not logged in.  <i>hSession</i>
is the session’s handle; <i>pOldPin</i> points to the old PIN; <i>ulOldLen</i>
is the length in bytes of the old PIN;<i> pNewPin</i> points to the new PIN; <i>ulNewLen</i>
is the length in bytes of the new PIN. This standard allows PIN values to
contain any valid UTF8 character, but the token may impose subset restrictions.</p>

<p class=MsoNormal><b>C_SetPIN</b> can only be called in the “R/W Public
Session” state, “R/W SO Functions” state, or “R/W User Functions” state.  An
attempt to call it from a session in any other state fails with error
CKR_SESSION_READ_ONLY.</p>

<p class=MsoNormal>If the token has a “protected authentication path”, as
indicated by the CKF_PROTECTED_AUTHENTICATION_PATH flag in its <b>CK_TOKEN_INFO</b>
being set, then that means that there is some way for a user to be
authenticated to the token without having to send a PIN through the Cryptoki
library.  One such possibility is that the user enters a PIN on a PIN pad on
the token itself, or on the slot device.  To modify the current user’s PIN on a
token with such a protected authentication path, the <i>pOldPin</i> and <i>pNewPin</i>
parameters to <b>C_SetPIN</b> should be NULL_PTR.  During the execution of <b>C_SetPIN</b>,
the current user will enter the old PIN and the new PIN through the protected
authentication path.  It is not specified how the PIN pad should be used to
enter <i>two</i> PINs; this varies.</p>

<p class=MsoNormal>If the token has a protected authentication path other than
a PIN pad, then it is token-dependent whether or not <b>C_SetPIN</b> can be
used to modify the current user’s PIN.</p>

<p class=MsoNormal>Return values: CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK,
CKR_PIN_INCORRECT, CKR_PIN_INVALID, CKR_PIN_LEN_RANGE, CKR_PIN_LOCKED,
CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID, CKR_SESSION_READ_ONLY,
CKR_TOKEN_WRITE_PROTECTED, CKR_ARGUMENTS_BAD.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_UTF8CHAR oldPin[] = {“OldPIN”};</p>

<p class=BoxedCode>CK_UTF8CHAR newPin[] = {“NewPIN”};</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>rv = C_SetPIN(</p>

<p class=BoxedCode>  hSession, oldPin, sizeof(oldPin)-1, newPin,
sizeof(newPin)-1);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<h2><a name="_Toc416959742"></a><a name="_Toc395183815"></a><a
name="_Toc391468819"></a><a name="_Toc370634028"></a><a name="_Toc235002336"></a><a
name="_Toc72656118"></a><a name="_Toc405794728"></a><a name="_Toc385057908"></a><a
name="_Toc383864882"></a><a name="_Toc323610875"></a><a name="_Toc323205445"></a><a
name="_Toc323024113"></a><a name="_Toc323000709"></a><a name="_Toc322945142"></a><a
name="_Toc322855300"></a><a name="_Toc319315699"></a><a name="_Toc319313706"></a><a
name="_Toc319313513"></a><a name="_Toc319287673">5.6 Session management</a>
functions</h2>

<p class=MsoNormal>A typical application might perform the following series of
steps to make use of a token (note that there are other reasonable sequences of
events that an application might perform):</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Select a
token.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Make one
or more calls to <b>C_OpenSession</b> to obtain one or more sessions with the
token.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Call <b>C_Login</b>
to log the user into the token.  Since all sessions an application has with a
token have a shared login state, <b>C_Login</b> only needs to be called for one
of the sessions.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Perform
cryptographic operations using the sessions with the token.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Call <b>C_CloseSession</b>
once for each session that the application has with the token, or call <b>C_CloseAllSessions</b>
to close all the application’s sessions simultaneously.</p>

<p class=MsoNormal>As has been observed, an application may have concurrent
sessions with more than one token.  It is also possible for a token to have
concurrent sessions with more than one application.</p>

<p class=MsoNormal><a name="_Toc405794729"></a><a name="_Toc385057909"></a><a
name="_Toc383864883"></a><a name="_Toc323610876"></a><a name="_Toc323205446"></a><a
name="_Toc323024114">Cryptoki provides the following functions for session
management:</a></p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002337"></a><a name="_Toc72656119"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_OpenSession</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_OpenSession)(<br>
  CK_SLOT_ID slotID,<br>
  CK_FLAGS flags,<br>
  CK_VOID_PTR pApplication,<br>
  CK_NOTIFY Notify,<br>
  CK_SESSION_HANDLE_PTR phSession<br>
);</p>

</div>

<p class=MsoNormal><b>C_OpenSession</b> opens a session between an application
and a token in a particular slot.  <i>slotID</i> is the slot’s ID; <i>flags</i>
indicates the type of session; <i>pApplication</i> is an application-defined
pointer to be passed to the notification callback; <i>Notify</i> is the address
of the notification callback function (see Section 5.16); <i>phSession</i> points to the location that receives the handle for the new session.</p>

<p class=MsoNormal>When opening a session with <b>C_OpenSession</b>, the <i>flags</i>
parameter consists of the logical OR of zero or more bit flags defined in the <b>CK_SESSION_INFO</b>
data type.  For legacy reasons, the <b>CKF_SERIAL_SESSION</b> bit MUST always
be set; if a call to <b>C_OpenSession</b> does not have this bit set, the call
should return unsuccessfully with the error code
CKR_SESSION_PARALLEL_NOT_SUPPORTED.</p>

<p class=MsoNormal>There may be a limit on the number of concurrent sessions an
application may have with the token, which may depend on whether the session is
“read-only” or “read/write”.  An attempt to open a session which does not
succeed because there are too many existing sessions of some type should return
CKR_SESSION_COUNT.</p>

<p class=MsoNormal>If the token is write-protected (as indicated in the <b>CK_TOKEN_INFO</b>
structure), then only read-only sessions may be opened with it.</p>

<p class=MsoNormal>If the application calling <b>C_OpenSession</b> already has
a R/W SO session open with the token, then any attempt to open a R/O session
with the token fails with error code CKR_SESSION_READ_WRITE_SO_EXISTS (see <b><span
style='color:#3B006F'>[PKCS11-UG] </span></b>for further details).</p>

<p class=MsoNormal>The <i>Notify</i> callback function is used by Cryptoki to
notify the application of certain events.  If the application does not wish to
support callbacks, it should pass a value of NULL_PTR as the <i>Notify</i>
parameter.  See Section 5.16 for more information about application callbacks.</p>

<p class=MsoNormal>Return values: CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK, CKR_SESSION_COUNT,
CKR_SESSION_PARALLEL_NOT_SUPPORTED, CKR_SESSION_READ_WRITE_SO_EXISTS,
CKR_SLOT_ID_INVALID, CKR_TOKEN_NOT_PRESENT, CKR_TOKEN_NOT_RECOGNIZED,
CKR_TOKEN_WRITE_PROTECTED, CKR_ARGUMENTS_BAD.</p>

<p class=MsoNormal>Example: see <b>C_CloseSession</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002338"></a><a name="_Toc72656120"></a><a name="_Toc405794730"></a><a
name="_Toc385057910"></a><a name="_Toc383864884"></a><a name="_Toc323610877"></a><a
name="_Toc323205447"></a><a name="_Toc323024115"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_CloseSession</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_CloseSession)(<br>
  CK_SESSION_HANDLE hSession<br>
);</p>

</div>

<p class=MsoNormal><b>C_CloseSession</b> closes a session between an
application and a token.  <i>hSession</i> is the session’s handle.</p>

<p class=MsoNormal>When a session is closed, all session objects created by the
session are destroyed automatically, even if the application has other sessions
“using” the objects (see <b><span style='color:#3B006F'>[PKCS11-UG] </span></b>for
further details).</p>

<p class=MsoNormal>If this function is successful and it closes the last
session between the application and the token, the login state of the token for
the application returns to public sessions. Any new sessions to the token
opened by the application will be either R/O Public or R/W Public sessions.</p>

<p class=MsoNormal>Depending on the token, when the last open session any
application has with the token is closed, the token may be “ejected” from its
reader (if this capability exists).</p>

<p class=MsoNormal>Despite the fact this <b>C_CloseSession</b> is supposed to
close a session, the return value CKR_SESSION_CLOSED is an <i>error</i>
return.  It actually indicates the (probably somewhat unlikely) event that
while this function call was executing, another call was made to <b>C_CloseSession</b>
to close this particular session, and that call finished executing first.  Such
uses of sessions are a bad idea, and Cryptoki makes little promise of what will
occur in general if an application indulges in this sort of behavior.</p>

<p class=MsoNormal>Return values: CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SLOT_ID slotID;</p>

<p class=BoxedCode>CK_BYTE application;</p>

<p class=BoxedCode>CK_NOTIFY MyNotify;</p>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>application = 17;</p>

<p class=BoxedCode>MyNotify = &amp;EncryptionSessionCallback;</p>

<p class=BoxedCode>rv = C_OpenSession(</p>

<p class=BoxedCode>  slotID, CKF_SERIAL_SESSION | CKF_RW_SESSION,</p>

<p class=BoxedCode>            (CK_VOID_PTR) &amp;application, MyNotify,</p>

<p class=BoxedCode>  &amp;hSession);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  C_CloseSession(hSession);</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002339"></a><a name="_Toc72656121"></a><a name="_Toc405794731"></a><a
name="_Toc385057911"></a><a name="_Toc383864885"></a><a name="_Toc323610878"></a><a
name="_Toc323205448"></a><a name="_Toc323024116"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_CloseAllSessions</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_CloseAllSessions)(<br>
  CK_SLOT_ID slotID<br>
);</p>

</div>

<p class=MsoNormal><b>C_CloseAllSessions</b> closes all sessions an application
has with a token. <i>slotID</i> specifies the token’s slot.</p>

<p class=MsoNormal>When a session is closed, all session objects created by the
session are destroyed automatically.</p>

<p class=MsoNormal>After successful execution of this function, the login state
of the token for the application returns to public sessions. Any new sessions
to the token opened by the application will be either R/O Public or R/W Public
sessions.</p>

<p class=MsoNormal>Depending on the token, when the last open session any
application has with the token is closed, the token may be “ejected” from its
reader (if this capability exists).</p>

<p class=MsoNormal>Return values: CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK, CKR_SLOT_ID_INVALID,
CKR_TOKEN_NOT_PRESENT.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SLOT_ID slotID;</p>

<p class=BoxedCode><span lang=SV>CK_RV rv;</span></p>

<p class=BoxedCode><span lang=SV>&nbsp;</span></p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>rv = C_CloseAllSessions(slotID);</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002340"></a><a name="_Toc72656122"></a><a name="_Toc405794732"></a><a
name="_Toc385057912"></a><a name="_Toc383864886"></a><a name="_Toc323610879"></a><a
name="_Toc323205449"></a><a name="_Toc323024117"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_GetSessionInfo</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_GetSessionInfo)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_SESSION_INFO_PTR pInfo<br>
);</p>

</div>

<p class=MsoNormal><b>C_GetSessionInfo</b> obtains information about a
session.  <i>hSession</i> is the session’s handle; <i>pInfo</i> points to the
location that receives the session information.</p>

<p class=MsoNormal>Return values: CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_ARGUMENTS_BAD.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode><span lang=IT>CK_SESSION_INFO info;</span></p>

<p class=BoxedCode><span lang=IT>CK_RV rv;</span></p>

<p class=BoxedCode><span lang=IT>&nbsp;</span></p>

<p class=BoxedCode><span lang=IT>.</span></p>

<p class=BoxedCode><span lang=IT>.</span></p>

<p class=BoxedCode><span lang=IT>rv = C_GetSessionInfo(hSession, &amp;info);</span></p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  if (info.state == CKS_RW_USER_FUNCTIONS) {</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>  }</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002341"></a><a name="_Toc72656123"></a><a name="_Toc405794733"></a><a
name="_Toc385057913"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>C_GetOperationState</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_GetOperationState)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pOperationState,<br>
  CK_ULONG_PTR pulOperationStateLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_GetOperationState</b> obtains a copy of the
cryptographic operations state of a session, encoded as a string of bytes.  <i>hSession</i>
is the session’s handle; <i>pOperationState</i> points to the location that
receives the state; <i>pulOperationStateLen</i> points to the location that receives
the length in bytes of the state.</p>

<p class=MsoNormal>Although the saved state output by <b>C_GetOperationState</b>
is not really produced by a “cryptographic mechanism”, <b>C_GetOperationState</b>
nonetheless uses the convention described in Section 5.2 on producing output.</p>

<p class=MsoNormal>Precisely what the “cryptographic operations state” this
function saves is varies from token to token; however, this state is what is
provided as input to <b>C_SetOperationState</b> to restore the cryptographic
activities of a session.</p>

<p class=MsoNormal>Consider a session which is performing a message digest
operation using SHA-1 (<i>i.e.</i>, the session is using the <b>CKM_SHA_1</b>
mechanism).  Suppose that the message digest operation was initialized
properly, and that precisely 80 bytes of data have been supplied so far as
input to SHA-1.  The application now wants to “save the state” of this digest
operation, so that it can continue it later.  In this particular case, since
SHA-1 processes 512 bits (64 bytes) of input at a time, the cryptographic
operations state of the session most likely consists of three distinct parts:
the state of SHA-1’s 160-bit internal chaining variable; the 16 bytes of
unprocessed input data; and some administrative data indicating that this saved
state comes from a session which was performing SHA-1 hashing.  Taken together,
these three pieces of information suffice to continue the current hashing
operation at a later time.</p>

<p class=MsoNormal>Consider next a session which is performing an encryption
operation with DES (a block cipher with a block size of 64 bits) in CBC
(cipher-block chaining) mode (<i>i.e.</i>, the session is using the <b>CKM_DES_CBC</b>
mechanism).  Suppose that precisely 22 bytes of data (in addition to an IV for
the CBC mode) have been supplied so far as input to DES, which means that the
first two 8-byte blocks of ciphertext have already been produced and output. 
In this case, the cryptographic operations state of the session most likely
consists of three or four distinct parts: the second 8-byte block of ciphertext
(this will be used for cipher-block chaining to produce the next block of
ciphertext); the 6 bytes of data still awaiting encryption; some administrative
data indicating that this saved state comes from a session which was performing
DES encryption in CBC mode; and possibly the DES key being used for encryption
(see <b>C_SetOperationState</b> for more information on whether or not the key
is present in the saved state).</p>

<p class=MsoNormal>If a session is performing two cryptographic operations
simultaneously (see Section 5.12), then the cryptographic operations state of
the session will contain all the necessary information to restore both
operations.</p>

<p class=MsoNormal>An attempt to save the cryptographic operations state of a
session which does not currently have some active savable cryptographic
operation(s) (encryption, decryption, digesting, signing without message
recovery, verification without message recovery, or some legal combination of
two of these) should fail with the error CKR_OPERATION_NOT_INITIALIZED.</p>

<p class=MsoNormal>An attempt to save the cryptographic operations state of a
session which is performing an appropriate cryptographic operation (or two),
but which cannot be satisfied for any of various reasons (certain necessary
state information and/or key information can’t leave the token, for example)
should fail with the error CKR_STATE_UNSAVEABLE.</p>

<p class=MsoNormal>Return values: CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY,
CKR_OK, CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_STATE_UNSAVEABLE, CKR_ARGUMENTS_BAD.</p>

<p class=MsoNormal>Example: see <b>C_SetOperationState</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002342"></a><a name="_Toc72656124"></a><a name="_Toc405794734"></a><a
name="_Toc385057914"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>C_SetOperationState</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_SetOperationState)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pOperationState,<br>
  CK_ULONG ulOperationStateLen,<br>
  CK_OBJECT_HANDLE hEncryptionKey,<br>
  CK_OBJECT_HANDLE hAuthenticationKey<br>
);</p>

</div>

<p class=MsoNormal><a name="_Toc383864887"></a><a name="_Toc323610880"></a><a
name="_Toc323205450"></a><a name="_Toc323024118"><b>C_SetOperationState</b>
restores the cryptographic operations state of a session from a string of bytes
obtained with <b>C_GetOperationState</b>.  <i>hSession</i> is the session’s
handle; <i>pOperationState</i> points to the location holding the saved state; <i>ulOperationStateLen</i>
holds the length of the saved state; <i>hEncryptionKey</i> holds a handle to
the key which will be used for an ongoing encryption or decryption operation in
the restored session (or 0 if no encryption or decryption key is needed, either
because no such operation is ongoing in the stored session or because all the
necessary key information is present in the saved state); <i>hAuthenticationKey</i>
holds a handle to the key which will be used for an ongoing signature, MACing,
or verification operation in the restored session (or 0 if no such key is
needed, either because no such operation is ongoing in the stored session or
because all the necessary key information is present in the saved state).</a></p>

<p class=MsoNormal>The state need not have been obtained from the same session
(the “source session”) as it is being restored to (the “destination session”). 
However, the source session and destination session should have a common
session state (<i>e.g.</i>, CKS_RW_USER_FUNCTIONS), and should be with a common
token.  There is also no guarantee that cryptographic operations state may be
carried across logins, or across different Cryptoki implementations.</p>

<p class=MsoNormal>If <b>C_SetOperationState</b> is supplied with alleged saved
cryptographic operations state which it can determine is not valid saved state
(or is cryptographic operations state from a session with a different session
state, or is cryptographic operations state from a different token), it fails with
the error CKR_SAVED_STATE_INVALID.</p>

<p class=MsoNormal>Saved state obtained from calls to <b>C_GetOperationState</b>
may or may not contain information about keys in use for ongoing cryptographic
operations.  If a saved cryptographic operations state has an ongoing
encryption or decryption operation, and the key in use for the operation is not
saved in the state, then it MUST be supplied to <b>C_SetOperationState</b> in
the <i>hEncryptionKey</i> argument.  If it is not, then <b>C_SetOperationState</b>
will fail and return the error CKR_KEY_NEEDED.  If the key in use for the
operation <i>is</i> saved in the state, then it <i>can</i> be supplied in the <i>hEncryptionKey</i>
argument, but this is not required.</p>

<p class=MsoNormal>Similarly, if a saved cryptographic operations state has an
ongoing signature, MACing, or verification operation, and the key in use for
the operation is not saved in the state, then it MUST be supplied to <b>C_SetOperationState</b>
in the <i>hAuthenticationKey</i> argument.  If it is not, then <b>C_SetOperationState</b>
will fail with the error CKR_KEY_NEEDED.  If the key in use for the operation <i>is</i>
saved in the state, then it <i>can</i> be supplied in the <i>hAuthenticationKey</i>
argument, but this is not required.</p>

<p class=MsoNormal>If an <i>irrelevant</i> key is supplied to <b>C_SetOperationState</b>
call (<i>e.g.</i>, a nonzero key handle is submitted in the <i>hEncryptionKey</i>
argument, but the saved cryptographic operations state supplied does not have
an ongoing encryption or decryption operation, then <b>C_SetOperationState</b>
fails with the error CKR_KEY_NOT_NEEDED.</p>

<p class=MsoNormal>If a key is supplied as an argument to <b>C_SetOperationState</b>,
and <b>C_SetOperationState</b> can somehow detect that this key was not the key
being used in the source session for the supplied cryptographic operations
state (it may be able to detect this if the key or a hash of the key is present
in the saved state, for example), then <b>C_SetOperationState</b> fails with
the error CKR_KEY_CHANGED.</p>

<p class=MsoNormal>An application can look at the <b>CKF_RESTORE_KEY_NOT_NEEDED</b>
flag in the flags field of the <b>CK_TOKEN_INFO</b> field for a token to
determine whether or not it needs to supply key handles to <b>C_SetOperationState</b>
calls.  If this flag is true, then a call to <b>C_SetOperationState</b> <i>never</i>
needs a key handle to be supplied to it.  If this flag is false, then at least
some of the time, <b>C_SetOperationState</b> requires a key handle, and so the
application should probably <i>always</i> pass in any relevant key handles when
restoring cryptographic operations state to a session.</p>

<p class=MsoNormal><b>C_SetOperationState</b> can successfully restore
cryptographic operations state to a session even if that session has active
cryptographic or object search operations when <b>C_SetOperationState</b> is
called (the ongoing operations are abruptly cancelled).</p>

<p class=MsoNormal>Return values: CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_KEY_CHANGED, CKR_KEY_NEEDED,
CKR_KEY_NOT_NEEDED, CKR_OK, CKR_SAVED_STATE_INVALID, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_ARGUMENTS_BAD.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_MECHANISM digestMechanism;</p>

<p class=BoxedCode>CK_ULONG ulStateLen;</p>

<p class=BoxedCode>CK_BYTE data1[] = {0x01, 0x03, 0x05, 0x07};</p>

<p class=BoxedCode>CK_BYTE data2[] = {0x02, 0x04, 0x08};</p>

<p class=BoxedCode><span lang=IT>CK_BYTE data3[] = {0x10, 0x0F, 0x0E, 0x0D,
0x0C};</span></p>

<p class=BoxedCode><span lang=SV>CK_BYTE pDigest[20];</span></p>

<p class=BoxedCode><span lang=SV>CK_ULONG ulDigestLen;</span></p>

<p class=BoxedCode><span lang=SV>CK_RV rv;</span></p>

<p class=BoxedCode><span lang=SV>&nbsp;</span></p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>/* Initialize hash operation */</p>

<p class=BoxedCode><span lang=DE-CH>rv = C_DigestInit(hSession,
&amp;digestMechanism);</span></p>

<p class=BoxedCode>assert(rv == CKR_OK);</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Start hashing */</p>

<p class=BoxedCode>rv = C_DigestUpdate(hSession, data1, sizeof(data1));</p>

<p class=BoxedCode>assert(rv == CKR_OK);</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Find out how big the state might be */</p>

<p class=BoxedCode>rv = C_GetOperationState(hSession, NULL_PTR,
&amp;ulStateLen);</p>

<p class=BoxedCode>assert(rv == CKR_OK);</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Allocate some memory and then get the state */</p>

<p class=BoxedCode>pState = (CK_BYTE_PTR) malloc(ulStateLen);</p>

<p class=BoxedCode>rv = C_GetOperationState(hSession, pState, &amp;ulStateLen);</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Continue hashing */</p>

<p class=BoxedCode>rv = C_DigestUpdate(hSession, data2, sizeof(data2));</p>

<p class=BoxedCode>assert(rv == CKR_OK);</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Restore state.  No key handles needed */</p>

<p class=BoxedCode>rv = C_SetOperationState(hSession, pState, ulStateLen, 0,
0);</p>

<p class=BoxedCode>assert(rv == CKR_OK);</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Continue hashing from where we saved state */</p>

<p class=BoxedCode>rv = C_DigestUpdate(hSession, data3, sizeof(data3));</p>

<p class=BoxedCode>assert(rv == CKR_OK);</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Conclude hashing operation */</p>

<p class=BoxedCode>ulDigestLen = sizeof(pDigest);</p>

<p class=BoxedCode><span lang=DE>rv = C_DigestFinal(hSession, pDigest,
&amp;ulDigestLen);</span></p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  /* pDigest[] now contains the hash of 0x01030507100F0E0D0C
*/</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002343"></a><a name="_Toc72656125"></a><a name="_Toc405794735"></a><a
name="_Toc385057915"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>C_Login</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_Login)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_USER_TYPE userType,<br>
  CK_UTF8CHAR_PTR pPin,<br>
  CK_ULONG ulPinLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_Login</b> logs a user into a token.  <i>hSession</i> is
a session handle; <i>userType</i> is the user type; <i>pPin</i> points to the
user’s PIN;<i> ulPinLen</i> is the length of the PIN. This standard allows PIN
values to contain any valid UTF8 character, but the token may impose subset
restrictions.</p>

<p class=MsoNormal>When the user type is either CKU_SO or CKU_USER, if the call
succeeds, each of the application's sessions will enter either the &quot;R/W SO
Functions&quot; state, the &quot;R/W User Functions&quot; state, or the
&quot;R/O User Functions&quot; state. If the user type is CKU_CONTEXT_SPECIFIC
, the behavior of C_Login depends on the context in which it is called.
Improper use of this user type will result in a return value 
CKR_OPERATION_NOT_INITIALIZED..</p>

<p class=MsoNormal>If the token has a “protected authentication path”, as
indicated by the <b>CKF_PROTECTED_AUTHENTICATION_PATH</b> flag in its <b>CK_TOKEN_INFO</b>
being set, then that means that there is some way for a user to be
authenticated to the token without having to send a PIN through the Cryptoki
library.  One such possibility is that the user enters a PIN on a PIN pad on
the token itself, or on the slot device.  Or the user might not even use a
PIN—authentication could be achieved by some fingerprint-reading device, for
example.  To log into a token with a protected authentication path, the <i>pPin</i>
parameter to <b>C_Login</b> should be NULL_PTR.  When <b>C_Login</b> returns,
whatever authentication method supported by the token will have been performed;
a return value of CKR_OK means that the user was successfully authenticated,
and a return value of CKR_PIN_INCORRECT means that the user was denied access.</p>

<p class=MsoNormal>If there are any active cryptographic or object finding
operations in an application’s session, and then <b>C_Login</b> is successfully
executed by that application, it may or may not be the case that those
operations are still active.  Therefore, before logging in, any active
operations should be finished.</p>

<p class=MsoNormal>If the application calling <b>C_Login</b> has a R/O session
open with the token, then it will be unable to log the SO into a session (see <b><span
style='color:#3B006F'>[PKCS11-UG] </span></b>for further details).  An attempt
to do this will result in the error code CKR_SESSION_READ_ONLY_EXISTS.</p>

<p class=MsoNormal>C_Login may be called repeatedly, without intervening <b>C_Logout</b>
calls, if (and only if) a key with the CKA_ALWAYS_AUTHENTICATE attribute set to
CK_TRUE exists, and the user needs to do cryptographic operation on this key.
See further Section 4.9.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK, CKR_OPERATION_NOT_INITIALIZED, CKR_PIN_INCORRECT,
CKR_PIN_LOCKED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID, CKR_SESSION_READ_ONLY_EXISTS,
CKR_USER_ALREADY_LOGGED_IN, CKR_USER_ANOTHER_ALREADY_LOGGED_IN,
CKR_USER_PIN_NOT_INITIALIZED, CKR_USER_TOO_MANY_TYPES, CKR_USER_TYPE_INVALID.</p>

<p class=MsoNormal>Example: see <b>C_Logout</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002344"></a><a name="_Toc72656126"></a><a name="_Toc405794736"></a><a
name="_Toc385057916"></a><a name="_Toc383864888"></a><a name="_Toc323610881"></a><a
name="_Toc323205451"></a><a name="_Toc323024119"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_Logout</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_Logout)(<br>
  CK_SESSION_HANDLE hSession<br>
);</p>

</div>

<p class=MsoNormal><b>C_Logout</b> logs a user out from a token.  <i>hSession</i>
is the session’s handle.</p>

<p class=MsoNormal>Depending on the current user type, if the call succeeds,
each of the application’s sessions will enter either the “R/W Public Session”
state or the “R/O Public Session” state.</p>

<p class=MsoNormal>When <b>C_Logout</b> successfully executes, any of the
application’s handles to private objects become invalid (even if a user is
later logged back into the token, those handles remain invalid).  In addition,
all private session objects from sessions belonging to the application are
destroyed.</p>

<p class=MsoNormal>If there are any active cryptographic or object-finding
operations in an application’s session, and then <b>C_Logout</b> is
successfully executed by that application, it may or may not be the case that
those operations are still active.  Therefore, before logging out, any active
operations should be finished.</p>

<p class=MsoNormal>Return values: CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_UTF8CHAR userPIN[] = {“MyPIN”};</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>rv = C_Login(hSession, CKU_USER, userPIN,
sizeof(userPIN)-1);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  rv == C_Logout(hSession);</p>

<p class=BoxedCode>  if (rv == CKR_OK) {</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>  }</p>

<p class=BoxedCode>}</p>

</div>

<h2><a name="_Toc416959743"></a><a name="_Toc395183816"></a><a
name="_Toc391468820"></a><a name="_Toc370634029"></a><a name="_Toc235002345"></a><a
name="_Toc72656127"></a><a name="_Ref457140255"></a><a name="_Toc405794737"></a><a
name="_Ref399147217"></a><a name="_Ref398614471"></a><a name="_Ref398614396"></a><a
name="_Toc385057917"></a><a name="_Toc383864889"></a><a name="_Toc323610882"></a><a
name="_Toc323205452"></a><a name="_Toc323024120"></a><a name="_Toc323000710"></a><a
name="_Toc322945143"></a><a name="_Toc322855301"></a><a name="_Toc319315700"></a><a
name="_Toc319313707"></a><a name="_Toc319313514"></a><a name="_Toc319287674">5.7
Object management</a> functions</h2>

<p class=MsoNormal>Cryptoki provides the following functions for managing
objects.  Additional functions provided specifically for managing key objects
are described in Section 5.13.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002346"></a><a name="_Toc72656128"></a><a name="_Toc405794738"></a><a
name="_Toc385057918"></a><a name="_Toc383864890"></a><a name="_Toc323610883"></a><a
name="_Toc323205453"></a><a name="_Toc323024121"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_CreateObject</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_CreateObject)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_ATTRIBUTE_PTR pTemplate,<br>
  CK_ULONG ulCount,<br>
  CK_OBJECT_HANDLE_PTR phObject<br>
);</p>

</div>

<p class=MsoNormal><b>C_CreateObject</b> creates a new object. <i>hSession</i>
is the session’s handle; <i>pTemplate</i> points to the object’s template; <i>ulCount</i>
is the number of attributes in the template; <i>phObject</i> points to the
location that receives the new object’s handle.</p>

<p class=MsoNormal>If a call to <b>C_CreateObject</b> cannot support the
precise template supplied to it, it will fail and return without creating any
object.</p>

<p class=MsoNormal>If <b>C_CreateObject</b> is used to create a key object, the
key object will have its <b>CKA_LOCAL</b> attribute set to CK_FALSE. If that
key object is a secret or private key then the new key will have the <b>CKA_ALWAYS_SENSITIVE</b>
attribute set to CK_FALSE, and the <b>CKA_NEVER_EXTRACTABLE</b> attribute set
to CK_FALSE.</p>

<p class=MsoNormal>Only session objects can be created during a read-only
session.  Only public objects can be created unless the normal user is logged
in.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_ATTRIBUTE_READ_ONLY,
CKR_ATTRIBUTE_TYPE_INVALID, CKR_ATTRIBUTE_VALUE_INVALID,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_CURVE_NOT_SUPPORTED, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_DOMAIN_PARAMS_INVALID,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK,
CKR_PIN_EXPIRED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID,
CKR_SESSION_READ_ONLY, CKR_TEMPLATE_INCOMPLETE, CKR_TEMPLATE_INCONSISTENT,
CKR_TOKEN_WRITE_PROTECTED, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE</p>

<p class=BoxedCode>  hData,</p>

<p class=BoxedCode>  hCertificate,</p>

<p class=BoxedCode>  hKey;</p>

<p class=BoxedCode>CK_OBJECT_CLASS</p>

<p class=BoxedCode>  dataClass = CKO_DATA,</p>

<p class=BoxedCode>  certificateClass = CKO_CERTIFICATE,</p>

<p class=BoxedCode>  keyClass = CKO_PUBLIC_KEY;</p>

<p class=BoxedCode>CK_KEY_TYPE keyType = CKK_RSA;</p>

<p class=BoxedCode>CK_UTF8CHAR application[] = {“My Application”};</p>

<p class=BoxedCode>CK_BYTE dataValue[] = {...};</p>

<p class=BoxedCode>CK_BYTE subject[] = {...};</p>

<p class=BoxedCode>CK_BYTE id[] = {...};</p>

<p class=BoxedCode>CK_BYTE certificateValue[] = {...};</p>

<p class=BoxedCode>CK_BYTE modulus[] = {...};</p>

<p class=BoxedCode>CK_BYTE exponent[] = {...};</p>

<p class=BoxedCode>CK_BBOOL true = CK_TRUE;</p>

<p class=BoxedCode>CK_ATTRIBUTE dataTemplate[] = {</p>

<p class=BoxedCode>  {CKA_CLASS, &amp;dataClass, sizeof(dataClass)},</p>

<p class=BoxedCode>  {CKA_TOKEN, &amp;true, sizeof(true)},</p>

<p class=BoxedCode>  {CKA_APPLICATION, application, sizeof(application)-1},</p>

<p class=BoxedCode>  {CKA_VALUE, dataValue, sizeof(dataValue)}</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_ATTRIBUTE certificateTemplate[] = {</p>

<p class=BoxedCode>  {CKA_CLASS, &amp;certificateClass,
sizeof(certificateClass)},</p>

<p class=BoxedCode>  {CKA_TOKEN, &amp;true, sizeof(true)},</p>

<p class=BoxedCode>  {CKA_SUBJECT, subject, sizeof(subject)},</p>

<p class=BoxedCode>  {CKA_ID, id, sizeof(id)},</p>

<p class=BoxedCode>  {CKA_VALUE, certificateValue, sizeof(certificateValue)}</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_ATTRIBUTE keyTemplate[] = {</p>

<p class=BoxedCode>  {CKA_CLASS, &amp;keyClass, sizeof(keyClass)},</p>

<p class=BoxedCode>  {CKA_KEY_TYPE, &amp;keyType, sizeof(keyType)},</p>

<p class=BoxedCode>  {CKA_WRAP, &amp;true, sizeof(true)},</p>

<p class=BoxedCode>  {CKA_MODULUS, modulus, sizeof(modulus)},</p>

<p class=BoxedCode>  {CKA_PUBLIC_EXPONENT, exponent, sizeof(exponent)}</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>/* Create a data object */</p>

<p class=BoxedCode>rv = C_CreateObject(hSession, &amp;dataTemplate, 4, &amp;hData);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Create a certificate object */</p>

<p class=BoxedCode>rv = C_CreateObject(</p>

<p class=BoxedCode>  hSession, &amp;certificateTemplate, 5, &amp;hCertificate);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Create an RSA public key object */</p>

<p class=BoxedCode>rv = C_CreateObject(hSession, &amp;keyTemplate, 5,
&amp;hKey);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002347"></a><a name="_Toc72656129"></a><a name="_Toc405794739"></a><a
name="_Toc385057919"></a><a name="_Toc383864891"></a><a name="_Toc323610884"></a><a
name="_Toc323205454"></a><a name="_Toc323024122"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_CopyObject</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_CopyObject)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_OBJECT_HANDLE hObject,<br>
  CK_ATTRIBUTE_PTR pTemplate,<br>
  CK_ULONG ulCount,<br>
  CK_OBJECT_HANDLE_PTR phNewObject<br>
);</p>

</div>

<p class=MsoNormal><b>C_CopyObject</b> copies an object, creating a new object
for the copy.  <i>hSession</i> is the session’s handle; <i>hObject</i> is the
object’s handle; <i>pTemplate</i> points to the template for the new object; <i>ulCount</i>
is the number of attributes in the template; <i>phNewObject</i> points to the
location that receives the handle for the copy of the object.</p>

<p class=MsoNormal>The template may specify new values for any attributes of
the object that can ordinarily be modified (<i>e.g.</i>, in the course of
copying a secret key, a key’s <b>CKA_EXTRACTABLE</b> attribute may be changed from
CK_TRUE to CK_FALSE, but not the other way around.  If this change is made, the
new key’s <b>CKA_NEVER_EXTRACTABLE</b> attribute will have the value CK_FALSE. 
Similarly, the template may specify that the new key’s <b>CKA_SENSITIVE</b>
attribute be CK_TRUE; the new key will have the same value for its <b>CKA_ALWAYS_SENSITIVE</b>
attribute as the original key).  It may also specify new values of the <b>CKA_TOKEN</b>
and <b>CKA_PRIVATE</b> attributes (<i>e.g.</i>, to copy a session object to a
token object).  If the template specifies a value of an attribute which is
incompatible with other existing attributes of the object, the call fails with
the return code CKR_TEMPLATE_INCONSISTENT.</p>

<p class=MsoNormal>If a call to <b>C_CopyObject</b> cannot support the precise
template supplied to it, it will fail and return without creating any object.
If the object indicated by hObject has its CKA_COPYABLE attribute set to
CK_FALSE, C_CopyObject will return CKR_ACTION_PROHIBITED.</p>

<p class=MsoNormal>Only session objects can be created during a read-only
session.  Only public objects can be created unless the normal user is logged
in.</p>

<p class=MsoNormal>Return values: , CKR_ACTION_PROHIBITED, CKR_ARGUMENTS_BAD,
CKR_ATTRIBUTE_READ_ONLY, CKR_ATTRIBUTE_TYPE_INVALID,
CKR_ATTRIBUTE_VALUE_INVALID, CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR,
CKR_HOST_MEMORY, CKR_OBJECT_HANDLE_INVALID, CKR_OK, CKR_PIN_EXPIRED,
CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID, CKR_SESSION_READ_ONLY,
CKR_TEMPLATE_INCONSISTENT, CKR_TOKEN_WRITE_PROTECTED, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal> Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hKey, hNewKey;</p>

<p class=BoxedCode>CK_OBJECT_CLASS keyClass = CKO_SECRET_KEY;</p>

<p class=BoxedCode>CK_KEY_TYPE keyType = CKK_DES;</p>

<p class=BoxedCode>CK_BYTE id[] = {...};</p>

<p class=BoxedCode>CK_BYTE keyValue[] = {...};</p>

<p class=BoxedCode>CK_BBOOL false = CK_FALSE;</p>

<p class=BoxedCode>CK_BBOOL true = CK_TRUE;</p>

<p class=BoxedCode>CK_ATTRIBUTE keyTemplate[] = {</p>

<p class=BoxedCode>  {CKA_CLASS, &amp;keyClass, sizeof(keyClass)},</p>

<p class=BoxedCode>  {CKA_KEY_TYPE, &amp;keyType, sizeof(keyType)},</p>

<p class=BoxedCode>  <span lang=SV>{CKA_TOKEN, &amp;false, sizeof(false)},</span></p>

<p class=BoxedCode><span lang=SV>  </span>{CKA_ID, id, sizeof(id)},</p>

<p class=BoxedCode>  {CKA_VALUE, keyValue, sizeof(keyValue)}</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_ATTRIBUTE copyTemplate[] = {</p>

<p class=BoxedCode>  {CKA_TOKEN, &amp;true, sizeof(true)}</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>/* Create a DES secret key session object */</p>

<p class=BoxedCode>rv = C_CreateObject(hSession, &amp;keyTemplate, 5,
&amp;hKey);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  /* Create a copy which is a token object */</p>

<p class=BoxedCode>  rv = C_CopyObject(hSession, hKey, &amp;copyTemplate, 1,
&amp;hNewKey);</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002348"></a><a name="_Toc72656130"></a><a name="_Toc405794740"></a><a
name="_Toc385057920"></a><a name="_Toc383864892"></a><a name="_Toc323610885"></a><a
name="_Toc323205455"></a><a name="_Toc323024123"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_DestroyObject</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_DestroyObject)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_OBJECT_HANDLE hObject<br>
);</p>

</div>

<p class=MsoNormal><b>C_DestroyObject</b> destroys an object.  <i>hSession</i>
is the session’s handle;  and <i>hObject</i> is the object’s handle.</p>

<p class=MsoNormal>Only session objects can be destroyed during a read-only
session.  Only public objects can be destroyed unless the normal user is logged
in.</p>

<p class=MsoNormal>Certain objects may not be destroyed. Calling
C_DestroyObject on such objects will result in the CKR_ACTION_PROHIBITED error
code. An application can consult the object's CKA_DESTROYABLE attribute to
determine if an object may be destroyed or not.</p>

<p class=MsoNormal>Return values: , CKR_ACTION_PROHIBITED, CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OBJECT_HANDLE_INVALID, CKR_OK,
CKR_PIN_EXPIRED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID,
CKR_SESSION_READ_ONLY, CKR_TOKEN_WRITE_PROTECTED.</p>

<p class=MsoNormal> Example: see <b>C_GetObjectSize</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002349"></a><a name="_Toc72656131"></a><a name="_Toc405794741"></a><a
name="_Toc385057921"></a><a name="_Toc383864893"></a><a name="_Toc323610886"></a><a
name="_Toc323205456"></a><a name="_Toc323024124"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_GetObjectSize</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_GetObjectSize)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_OBJECT_HANDLE hObject,<br>
  CK_ULONG_PTR pulSize<br>
);</p>

</div>

<p class=MsoNormal><b>C_GetObjectSize</b> gets the size of an object in bytes. 
<i>hSession</i> is the session’s handle; <i>hObject</i> is the object’s handle;
<i>pulSize</i> points to the location that receives the size in bytes of the
object.</p>

<p class=MsoNormal>Cryptoki does not specify what the precise meaning of an
object’s size is.  Intuitively, it is some measure of how much token memory the
object takes up.  If an application deletes (say) a private object of size S,
it might be reasonable to assume that the <i>ulFreePrivateMemory</i> field of
the token’s <b>CK_TOKEN_INFO</b> structure increases by approximately S.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY,
CKR_INFORMATION_SENSITIVE, CKR_OBJECT_HANDLE_INVALID, CKR_OK,
CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hObject;</p>

<p class=BoxedCode>CK_OBJECT_CLASS dataClass = CKO_DATA;</p>

<p class=BoxedCode>CK_UTF8CHAR application[] = {“My Application”};</p>

<p class=BoxedCode>CK_BYTE dataValue[] = {...};</p>

<p class=BoxedCode>CK_BYTE value[] = {...};</p>

<p class=BoxedCode>CK_BBOOL true = CK_TRUE;</p>

<p class=BoxedCode>CK_ATTRIBUTE template[] = {</p>

<p class=BoxedCode>  {CKA_CLASS, &amp;dataClass, sizeof(dataClass)},</p>

<p class=BoxedCode>  {CKA_TOKEN, &amp;true, sizeof(true)},</p>

<p class=BoxedCode>  {CKA_APPLICATION, application, sizeof(application)-1},</p>

<p class=BoxedCode>  {CKA_VALUE, value, sizeof(value)}</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_ULONG ulSize;</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>rv = C_CreateObject(hSession, &amp;template, 4,
&amp;hObject);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  rv = C_GetObjectSize(hSession, hObject, &amp;ulSize);</p>

<p class=BoxedCode>  if (rv != CKR_INFORMATION_SENSITIVE) {</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>  }</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>  rv = C_DestroyObject(hSession, hObject);</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002350"></a><a name="_Toc72656132"></a><a name="_Toc405794742"></a><a
name="_Toc385057922"></a><a name="_Toc383864894"></a><a name="_Toc323610887"></a><a
name="_Toc323205457"></a><a name="_Toc323024125"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_GetAttributeValue</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_GetAttributeValue)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_OBJECT_HANDLE hObject,<br>
  CK_ATTRIBUTE_PTR pTemplate,<br>
  CK_ULONG ulCount<br>
);</p>

</div>

<p class=MsoNormal><b>C_GetAttributeValue</b> obtains the value of one or more
attributes of an object.  <i>hSession</i> is the session’s handle; <i>hObject</i>
is the object’s handle; <i>pTemplate</i> points to a template that specifies
which attribute values are to be obtained, and receives the attribute values; <i>ulCount</i>
is the number of attributes in the template.</p>

<p class=MsoNormal>For each (<i>type</i>, <i>pValue</i>, <i>ulValueLen</i>)
triple in the template, <b>C_GetAttributeValue</b> performs the following
algorithm:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>If the
specified attribute (i.e., the attribute specified by the type field) for the
object cannot be revealed because the object is sensitive or unextractable,
then the ulValueLen field in that triple is modified to hold the value
CK_UNAVAILABLE_INFORMATION.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Otherwise,
if the specified value for the object is invalid (the object does not possess
such an attribute), then the ulValueLen field in that triple is modified to
hold the value CK_UNAVAILABLE_INFORMATION.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Otherwise,
if the <i>pValue</i> field has the value NULL_PTR, then the <i>ulValueLen</i>
field is modified to hold the exact length of the specified attribute for the
object.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Otherwise,
if the length specified in <i>ulValueLen</i> is large enough to hold the value
of the specified attribute for the object, then that attribute is copied into
the buffer located at <i>pValue</i>, and the <i>ulValueLen</i> field is
modified to hold the exact length of the attribute.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>Otherwise,
the ulValueLen field is modified to hold the value CK_UNAVAILABLE_INFORMATION.</p>

<p class=MsoNormal>If case 1 applies to any of the requested attributes, then
the call should return the value CKR_ATTRIBUTE_SENSITIVE.  If case 2 applies to
any of the requested attributes, then the call should return the value
CKR_ATTRIBUTE_TYPE_INVALID.  If case 5 applies to any of the requested
attributes, then the call should return the value CKR_BUFFER_TOO_SMALL.  As
usual, if more than one of these error codes is applicable, Cryptoki may return
any of them.  Only if none of them applies to any of the requested attributes
will CKR_OK be returned.</p>

<p class=MsoNormal>In the special case of an attribute whose value is an array
of attributes, for example CKA_WRAP_TEMPLATE, where it is passed in with pValue
not NULL, then if the pValue of elements within the array is NULL_PTR then the
ulValueLen of elements within the array will be set to the required length. If
the pValue of elements within the array is not NULL_PTR, then the ulValueLen
element of attributes within the array MUST reflect the space that the
corresponding pValue points to, and pValue is filled in if there is sufficient
room. Therefore it is important to initialize the contents of a buffer before
calling C_GetAttributeValue to get such an array value. If any ulValueLen
within the array isn't large enough, it will be set to
CK_UNAVAILABLE_INFORMATION and the function will return CKR_BUFFER_TOO_SMALL,
as it does if an attribute in the pTemplate argument has ulValueLen too small.
Note that any attribute whose value is an array of attributes is identifiable
by virtue of the attribute type having the CKF_ARRAY_ATTRIBUTE bit set.</p>

<p class=MsoNormal>Note that the error codes CKR_ATTRIBUTE_SENSITIVE,
CKR_ATTRIBUTE_TYPE_INVALID, and CKR_BUFFER_TOO_SMALL  do not denote true errors
for <b>C_GetAttributeValue</b>.  If a call to <b>C_GetAttributeValue</b>
returns any of these three values, then the call MUST nonetheless have
processed <i>every</i> attribute in the template supplied to <b>C_GetAttributeValue</b>. 
Each attribute in the template whose value <i>can be</i> returned by the call
to <b>C_GetAttributeValue</b> <i>will be</i> returned by the call to <b>C_GetAttributeValue</b>.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_ATTRIBUTE_SENSITIVE,
CKR_ATTRIBUTE_TYPE_INVALID, CKR_BUFFER_TOO_SMALL, CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OBJECT_HANDLE_INVALID, CKR_OK,
CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hObject;</p>

<p class=BoxedCode>CK_BYTE_PTR pModulus, pExponent;</p>

<p class=BoxedCode>CK_ATTRIBUTE template[] = {</p>

<p class=BoxedCode>  {CKA_MODULUS, NULL_PTR, 0},</p>

<p class=BoxedCode>  {CKA_PUBLIC_EXPONENT, NULL_PTR, 0}</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>rv = C_GetAttributeValue(hSession, hObject, &amp;template,
2);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  pModulus = (CK_BYTE_PTR) malloc(template[0].ulValueLen);</p>

<p class=BoxedCode>  template[0].pValue = pModulus;</p>

<p class=BoxedCode>  /* template[0].ulValueLen was set by C_GetAttributeValue
*/</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>  pExponent = (CK_BYTE_PTR) malloc(template[1].ulValueLen);</p>

<p class=BoxedCode>  template[1].pValue = pExponent;</p>

<p class=BoxedCode>  /* template[1].ulValueLen was set by C_GetAttributeValue
*/</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>  rv = C_GetAttributeValue(hSession, hObject, &amp;template,
2);</p>

<p class=BoxedCode>  if (rv == CKR_OK) {</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>  }</p>

<p class=BoxedCode>  free(pModulus);</p>

<p class=BoxedCode>  free(pExponent);</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002351"></a><a name="_Toc72656133"></a><a name="_Toc405794743"></a><a
name="_Toc385057923"></a><a name="_Toc383864895"></a><a name="_Toc323610888"></a><a
name="_Toc323205458"></a><a name="_Toc323024126"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_SetAttributeValue</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_SetAttributeValue)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_OBJECT_HANDLE hObject,<br>
  CK_ATTRIBUTE_PTR pTemplate,<br>
  CK_ULONG ulCount<br>
);</p>

</div>

<p class=MsoNormal><b>C_SetAttributeValue</b> modifies the value of one or more
attributes of an object.  <i>hSession</i> is the session’s handle; <i>hObject</i>
is the object’s handle; <i>pTemplate</i> points to a template that specifies
which attribute values are to be modified and their new values; <i>ulCount</i>
is the number of attributes in the template.</p>

<p class=MsoNormal>Certain objects may not be modified. Calling
C_SetAttributeValue on such objects will result in the CKR_ACTION_PROHIBITED
error code. An application can consult the object's CKA_MODIFIABLE attribute to
determine if an object may be modified or not.</p>

<p class=MsoNormal>Only session objects can be modified during a read-only
session.</p>

<p class=MsoNormal>The template may specify new values for any attributes of
the object that can be modified.  If the template specifies a value of an
attribute which is incompatible with other existing attributes of the object,
the call fails with the return code CKR_TEMPLATE_INCONSISTENT.</p>

<p class=MsoNormal>Not all attributes can be modified; see Section 4.1.2 for more details.</p>

<p class=MsoNormal>Return values: CKR_ACTION_PROHIBITED, CKR_ARGUMENTS_BAD,
CKR_ATTRIBUTE_READ_ONLY, CKR_ATTRIBUTE_TYPE_INVALID,
CKR_ATTRIBUTE_VALUE_INVALID, CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR,
CKR_HOST_MEMORY, CKR_OBJECT_HANDLE_INVALID, CKR_OK, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_SESSION_READ_ONLY, CKR_TEMPLATE_INCONSISTENT,
CKR_TOKEN_WRITE_PROTECTED, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hObject;</p>

<p class=BoxedCode>CK_UTF8CHAR label[] = {“New label”};</p>

<p class=BoxedCode>CK_ATTRIBUTE template[] = {</p>

<p class=BoxedCode>  CKA_LABEL, label, sizeof(label)-1</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>rv = C_SetAttributeValue(hSession, hObject, &amp;template,
1);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002352"></a><a name="_Toc72656134"></a><a name="_Toc405794744"></a><a
name="_Toc385057924"></a><a name="_Toc383864896"></a><a name="_Toc323610889"></a><a
name="_Toc323205460"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>C_FindObjectsInit</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_FindObjectsInit)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_ATTRIBUTE_PTR pTemplate,<br>
  CK_ULONG ulCount<br>
);</p>

</div>

<p class=MsoNormal><b>C_FindObjectsInit</b> initializes a search for token and
session objects that match a template. <i>hSession</i> is the session’s handle;
<i>pTemplate</i> points to a search template that specifies the attribute
values to match; <i>ulCount</i> is the number of attributes in the search
template. The matching criterion is an exact byte-for-byte match with all
attributes in the template. To find all objects, set <i>ulCount</i> to 0.</p>

<p class=MsoNormal>After calling <b>C_FindObjectsInit</b>, the application may
call <b>C_FindObjects</b> one or more times to obtain handles for objects
matching the template, and then eventually call <b>C_FindObjectsFinal</b> to
finish the active search operation.  At most one search operation may be active
at a given time in a given session.</p>

<p class=MsoNormal>The object search operation will only find objects that the
session can view.  For example, an object search in an “R/W Public Session”
will not find any private objects (even if one of the attributes in the search
template specifies that the search is for private objects).</p>

<p class=MsoNormal>If a search operation is active, and objects are created or
destroyed which fit the search template for the active search operation, then
those objects may or may not be found by the search operation.  Note that this
means that, under these circumstances, the search operation may return invalid
object handles.</p>

<p class=MsoNormal>Even though <b>C_FindObjectsInit</b> can return the values
CKR_ATTRIBUTE_TYPE_INVALID and CKR_ATTRIBUTE_VALUE_INVALID, it is not required
to.  For example, if it is given a search template with nonexistent attributes
in it, it can return CKR_ATTRIBUTE_TYPE_INVALID, or it can initialize a search
operation which will match no objects and return CKR_OK.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_ATTRIBUTE_TYPE_INVALID, CKR_ATTRIBUTE_VALUE_INVALID, CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK, CKR_OPERATION_ACTIVE,
CKR_PIN_EXPIRED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal>Example: see <b>C_FindObjectsFinal</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002353"></a><a name="_Toc72656135"></a><a name="_Toc405794745"></a><a
name="_Toc385057925"></a><a name="_Toc383864897"></a><a name="_Toc323610890"></a><a
name="_Toc323205461"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>C_FindObjects</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_FindObjects)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_OBJECT_HANDLE_PTR phObject,<br>
  CK_ULONG ulMaxObjectCount,<br>
  CK_ULONG_PTR pulObjectCount<br>
);</p>

</div>

<p class=MsoNormal><b>C_FindObjects</b> continues a search for token and
session objects that match a template, obtaining additional object handles. <i>hSession</i>
is the session’s handle; <i>phObject</i> points to the location that receives
the list (array) of additional object handles; <i>ulMaxObjectCount</i> is the
maximum number of object handles to be returned; <i>pulObjectCount</i> points
to the location that receives the actual number of object handles returned.</p>

<p class=MsoNormal>If there are no more objects matching the template, then the
location that <i>pulObjectCount</i> points to receives the value 0.</p>

<p class=MsoNormal>The search MUST have been initialized with <b>C_FindObjectsInit</b>.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY,
CKR_OK, CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal>Example: see <b>C_FindObjectsFinal</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002354"></a><a name="_Toc72656136"></a><a name="_Toc405794746"></a><a
name="_Toc385057926"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>C_FindObjectsFinal</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_FindObjectsFinal)(<br>
  CK_SESSION_HANDLE hSession<br>
);</p>

</div>

<p class=MsoNormal><b>C_FindObjectsFinal</b> terminates a search for token and
session objects.  <i>hSession</i> is the session’s handle.</p>

<p class=MsoNormal>Return values: CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK, CKR_OPERATION_NOT_INITIALIZED,
CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hObject;</p>

<p class=BoxedCode>CK_ULONG ulObjectCount;</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>rv = C_FindObjectsInit(hSession, NULL_PTR, 0);</p>

<p class=BoxedCode>assert(rv == CKR_OK);</p>

<p class=BoxedCode>while (1) {</p>

<p class=BoxedCode>  rv = C_FindObjects(hSession, &amp;hObject, 1,
&amp;ulObjectCount);</p>

<p class=BoxedCode>  if (rv != CKR_OK || ulObjectCount == 0)</p>

<p class=BoxedCode>    break;</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>rv = C_FindObjectsFinal(hSession);</p>

<p class=BoxedCode>assert(rv == CKR_OK);</p>

</div>

<h2><a name="_Ref319839546"></a><a name="_Toc319315701"></a><a
name="_Toc319313708"></a><a name="_Toc319313515"></a><a name="_Toc319287675"></a><a
name="_Toc416959744"></a><a name="_Toc395183817"></a><a name="_Toc391468821"></a><a
name="_Toc370634030"></a><a name="_Toc235002355"></a><a name="_Toc72656137"></a><a
name="_Toc405794747"></a><a name="_Toc385057927"></a><a name="_Toc383864898"></a><a
name="_Toc323610891"></a><a name="_Toc323205462"></a><a name="_Toc323024128"></a><a
name="_Toc323000711"></a><a name="_Toc322945144"></a><a name="_Toc322855302"></a><a
name="_Toc319315702"></a><a name="_Toc319313709"></a><a name="_Toc319313516"></a><a
name="_Toc319287676">5.8 Encryption</a> functions</h2>

<p class=MsoNormal>Cryptoki provides the following functions for encrypting
data:<b> </b></p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002356"></a><a name="_Toc72656138"></a><a name="_Toc405794748"></a><a
name="_Toc385057928"></a><a name="_Toc383864899"></a><a name="_Toc323610892"></a><a
name="_Toc323205463"></a><a name="_Toc323024129"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_EncryptInit</span></a><a
name=encryptinit></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_EncryptInit)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_MECHANISM_PTR pMechanism,<br>
  CK_OBJECT_HANDLE hKey<br>
);</p>

</div>

<p class=MsoNormal><b>C_EncryptInit</b> initializes an encryption operation. <i>hSession</i>
is the session’s handle; <i>pMechanism</i> points to the encryption mechanism; <i>hKey</i>
is the handle of the encryption key.</p>

<p class=MsoNormal>The <b>CKA_ENCRYPT</b> attribute of the encryption key,
which indicates whether the key supports encryption, MUST be CK_TRUE.</p>

<p class=MsoNormal>After calling <b>C_EncryptInit</b>, the application can
either call <b>C_Encrypt</b> to encrypt data in a single part; or call <b>C_EncryptUpdate</b>
zero or more times, followed by <b>C_EncryptFinal</b>, to encrypt data in
multiple parts.  The encryption operation is active until the application uses
a call to <b>C_Encrypt</b> or <b>C_EncryptFinal</b> <i>to actually obtain</i>
the final piece of ciphertext.  To process additional data (in single or
multiple parts), the application MUST call <b>C_EncryptInit</b> again.</p>

<p class=MsoNormal>Return values: CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY,
CKR_KEY_FUNCTION_NOT_PERMITTED, CKR_KEY_HANDLE_INVALID, CKR_KEY_SIZE_RANGE,
CKR_KEY_TYPE_INCONSISTENT, CKR_MECHANISM_INVALID, CKR_MECHANISM_PARAM_INVALID,
CKR_OK, CKR_OPERATION_ACTIVE, CKR_PIN_EXPIRED, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:  see <b>C_EncryptFinal</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002357"></a><a name="_Toc72656139"></a><a name="_Toc405794749"></a><a
name="_Toc385057929"></a><a name="_Toc383864900"></a><a name="_Toc323610893"></a><a
name="_Toc323205464"></a><a name="_Toc323024130"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_Encrypt</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_Encrypt)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pData,<br>
  CK_ULONG ulDataLen,<br>
  CK_BYTE_PTR pEncryptedData,<br>
  CK_ULONG_PTR pulEncryptedDataLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_Encrypt</b> encrypts single-part data. <i>hSession</i>
is the session’s handle; <i>pData</i> points to the data; <i>ulDataLen</i> is
the length in bytes of the data; <i>pEncryptedData</i> points to the location
that receives the encrypted data; <i>pulEncryptedDataLen</i> points to the
location that holds the length in bytes of the encrypted data.</p>

<p class=MsoNormal><b>C_Encrypt</b> uses the convention described in Section 5.2 on producing output.</p>

<p class=MsoNormal>The encryption operation MUST have been initialized with <b>C_EncryptInit</b>. 
A call to <b>C_Encrypt</b> always terminates the active encryption operation
unless it returns CKR_BUFFER_TOO_SMALL or is a successful call (<i>i.e.</i>,
one which returns CKR_OK) to determine the length of the buffer needed to hold
the ciphertext.</p>

<p class=MsoNormal><b>C_Encrypt<i> </i></b>cannot be used to terminate a multi-part
operation, and MUST be called after <b>C_EncryptInit</b> without intervening <b>C_EncryptUpdate</b>
calls.</p>

<p class=MsoNormal>For some encryption mechanisms, the input plaintext data has
certain length constraints (either because the mechanism can only encrypt
relatively short pieces of plaintext, or because the mechanism’s input data MUST
consist of an integral number of blocks).  If these constraints are not
satisfied, then <b>C_Encrypt</b> will fail with return code CKR_DATA_LEN_RANGE.</p>

<p class=MsoNormal>The plaintext and ciphertext can be in the same place, <i>i.e.</i>,
it is OK if <i>pData</i> and <i>pEncryptedData</i> point to the same location.</p>

<p class=MsoNormal>For most mechanisms, <b>C_Encrypt</b> is equivalent to a
sequence of <b>C_EncryptUpdate</b> operations followed by <b>C_EncryptFinal</b>.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DATA_INVALID, CKR_DATA_LEN_RANGE,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK,
CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal>Example: see <b>C_EncryptFinal</b> for an example of similar
functions.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002358"></a><a name="_Toc72656140"></a><a name="_Toc405794750"></a><a
name="_Toc385057930"></a><a name="_Toc383864901"></a><a name="_Toc323610894"></a><a
name="_Toc323205465"></a><a name="_Toc323024131"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_EncryptUpdate</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_EncryptUpdate)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pPart,<br>
  CK_ULONG ulPartLen,<br>
  CK_BYTE_PTR pEncryptedPart,<br>
  CK_ULONG_PTR pulEncryptedPartLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_EncryptUpdate</b> continues a multiple-part encryption
operation, processing another data part. <i>hSession</i> is the session’s
handle; <i>pPart</i> points to the data part; <i>ulPartLen</i> is the length of
the data part; <i>pEncryptedPart</i> points to the location that receives the
encrypted data part; <i>pulEncryptedPartLen</i> points to the location that
holds the length in bytes of the encrypted data part.</p>

<p class=MsoNormal><b>C_EncryptUpdate</b> uses the convention described in
Section 5.2 on producing output.</p>

<p class=MsoNormal>The encryption operation MUST have been initialized with <b>C_EncryptInit</b>. 
This function may be called any number of times in succession.  A call to <b>C_EncryptUpdate</b>
which results in an error other than CKR_BUFFER_TOO_SMALL terminates the
current encryption operation.</p>

<p class=MsoNormal>The plaintext and ciphertext can be in the same place, <i>i.e.</i>,
it is OK if <i>pPart</i> and <i>pEncryptedPart</i> point to the same location.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DATA_LEN_RANGE, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK,
CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal>Example:  see <b>C_EncryptFinal.</b></p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002359"></a><a name="_Toc72656141"></a><a name="_Toc405794751"></a><a
name="_Toc385057931"></a><a name="_Toc383864902"></a><a name="_Toc323610895"></a><a
name="_Toc323205466"></a><a name="_Toc323024132"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_EncryptFinal</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_EncryptFinal)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pLastEncryptedPart,<br>
  CK_ULONG_PTR pulLastEncryptedPartLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_EncryptFinal</b> finishes a multiple-part encryption
operation. <i>hSession</i> is the session’s handle; <i>pLastEncryptedPart</i>
points to the location that receives the last encrypted data part, if any; <i>pulLastEncryptedPartLen</i>
points to the location that holds the length of the last encrypted data part.</p>

<p class=MsoNormal><b>C_EncryptFinal</b> uses the convention described in
Section 5.2 on producing output.</p>

<p class=MsoNormal>The encryption operation MUST have been initialized with <b>C_EncryptInit</b>. 
A call to <b>C_EncryptFinal</b> always terminates the active encryption
operation unless it returns CKR_BUFFER_TOO_SMALL or is a successful call (<i>i.e.</i>,
one which returns CKR_OK) to determine the length of the buffer needed to hold
the ciphertext.</p>

<p class=MsoNormal>For some multi-part encryption mechanisms, the input
plaintext data has certain length constraints, because the mechanism’s input
data MUST consist of an integral number of blocks.  If these constraints are
not satisfied, then <b>C_EncryptFinal</b> will fail with return code
CKR_DATA_LEN_RANGE.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DATA_LEN_RANGE, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK,
CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>#define PLAINTEXT_BUF_SZ 200</p>

<p class=BoxedCode>#define CIPHERTEXT_BUF_SZ 256</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>CK_ULONG firstPieceLen, secondPieceLen;</p>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hKey;</p>

<p class=BoxedCode>CK_BYTE iv[8];</p>

<p class=BoxedCode>CK_MECHANISM mechanism = {</p>

<p class=BoxedCode>  CKM_DES_CBC_PAD, iv, sizeof(iv)</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_BYTE data[PLAINTEXT_BUF_SZ];</p>

<p class=BoxedCode>CK_BYTE encryptedData[CIPHERTEXT_BUF_SZ];</p>

<p class=BoxedCode>CK_ULONG ulEncryptedData1Len;</p>

<p class=BoxedCode>CK_ULONG ulEncryptedData2Len;</p>

<p class=BoxedCode><span lang=SV>CK_ULONG ulEncryptedData3Len;</span></p>

<p class=BoxedCode><span lang=SV>CK_RV rv;</span></p>

<p class=BoxedCode><span lang=SV>&nbsp;</span></p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>firstPieceLen = 90;</p>

<p class=BoxedCode>secondPieceLen = PLAINTEXT_BUF_SZ-firstPieceLen;</p>

<p class=BoxedCode>rv = C_EncryptInit(hSession, &amp;mechanism, hKey);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  /* Encrypt first piece */</p>

<p class=BoxedCode>  ulEncryptedData1Len = sizeof(encryptedData);</p>

<p class=BoxedCode>  rv = C_EncryptUpdate(</p>

<p class=BoxedCode>    hSession,</p>

<p class=BoxedCode>    &amp;data[0], firstPieceLen,</p>

<p class=BoxedCode>    &amp;encryptedData[0], &amp;ulEncryptedData1Len);</p>

<p class=BoxedCode>  if (rv != CKR_OK) {</p>

<p class=BoxedCode>     .</p>

<p class=BoxedCode>     .</p>

<p class=BoxedCode>  }</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>  /* Encrypt second piece */</p>

<p class=BoxedCode>  ulEncryptedData2Len =
sizeof(encryptedData)-ulEncryptedData1Len;</p>

<p class=BoxedCode>  rv = C_EncryptUpdate(</p>

<p class=BoxedCode>    hSession,</p>

<p class=BoxedCode>    &amp;data[firstPieceLen], secondPieceLen,</p>

<p class=BoxedCode>    &amp;encryptedData[ulEncryptedData1Len],
&amp;ulEncryptedData2Len);</p>

<p class=BoxedCode>  if (rv != CKR_OK) {</p>

<p class=BoxedCode>     .</p>

<p class=BoxedCode>     .</p>

<p class=BoxedCode>  }</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>  /* Get last little encrypted bit */</p>

<p class=BoxedCode>  ulEncryptedData3Len =</p>

<p class=BoxedCode>   
sizeof(encryptedData)-ulEncryptedData1Len-ulEncryptedData2Len;</p>

<p class=BoxedCode>  rv = C_EncryptFinal(</p>

<p class=BoxedCode>    hSession,</p>

<p class=BoxedCode>   
&amp;encryptedData[ulEncryptedData1Len+ulEncryptedData2Len],</p>

<p class=BoxedCode>    &amp;ulEncryptedData3Len);</p>

<p class=BoxedCode>  if (rv != CKR_OK) {</p>

<p class=BoxedCode>     .</p>

<p class=BoxedCode>     .</p>

<p class=BoxedCode>  }</p>

<p class=BoxedCode>}</p>

</div>

<h2><a name="_Toc416959745"></a><a name="_Toc395183818"></a><a
name="_Toc391468822"></a><a name="_Toc370634031"></a><a name="_Toc235002360"></a><a
name="_Toc72656142"></a><a name="_Toc405794752"></a><a name="_Toc385057932">5.9
Decryption functions</a></h2>

<p class=MsoNormal style='page-break-after:avoid'><a name="_Toc383864903"></a><a
name="_Toc323610896"></a><a name="_Toc323205467"></a><a name="_Toc323024133">Cryptoki
provides the following functions for decrypting data</a><span style='font-size:
12.0pt'>:<b> </b></span></p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002361"></a><a name="_Toc72656143"></a><a name="_Toc405794753"></a><a
name="_Toc385057933"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>C_DecryptInit</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_DecryptInit)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_MECHANISM_PTR pMechanism,<br>
  CK_OBJECT_HANDLE hKey<br>
);</p>

</div>

<p class=MsoNormal><b>C_DecryptInit</b> initializes a decryption operation. <i>hSession</i>
is the session’s handle; <i>pMechanism</i> points to the decryption mechanism; <i>hKey</i>
is the handle of the decryption key.</p>

<p class=MsoNormal>The <b>CKA_DECRYPT</b> attribute of the decryption key,
which indicates whether the key supports decryption, MUST be CK_TRUE.</p>

<p class=MsoNormal>After calling <b>C_DecryptInit</b>, the application can
either call <b>C_Decrypt</b> to decrypt data in a single part; or call <b>C_DecryptUpdate</b>
zero or more times, followed by <b>C_DecryptFinal</b>, to decrypt data in
multiple parts.  The decryption operation is active until the application uses
a call to <b>C_Decrypt</b> or <b>C_DecryptFinal</b> <i>to actually obtain</i>
the final piece of plaintext.  To process additional data (in single or
multiple parts), the application MUST call <b>C_DecryptInit</b> again</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_KEY_FUNCTION_NOT_PERMITTED,
CKR_KEY_HANDLE_INVALID, CKR_KEY_SIZE_RANGE, CKR_KEY_TYPE_INCONSISTENT,
CKR_MECHANISM_INVALID, CKR_MECHANISM_PARAM_INVALID, CKR_OK,
CKR_OPERATION_ACTIVE, CKR_PIN_EXPIRED, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:  see <b>C_DecryptFinal</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002362"></a><a name="_Toc72656144"></a><a name="_Toc405794754"></a><a
name="_Toc385057934"></a><a name="_Toc383864904"></a><a name="_Toc323610897"></a><a
name="_Toc323205468"></a><a name="_Toc323024134"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_Decrypt</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_Decrypt)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pEncryptedData,<br>
  CK_ULONG ulEncryptedDataLen,<br>
  CK_BYTE_PTR pData,<br>
  CK_ULONG_PTR pulDataLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_Decrypt</b> decrypts encrypted data in a single part. <i>hSession</i>
is the session’s handle; <i>pEncryptedData</i> points to the encrypted data; <i>ulEncryptedDataLen</i>
is the length of the encrypted data; <i>pData</i> points to the location that
receives the recovered data; <i>pulDataLen</i> points to the location that
holds the length of the recovered data.</p>

<p class=MsoNormal><b>C_Decrypt</b> uses the convention described in Section 5.2 on producing output.</p>

<p class=MsoNormal>The decryption operation MUST have been initialized with <b>C_DecryptInit</b>. 
A call to <b>C_Decrypt</b> always terminates the active decryption operation
unless it returns CKR_BUFFER_TOO_SMALL or is a successful call (<i>i.e.</i>,
one which returns CKR_OK) to determine the length of the buffer needed to hold
the plaintext.</p>

<p class=MsoNormal><b>C_Decrypt<i> </i></b>cannot be used to terminate a
multi-part operation, and MUST be called after <b>C_DecryptInit</b> without
intervening <b>C_DecryptUpdate</b> calls.</p>

<p class=MsoNormal>The ciphertext and plaintext can be in the same place, <i>i.e.</i>,
it is OK if <i>pEncryptedData</i> and <i>pData</i> point to the same location.</p>

<p class=MsoNormal>If the input ciphertext data cannot be decrypted because it
has an inappropriate length, then either CKR_ENCRYPTED_DATA_INVALID or
CKR_ENCRYPTED_DATA_LEN_RANGE may be returned.</p>

<p class=MsoNormal>For most mechanisms, <b>C_Decrypt</b> is equivalent to a
sequence of <b>C_DecryptUpdate</b> operations followed by <b>C_DecryptFinal</b>.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_ENCRYPTED_DATA_INVALID, CKR_ENCRYPTED_DATA_LEN_RANGE,
CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY,
CKR_OK, CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal><a name="_Toc383864905"></a><a name="_Toc323610898"></a><a
name="_Toc323205469"></a><a name="_Toc323024135">Example: see <b>C_DecryptFinal</b>
for an example of similar functions.</a></p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002363"></a><a name="_Toc72656145"></a><a name="_Toc405794755"></a><a
name="_Toc385057935"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>C_DecryptUpdate</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_DecryptUpdate)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pEncryptedPart,<br>
  CK_ULONG ulEncryptedPartLen,<br>
  CK_BYTE_PTR pPart,<br>
  CK_ULONG_PTR pulPartLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_DecryptUpdate</b> continues a multiple-part decryption
operation, processing another encrypted data part. <i>hSession</i> is the
session’s handle; <i>pEncryptedPart</i> points to the encrypted data part; <i>ulEncryptedPartLen</i>
is the length of the encrypted data part; <i>pPart</i> points to the location
that receives the recovered data part; <i>pulPartLen</i> points to the location
that holds the length of the recovered data part.</p>

<p class=MsoNormal><a name="_Toc319287678"><b>C_DecryptUpdate</b> uses the
convention described in Section </a>5.2 on producing output.</p>

<p class=MsoNormal>The decryption operation MUST have been initialized with <b>C_DecryptInit</b>. 
This function may be called any number of times in succession.  A call to <b>C_DecryptUpdate</b>
which results in an error other than CKR_BUFFER_TOO_SMALL terminates the
current decryption operation.</p>

<p class=MsoNormal>The ciphertext and plaintext can be in the same place, <i>i.e.</i>,
it is OK if <i>pEncryptedPart</i> and <i>pPart</i> point to the same location.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_ENCRYPTED_DATA_INVALID, CKR_ENCRYPTED_DATA_LEN_RANGE,
CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY,
CKR_OK, CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:  See <b>C_DecryptFinal</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002364"></a><a name="_Toc72656146"></a><a name="_Toc405794756"></a><a
name="_Toc385057936"></a><a name="_Toc383864906"></a><a name="_Toc323610899"></a><a
name="_Toc323205470"></a><a name="_Toc323024136"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_DecryptFinal</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_DecryptFinal)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pLastPart,<br>
  CK_ULONG_PTR pulLastPartLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_DecryptFinal</b> finishes a multiple-part decryption
operation. <i>hSession</i> is the session’s handle; <i>pLastPart</i> points to
the location that receives the last recovered data part, if any; <i>pulLastPartLen</i>
points to the location that holds the length of the last recovered data part.</p>

<p class=MsoNormal><b>C_DecryptFinal</b> uses the convention described in
Section 5.2 on producing output.</p>

<p class=MsoNormal>The decryption operation MUST have been initialized with <b>C_DecryptInit</b>. 
A call to <b>C_DecryptFinal</b> always terminates the active decryption
operation unless it returns CKR_BUFFER_TOO_SMALL or is a successful call (<i>i.e.</i>,
one which returns CKR_OK) to determine the length of the buffer needed to hold
the plaintext.</p>

<p class=MsoNormal>If the input ciphertext data cannot be decrypted because it
has an inappropriate length, then either CKR_ENCRYPTED_DATA_INVALID or
CKR_ENCRYPTED_DATA_LEN_RANGE may be returned.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_ENCRYPTED_DATA_INVALID, CKR_ENCRYPTED_DATA_LEN_RANGE,
CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY,
CKR_OK, CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal><a name="_Toc383864907"></a><a name="_Toc323610900"></a><a
name="_Toc323205471"></a><a name="_Toc323024137"></a><a name="_Toc323000712"></a><a
name="_Toc322945145"></a><a name="_Toc322855303"></a><a name="_Toc319315705"></a><a
name="_Toc319313712"></a><a name="_Toc319313519"></a><a name="_Toc319287679">Example:</a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>#define CIPHERTEXT_BUF_SZ 256</p>

<p class=BoxedCode>#define PLAINTEXT_BUF_SZ 256</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>CK_ULONG firstEncryptedPieceLen, secondEncryptedPieceLen;</p>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hKey;</p>

<p class=BoxedCode>CK_BYTE iv[8];</p>

<p class=BoxedCode>CK_MECHANISM mechanism = {</p>

<p class=BoxedCode>  CKM_DES_CBC_PAD, iv, sizeof(iv)</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_BYTE data[PLAINTEXT_BUF_SZ];</p>

<p class=BoxedCode>CK_BYTE encryptedData[CIPHERTEXT_BUF_SZ];</p>

<p class=BoxedCode><span lang=SV>CK_ULONG ulData1Len, ulData2Len, ulData3Len;</span></p>

<p class=BoxedCode><span lang=SV>CK_RV rv;</span></p>

<p class=BoxedCode><span lang=SV>&nbsp;</span></p>

<p class=BoxedCode><span lang=SV>.</span></p>

<p class=BoxedCode><span lang=SV>.</span></p>

<p class=BoxedCode><span lang=SV>firstEncryptedPieceLen = 90;</span></p>

<p class=BoxedCode><span lang=SV>secondEncryptedPieceLen =
CIPHERTEXT_BUF_SZ-firstEncryptedPieceLen;</span></p>

<p class=BoxedCode>rv = C_DecryptInit(hSession, &amp;mechanism, hKey);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  /* Decrypt first piece */</p>

<p class=BoxedCode>  ulData1Len = sizeof(data);</p>

<p class=BoxedCode>  rv = C_DecryptUpdate(</p>

<p class=BoxedCode>    hSession,</p>

<p class=BoxedCode>    &amp;encryptedData[0], firstEncryptedPieceLen,</p>

<p class=BoxedCode>    &amp;data[0], &amp;ulData1Len);</p>

<p class=BoxedCode>  if (rv != CKR_OK) {</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>  }</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>  /* Decrypt second piece */</p>

<p class=BoxedCode>  ulData2Len = sizeof(data)-ulData1Len;</p>

<p class=BoxedCode>  rv = C_DecryptUpdate(</p>

<p class=BoxedCode>    hSession,</p>

<p class=BoxedCode>    &amp;encryptedData[firstEncryptedPieceLen],</p>

<p class=BoxedCode>    secondEncryptedPieceLen,</p>

<p class=BoxedCode>    &amp;data[ulData1Len], &amp;ulData2Len);</p>

<p class=BoxedCode>  if (rv != CKR_OK) {</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>  }</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>  /* Get last little decrypted bit */</p>

<p class=BoxedCode>  <span lang=SV>ulData3Len =
sizeof(data)-ulData1Len-ulData2Len;</span></p>

<p class=BoxedCode><span lang=SV>  rv = C_DecryptFinal(</span></p>

<p class=BoxedCode><span lang=SV>    hSession,</span></p>

<p class=BoxedCode><span lang=SV>    &amp;data[ulData1Len+ulData2Len],
&amp;ulData3Len);</span></p>

<p class=BoxedCode><span lang=SV>  </span>if (rv != CKR_OK) {</p>

<p class=BoxedCode>     .</p>

<p class=BoxedCode>     .</p>

<p class=BoxedCode>  }</p>

<p class=BoxedCode>}</p>

</div>

<h2><a name="_Toc416959746"></a><a name="_Toc395183819"></a><a
name="_Toc391468823"></a><a name="_Toc370634032"></a><a name="_Toc235002365"></a><a
name="_Toc72656147"></a><a name="_Toc405794757"></a><a name="_Toc385057937">5.10
Message digesting</a> functions</h2>

<p class=MsoNormal>Cryptoki provides the following functions for digesting
data:<b> </b></p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002366"></a><a name="_Toc72656148"></a><a name="_Toc405794758"></a><a
name="_Toc385057938"></a><a name="_Toc383864908"></a><a name="_Toc323610901"></a><a
name="_Toc323205472"></a><a name="_Toc323024138"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_DigestInit</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_DigestInit)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_MECHANISM_PTR pMechanism<br>
);</p>

</div>

<p class=MsoNormal><b>C_DigestInit</b> initializes a message-digesting
operation. <i>hSession</i> is the session’s handle; <i>pMechanism</i> points to
the digesting mechanism.</p>

<p class=MsoNormal>After calling <b>C_DigestInit</b>, the application can
either call <b>C_Digest</b> to digest data in a single part; or call <b>C_DigestUpdate</b>
zero or more times, followed by <b>C_DigestFinal</b>, to digest data in
multiple parts.  The message-digesting operation is active until the
application uses a call to <b>C_Digest</b> or <b>C_DigestFinal</b> <i>to
actually obtain</i> the message digest.  To process additional data (in single
or multiple parts), the application MUST call <b>C_DigestInit</b> again.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR,
CKR_HOST_MEMORY, CKR_MECHANISM_INVALID, CKR_MECHANISM_PARAM_INVALID, CKR_OK,
CKR_OPERATION_ACTIVE, CKR_PIN_EXPIRED, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:  see <b>C_DigestFinal</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002367"></a><a name="_Toc72656149"></a><a name="_Toc405794759"></a><a
name="_Toc385057939"></a><a name="_Toc383864909"></a><a name="_Toc323610902"></a><a
name="_Toc323205473"></a><a name="_Toc323024139"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_Digest</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_Digest)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pData,<br>
  CK_ULONG ulDataLen,<br>
  CK_BYTE_PTR pDigest,<br>
  CK_ULONG_PTR pulDigestLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_Digest</b> digests data in a single part. <i>hSession</i>
is the session’s handle, <i>pData</i> points to the data; <i>ulDataLen</i> is
the length of the data; <i>pDigest</i> points to the location that receives the
message digest; <i>pulDigestLen</i> points to the location that holds the
length of the message digest.</p>

<p class=MsoNormal><b>C_Digest</b> uses the convention described in Section 5.2 on producing output.</p>

<p class=MsoNormal>The digest operation MUST have been initialized with <b>C_DigestInit</b>. 
A call to <b>C_Digest</b> always terminates the active digest operation unless
it returns CKR_BUFFER_TOO_SMALL or is a successful call (<i>i.e.</i>, one which
returns CKR_OK) to determine the length of the buffer needed to hold the
message digest.</p>

<p class=MsoNormal><b>C_Digest<i> </i></b>cannot be used to terminate a
multi-part operation, and MUST be called after <b>C_DigestInit</b> without
intervening <b>C_DigestUpdate</b> calls.</p>

<p class=MsoNormal>The input data and digest output can be in the same place, <i>i.e.</i>,
it is OK if <i>pData</i> and <i>pDigest</i> point to the same location.</p>

<p class=MsoNormal><b>C_Digest</b> is equivalent to a sequence of <b>C_DigestUpdate</b>
operations followed by <b>C_DigestFinal</b>.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK, CKR_OPERATION_NOT_INITIALIZED,
CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal>Example: see <b>C_DigestFinal</b> for an example of similar
functions.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002368"></a><a name="_Toc72656150"></a><a name="_Toc405794760"></a><a
name="_Toc385057940"></a><a name="_Toc383864910"></a><a name="_Toc323610903"></a><a
name="_Toc323205474"></a><a name="_Toc323024140"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_DigestUpdate</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_DigestUpdate)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pPart,<br>
  CK_ULONG ulPartLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_DigestUpdate</b> continues a multiple-part
message-digesting operation, processing another data part. <i>hSession</i> is
the session’s handle, <i>pPart</i> points to the data part; <i>ulPartLen</i> is
the length of the data part.</p>

<p class=MsoNormal><a name="_Toc319287681">The message-digesting operation MUST
have been initialized with <b>C_DigestInit</b>. Calls to this function and <b>C_DigestKey</b>
may be interspersed any number of times in any order.  A call to <b>C_DigestUpdate</b>
which results in an error terminates the current digest operation.</a></p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK, CKR_OPERATION_NOT_INITIALIZED,
CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal>Example:  see <b>C_DigestFinal</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc383864911"></a><a name="_Toc323610904"></a><a name="_Toc323205475"></a><a
name="_Toc323024141"></a><a name="_Toc235002369"></a><a name="_Toc72656151"></a><a
name="_Toc405794761"></a><a name="_Toc385057941"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_DigestKey</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_DigestKey)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_OBJECT_HANDLE hKey<br>
);</p>

</div>

<p class=MsoNormal><b>C_DigestKey</b> continues a multiple-part
message-digesting operation by digesting the value of a secret key.  <i>hSession</i>
is the session’s handle; <i>hKey</i> is the handle of the secret key to be
digested.</p>

<p class=MsoNormal>The message-digesting operation MUST have been initialized
with <b>C_DigestInit</b>.  Calls to this function and <b>C_DigestUpdate</b> may
be interspersed any number of times in any order.</p>

<p class=MsoNormal>If the value of the supplied key cannot be digested purely
for some reason related to its length, <b>C_DigestKey</b> should return the
error code CKR_KEY_SIZE_RANGE.</p>

<p class=MsoNormal>Return values: CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_KEY_HANDLE_INVALID,
CKR_KEY_INDIGESTIBLE, CKR_KEY_SIZE_RANGE, CKR_OK,
CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal>Example: see <b>C_DigestFinal</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002370"></a><a name="_Toc72656152"></a><a name="_Toc405794762"></a><a
name="_Toc385057942"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>C_DigestFinal</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_DigestFinal)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pDigest,<br>
  CK_ULONG_PTR pulDigestLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_DigestFinal</b> finishes a multiple-part
message-digesting operation, returning the message digest. <i>hSession</i> is
the session’s handle; <i>pDigest</i> points to the location that receives the
message digest; <i>pulDigestLen</i> points to the location that holds the
length of the message digest.</p>

<p class=MsoNormal><b>C_DigestFinal</b> uses the convention described in
Section 5.2 on producing output.</p>

<p class=MsoNormal>The digest operation MUST have been initialized with <b>C_DigestInit</b>. 
A call to <b>C_DigestFinal</b> always terminates the active digest operation
unless it returns CKR_BUFFER_TOO_SMALL or is a successful call (<i>i.e.</i>,
one which returns CKR_OK) to determine the length of the buffer needed to hold
the message digest.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK, CKR_OPERATION_NOT_INITIALIZED,
CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal><a name="_Toc319315708"></a><a name="_Toc319313715"></a><a
name="_Toc319313522"></a><a name="_Toc319287682">Example:</a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_MECHANISM mechanism = {</p>

<p class=BoxedCode>  CKM_MD5, NULL_PTR, 0</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_BYTE data[] = {...};</p>

<p class=BoxedCode>CK_BYTE digest[16];</p>

<p class=BoxedCode><span lang=SV>CK_ULONG ulDigestLen;</span></p>

<p class=BoxedCode><span lang=SV>CK_RV rv;</span></p>

<p class=BoxedCode><span lang=SV>&nbsp;</span></p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>rv = C_DigestInit(hSession, &amp;mechanism);</p>

<p class=BoxedCode>if (rv != CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>rv = C_DigestUpdate(hSession, data, sizeof(data));</p>

<p class=BoxedCode>if (rv != CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>rv = C_DigestKey(hSession, hKey);</p>

<p class=BoxedCode>if (rv != <span lang=DE>CKR_OK) {</span></p>

<p class=BoxedCode><span lang=DE>  .</span></p>

<p class=BoxedCode><span lang=DE>  .</span></p>

<p class=BoxedCode><span lang=DE style='font-family:"Arial","sans-serif"'>}</span></p>

<p class=BoxedCode><span lang=DE style='font-family:"Arial","sans-serif"'>&nbsp;</span></p>

<p class=BoxedCode><span lang=DE style='font-family:"Arial","sans-serif"'>ulDigestLen
= sizeof(digest);</span></p>

<p class=BoxedCode><span lang=DE style='font-family:"Arial","sans-serif"'>rv =
C_DigestFinal(hSession, digest, &amp;ulDigestLen);</span></p>

<p class=BoxedCode><span style='font-family:"Arial","sans-serif"'>.</span></p>

<p class=BoxedCode><span style='font-family:"Arial","sans-serif"'>.</span></p>

</div>

<h2><a name="_Toc416959747"></a><a name="_Toc395183820"></a><a
name="_Toc391468824"></a><a name="_Toc370634033"></a><a name="_Toc235002371"></a><a
name="_Toc72656153"></a><a name="_Toc405794763"></a><a name="_Toc385057943"></a><a
name="_Toc383864912"></a><a name="_Toc323610905"></a><a name="_Toc323205476"></a><a
name="_Toc323024142"></a><a name="_Toc323000713"></a><a name="_Toc322945146"></a><a
name="_Toc322855304">5.11 Sign</a>ing and MACing functions</h2>

<p class=MsoNormal>Cryptoki provides the following functions for signing data
(for the purposes of Cryptoki, these operations also encompass message
authentication codes):<b> </b></p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002372"></a><a name="_Toc72656154"></a><a name="_Toc405794764"></a><a
name="_Toc385057944"></a><a name="_Toc383864913"></a><a name="_Toc323610906"></a><a
name="_Toc323205477"></a><a name="_Toc323024143"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_SignInit</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_SignInit)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_MECHANISM_PTR pMechanism,<br>
  CK_OBJECT_HANDLE hKey<br>
);</p>

</div>

<p class=MsoNormal><b>C_SignInit</b> initializes a signature operation, where
the signature is an appendix to the data. <i>hSession</i> is the session’s
handle; <i>pMechanism</i> points to the signature mechanism; <i>hKey</i> is the
handle of the signature key.</p>

<p class=MsoNormal>The <b>CKA_SIGN</b> attribute of the signature key, which
indicates whether the key supports signatures with appendix, MUST be CK_TRUE.</p>

<p class=MsoNormal>After calling <b>C_SignInit</b>, the application can either
call <b>C_Sign</b> to sign in a single part; or call <b>C_SignUpdate</b> one or
more times, followed by <b>C_SignFinal,</b> to sign data in multiple parts. 
The signature operation is active until the application uses a call to <b>C_Sign</b>
or <b>C_SignFinal</b> <i>to actually obtain</i> the signature.  To process
additional data (in single or multiple parts), the application MUST call <b>C_SignInit</b>
again.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY,
CKR_KEY_FUNCTION_NOT_PERMITTED,CKR_KEY_HANDLE_INVALID, CKR_KEY_SIZE_RANGE,
CKR_KEY_TYPE_INCONSISTENT, CKR_MECHANISM_INVALID, CKR_MECHANISM_PARAM_INVALID,
CKR_OK, CKR_OPERATION_ACTIVE, CKR_PIN_EXPIRED, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:  see <b>C_SignFinal</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002373"></a><a name="_Toc72656155"></a><a name="_Toc405794765"></a><a
name="_Toc385057945"></a><a name="_Toc383864914"></a><a name="_Toc323610907"></a><a
name="_Toc323205478"></a><a name="_Toc323024144"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_Sign</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_Sign)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pData,<br>
  CK_ULONG ulDataLen,<br>
  CK_BYTE_PTR pSignature,<br>
  CK_ULONG_PTR pulSignatureLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_Sign</b> signs data in a single part, where the
signature is an appendix to the data. <i>hSession</i> is the session’s handle; <i>pData</i>
points to the data; <i>ulDataLen</i> is the length of the data; <i>pSignature</i>
points to the location that receives the signature; <i>pulSignatureLen</i>
points to the location that holds the length of the signature.</p>

<p class=MsoNormal><b>C_Sign</b> uses the convention described in Section 5.2 on producing output.</p>

<p class=MsoNormal>The signing operation MUST have been initialized with <b>C_SignInit</b>. 
A call to <b>C_Sign</b> always terminates the active signing operation unless
it returns CKR_BUFFER_TOO_SMALL or is a successful call (<i>i.e.</i>, one which
returns CKR_OK) to determine the length of the buffer needed to hold the
signature.</p>

<p class=MsoNormal><b>C_Sign<i> </i></b>cannot be used to terminate a
multi-part operation, and MUST be called after <b>C_SignInit</b> without
intervening <b>C_SignUpdate</b> calls.</p>

<p class=MsoNormal>For most mechanisms, <b>C_Sign</b> is equivalent to a
sequence of <b>C_SignUpdate</b> operations followed by <b>C_SignFinal</b>.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DATA_INVALID, CKR_DATA_LEN_RANGE,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK,
CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID,
CKR_USER_NOT_LOGGED_IN, CKR_FUNCTION_REJECTED.</p>

<p class=MsoNormal>Example: see <b>C_SignFinal</b> for an example of similar
functions.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002374"></a><a name="_Toc72656156"></a><a name="_Toc405794766"></a><a
name="_Toc385057946"></a><a name="_Toc383864915"></a><a name="_Toc323610908"></a><a
name="_Toc323205479"></a><a name="_Toc323024145"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_SignUpdate</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_SignUpdate)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pPart,<br>
  CK_ULONG ulPartLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_SignUpdate</b> continues a multiple-part signature
operation, processing another data part. <i>hSession</i> is the session’s
handle, <i>pPart</i> points to the data part; <i>ulPartLen</i> is the length of
the data part.</p>

<p class=MsoNormal>The signature operation MUST have been initialized with <b>C_SignInit</b>.
This function may be called any number of times in succession.  A call to <b>C_SignUpdate</b>
which results in an error terminates the current signature operation.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DATA_LEN_RANGE, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK,
CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID,
CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:  see <b>C_SignFinal</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002375"></a><a name="_Toc72656157"></a><a name="_Toc405794767"></a><a
name="_Toc385057947"></a><a name="_Toc383864916"></a><a name="_Toc323610909"></a><a
name="_Toc323205480"></a><a name="_Toc323024146"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_SignFinal</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_SignFinal)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pSignature,<br>
  CK_ULONG_PTR pulSignatureLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_SignFinal</b> finishes a multiple-part signature
operation, returning the signature. <i>hSession</i> is the session’s handle; <i>pSignature</i>
points to the location that receives the signature; <i>pulSignatureLen</i>
points to the location that holds the length of the signature.</p>

<p class=MsoNormal><b>C_SignFinal</b> uses the convention described in Section 5.2 on producing output.</p>

<p class=MsoNormal>The signing operation MUST have been initialized with <b>C_SignInit</b>. 
A call to <b>C_SignFinal</b> always terminates the active signing operation
unless it returns CKR_BUFFER_TOO_SMALL or is a successful call (<i>i.e.</i>,
one which returns CKR_OK) to determine the length of the buffer needed to hold
the signature.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DATA_LEN_RANGE, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK, CKR_OPERATION_NOT_INITIALIZED,
CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID, CKR_USER_NOT_LOGGED_IN,
CKR_FUNCTION_REJECTED.</p>

<p class=MsoNormal>Example: </p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hKey;</p>

<p class=BoxedCode>CK_MECHANISM mechanism = {</p>

<p class=BoxedCode>  CKM_DES_MAC, NULL_PTR, 0</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_BYTE data[] = {...};</p>

<p class=BoxedCode>CK_BYTE mac[4];</p>

<p class=BoxedCode>CK_ULONG ulMacLen;</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>rv = C_SignInit(hSession, &amp;mechanism, hKey);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  rv = C_SignUpdate(hSession, data, sizeof(data));</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  ulMacLen = sizeof(mac);</p>

<p class=BoxedCode>  rv = C_SignFinal(hSession, mac, &amp;ulMacLen);</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002376"></a><a name="_Toc72656158"></a><a name="_Toc405794768"></a><a
name="_Toc385057948"></a><a name="_Toc383864917"></a><a name="_Toc323610910"></a><a
name="_Toc323205481"></a><a name="_Toc323024147"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_SignRecoverInit</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_SignRecoverInit)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_MECHANISM_PTR pMechanism,<br>
  CK_OBJECT_HANDLE hKey<br>
);</p>

</div>

<p class=MsoNormal><b>C_SignRecoverInit</b> initializes a signature operation,
where the data can be recovered from the signature. <i>hSession</i> is the
session’s handle; <i>pMechanism</i> points to the structure that specifies the
signature mechanism; <i>hKey</i> is the handle of the signature key.</p>

<p class=MsoNormal>The <b>CKA_SIGN_RECOVER </b>attribute of the signature key,
which indicates whether the key supports signatures where the data can be
recovered from the signature, MUST be CK_TRUE.</p>

<p class=MsoNormal>After calling <b>C_SignRecoverInit</b>, the application may
call <b>C_SignRecover</b> to sign in a single part.  The signature operation is
active until the application uses a call to <b>C_SignRecover</b> <i>to actually
obtain</i> the signature.  To process additional data in a single part, the
application MUST call <b>C_SignRecoverInit</b> again.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY,
CKR_KEY_FUNCTION_NOT_PERMITTED, CKR_KEY_HANDLE_INVALID, CKR_KEY_SIZE_RANGE,
CKR_KEY_TYPE_INCONSISTENT, CKR_MECHANISM_INVALID, CKR_MECHANISM_PARAM_INVALID,
CKR_OK, CKR_OPERATION_ACTIVE, CKR_PIN_EXPIRED, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example: see <b>C_SignRecover</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002377"></a><a name="_Toc72656159"></a><a name="_Toc405794769"></a><a
name="_Toc385057949"></a><a name="_Toc383864918"></a><a name="_Toc323610911"></a><a
name="_Toc323205482"></a><a name="_Toc323024148"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_SignRecover</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_SignRecover)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pData,<br>
  CK_ULONG ulDataLen,<br>
  CK_BYTE_PTR pSignature,<br>
  CK_ULONG_PTR pulSignatureLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_SignRecover</b> signs data in a single operation, where
the data can be recovered from the signature. <i>hSession</i> is the session’s
handle; <i>pData</i> points to the data; <i>uLDataLen</i> is the length of the
data; <i>pSignature</i> points to the location that receives the signature; <i>pulSignatureLen</i>
points to the location that holds the length of the signature.</p>

<p class=MsoNormal><b>C_SignRecover</b> uses the convention described in Section
5.2 on producing output.</p>

<p class=MsoNormal>The signing operation MUST have been initialized with <b>C_SignRecoverInit</b>. 
A call to <b>C_SignRecover</b> always terminates the active signing operation
unless it returns CKR_BUFFER_TOO_SMALL or is a successful call (<i>i.e.</i>,
one which returns CKR_OK) to determine the length of the buffer needed to hold
the signature.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DATA_INVALID, CKR_DATA_LEN_RANGE, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK,
CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID,
CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hKey;</p>

<p class=BoxedCode>CK_MECHANISM mechanism = {</p>

<p class=BoxedCode>  CKM_RSA_9796, NULL_PTR, 0</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_BYTE data[] = {...};</p>

<p class=BoxedCode>CK_BYTE signature[128];</p>

<p class=BoxedCode>CK_ULONG ulSignatureLen;</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>rv = C_SignRecoverInit(hSession, &amp;mechanism, hKey);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  ulSignatureLen = sizeof(signature);</p>

<p class=BoxedCode>  rv = C_SignRecover(</p>

<p class=BoxedCode>    hSession, data, sizeof(data), signature,
&amp;ulSignatureLen);</p>

<p class=BoxedCode>  if (rv == CKR_OK) {</p>

<p class=BoxedCode>     .</p>

<p class=BoxedCode>     .</p>

<p class=BoxedCode>  }</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode><a name="_Toc235002378"></a><a name="_Toc72656160"></a><a
name="_Toc405794770"></a><a name="_Toc385057950">Functions for verifying
signatures and MACs</a></p>

</div>

<p class=MsoNormal>Cryptoki provides the following functions for verifying
signatures on data (for the purposes of Cryptoki, these operations also
encompass message authentication codes):<b> </b></p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002379"></a><a name="_Toc72656161"></a><a name="_Toc405794771"></a><a
name="_Toc385057951"></a><a name="_Toc383864919"></a><a name="_Toc323610912"></a><a
name="_Toc323205483"></a><a name="_Toc323024149"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_VerifyInit</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_VerifyInit)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_MECHANISM_PTR pMechanism,<br>
  CK_OBJECT_HANDLE hKey<br>
);</p>

</div>

<p class=MsoNormal><b>C_VerifyInit</b> initializes a verification operation,
where the signature is an appendix to the data. <i>hSession</i> is the
session’s handle; <i>pMechanism</i> points to the structure that specifies the
verification mechanism; <i>hKey</i> is the handle of the verification key.</p>

<p class=MsoNormal>The <b>CKA_VERIFY</b> attribute of the verification key,
which indicates whether the key supports verification where the signature is an
appendix to the data, MUST be CK_TRUE.</p>

<p class=MsoNormal>After calling <b>C_VerifyInit</b>, the application can
either call <b>C_Verify</b> to verify a signature on data in a single part; or
call <b>C_VerifyUpdate</b> one or more times, followed by <b>C_VerifyFinal,</b>
to verify a signature on data in multiple parts.  The verification operation is
active until the application calls <b>C_Verify</b> or <b>C_VerifyFinal</b>. To
process additional data (in single or multiple parts), the application MUST
call <b>C_VerifyInit</b> again.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_KEY_FUNCTION_NOT_PERMITTED,
CKR_KEY_HANDLE_INVALID, CKR_KEY_SIZE_RANGE, CKR_KEY_TYPE_INCONSISTENT,
CKR_MECHANISM_INVALID, CKR_MECHANISM_PARAM_INVALID, CKR_OK,
CKR_OPERATION_ACTIVE, CKR_PIN_EXPIRED, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:  see <b>C_VerifyFinal</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002380"></a><a name="_Toc72656162"></a><a name="_Toc405794772"></a><a
name="_Toc385057952"></a><a name="_Toc383864920"></a><a name="_Toc323610913"></a><a
name="_Toc323205484"></a><a name="_Toc323024150"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_Verify</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_Verify)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pData,<br>
  CK_ULONG ulDataLen,<br>
  CK_BYTE_PTR pSignature,<br>
  CK_ULONG ulSignatureLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_Verify</b> verifies a signature in a single-part
operation, where the signature is an appendix to the data. <i>hSession</i> is
the session’s handle; <i>pData</i> points to the data; <i>ulDataLen</i> is the
length of the data; <i>pSignature</i> points to the signature; <i>ulSignatureLen</i>
is the length of the signature.</p>

<p class=MsoNormal>The verification operation MUST have been initialized with <b>C_VerifyInit</b>. 
A call to <b>C_Verify</b> always terminates the active verification operation.</p>

<p class=MsoNormal>A successful call to <b>C_Verify</b> should return either
the value CKR_OK (indicating that the supplied signature is valid) or
CKR_SIGNATURE_INVALID (indicating that the supplied signature is invalid).  If
the signature can be seen to be invalid purely on the basis of its length, then
CKR_SIGNATURE_LEN_RANGE should be returned.  In any of these cases, the active
signing operation is terminated.</p>

<p class=MsoNormal><b>C_Verify<i> </i></b>cannot be used to terminate a
multi-part operation, and MUST be called after <b>C_VerifyInit</b> without
intervening <b>C_VerifyUpdate</b> calls.</p>

<p class=MsoNormal>For most mechanisms, <b>C_Verify</b> is equivalent to a sequence
of <b>C_VerifyUpdate</b> operations followed by <b>C_VerifyFinal</b>.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DATA_INVALID, CKR_DATA_LEN_RANGE,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK,
CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID,
CKR_SIGNATURE_INVALID, CKR_SIGNATURE_LEN_RANGE.</p>

<p class=MsoNormal>Example: see <b>C_VerifyFinal</b> for an example of similar
functions.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002381"></a><a name="_Toc72656163"></a><a name="_Toc405794773"></a><a
name="_Toc385057953"></a><a name="_Toc383864921"></a><a name="_Toc323610914"></a><a
name="_Toc323205485"></a><a name="_Toc323024151"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_VerifyUpdate</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_VerifyUpdate)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pPart,<br>
  CK_ULONG ulPartLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_VerifyUpdate</b> continues a multiple-part verification
operation, processing another data part. <i>hSession</i> is the session’s
handle, <i>pPart</i> points to the data part; <i>ulPartLen</i> is the length of
the data part.</p>

<p class=MsoNormal>The verification operation MUST have been initialized with <b>C_VerifyInit</b>.
This function may be called any number of times in succession.  A call to <b>C_VerifyUpdate</b>
which results in an error terminates the current verification operation.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DATA_LEN_RANGE, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK,
CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal>Example:  see <b>C_VerifyFinal</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002382"></a><a name="_Toc72656164"></a><a name="_Toc405794774"></a><a
name="_Toc385057954"></a><a name="_Toc383864922"></a><a name="_Toc323610915"></a><a
name="_Toc323205486"></a><a name="_Toc323024152"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_VerifyFinal</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_VerifyFinal)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pSignature,<br>
  CK_ULONG ulSignatureLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_VerifyFinal</b> finishes a multiple-part verification
operation, checking the signature. <i>hSession</i> is the session’s handle; <i>pSignature</i>
points to the signature; <i>ulSignatureLen</i> is the length of the signature.</p>

<p class=MsoNormal>The verification operation MUST have been initialized with <b>C_VerifyInit</b>. 
A call to <b>C_VerifyFinal</b> always terminates the active verification
operation.</p>

<p class=MsoNormal>A successful call to <b>C_VerifyFinal</b> should return
either the value CKR_OK (indicating that the supplied signature is valid) or
CKR_SIGNATURE_INVALID (indicating that the supplied signature is invalid).  If
the signature can be seen to be invalid purely on the basis of its length, then
CKR_SIGNATURE_LEN_RANGE should be returned.  In any of these cases, the active
verifying operation is terminated.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DATA_LEN_RANGE, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK,
CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID,
CKR_SIGNATURE_INVALID, CKR_SIGNATURE_LEN_RANGE.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hKey;</p>

<p class=BoxedCode>CK_MECHANISM mechanism = {</p>

<p class=BoxedCode>  CKM_DES_MAC, NULL_PTR, 0</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_BYTE data[] = {...};</p>

<p class=BoxedCode>CK_BYTE mac[4];</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>rv = C_VerifyInit(hSession, &amp;mechanism, hKey);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  rv = C_VerifyUpdate(hSession, data, sizeof(data));</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  rv = C_VerifyFinal(hSession, mac, sizeof(mac));</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002383"></a><a name="_Toc72656165"></a><a name="_Toc405794775"></a><a
name="_Toc385057955"></a><a name="_Toc383864923"></a><a name="_Toc323610916"></a><a
name="_Toc323205487"></a><a name="_Toc323024153"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_VerifyRecoverInit</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_VerifyRecoverInit)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_MECHANISM_PTR pMechanism,<br>
  CK_OBJECT_HANDLE hKey<br>
);</p>

</div>

<p class=MsoNormal><b>C_VerifyRecoverInit</b> initializes a signature
verification operation, where the data is recovered from the signature. <i>hSession</i>
is the session’s handle; <i>pMechanism</i> points to the structure that
specifies the verification mechanism; <i>hKey</i> is the handle of the
verification key.</p>

<p class=MsoNormal>The <b>CKA_VERIFY_RECOVER</b> attribute of the verification
key, which indicates whether the key supports verification where the data is
recovered from the signature, MUST be CK_TRUE.</p>

<p class=MsoNormal>After calling <b>C_VerifyRecoverInit</b>, the application
may call <b>C_VerifyRecover</b> to verify a signature on data in a single
part.  The verification operation is active until the application uses a call
to <b>C_VerifyRecover</b> <i>to actually obtain</i> the recovered message.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_KEY_FUNCTION_NOT_PERMITTED,
CKR_KEY_HANDLE_INVALID, CKR_KEY_SIZE_RANGE, CKR_KEY_TYPE_INCONSISTENT,
CKR_MECHANISM_INVALID, CKR_MECHANISM_PARAM_INVALID, CKR_OK,
CKR_OPERATION_ACTIVE, CKR_PIN_EXPIRED, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:  see <b>C_VerifyRecover</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002384"></a><a name="_Toc72656166"></a><a name="_Toc405794776"></a><a
name="_Toc385057956"></a><a name="_Toc383864924"></a><a name="_Toc323610917"></a><a
name="_Toc323205488"></a><a name="_Toc323024154"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_VerifyRecover</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_VerifyRecover)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pSignature,<br>
  CK_ULONG ulSignatureLen,<br>
  CK_BYTE_PTR pData,<br>
  CK_ULONG_PTR pulDataLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_VerifyRecover</b> verifies a signature in a single-part
operation, where the data is recovered from the signature. <i>hSession</i> is
the session’s handle; <i>pSignature</i> points to the signature; <i>ulSignatureLen</i>
is the length of the signature; <i>pData </i>points to the location that
receives the recovered data; and <i>pulDataLen</i> points to the location that
holds the length of the recovered data.</p>

<p class=MsoNormal><a name="_Toc319287684"><b>C_VerifyRecover</b> uses the
convention described in Section </a>5.2 on producing output.</p>

<p class=MsoNormal>The verification operation MUST have been initialized with <b>C_VerifyRecoverInit</b>. 
A call to <b>C_VerifyRecover</b> always terminates the active verification
operation unless it returns CKR_BUFFER_TOO_SMALL or is a successful call (<i>i.e.</i>,
one which returns CKR_OK) to determine the length of the buffer needed to hold
the recovered data.</p>

<p class=MsoNormal>A successful call to <b>C_VerifyRecover</b> should return
either the value CKR_OK (indicating that the supplied signature is valid) or
CKR_SIGNATURE_INVALID (indicating that the supplied signature is invalid).  If
the signature can be seen to be invalid purely on the basis of its length, then
CKR_SIGNATURE_LEN_RANGE should be returned.  The return codes
CKR_SIGNATURE_INVALID and CKR_SIGNATURE_LEN_RANGE have a higher priority than
the return code CKR_BUFFER_TOO_SMALL, <i>i.e.</i>, if <b>C_VerifyRecover</b> is
supplied with an invalid signature, it will never return CKR_BUFFER_TOO_SMALL.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DATA_INVALID, CKR_DATA_LEN_RANGE,
CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK,
CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID,
CKR_SIGNATURE_LEN_RANGE, CKR_SIGNATURE_INVALID.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>C<a name="_Ref320412176">K_SESSION_HANDLE hSession;</a></p>

<p class=BoxedCode>CK_OBJECT_HANDLE hKey;</p>

<p class=BoxedCode>CK_MECHANISM mechanism = {</p>

<p class=BoxedCode>  CKM_RSA_9796, NULL_PTR, 0</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_BYTE data[] = {...};</p>

<p class=BoxedCode>CK_ULONG ulDataLen;</p>

<p class=BoxedCode>CK_BYTE signature[128];</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>rv = C_VerifyRecoverInit(hSession, &amp;mechanism, hKey);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  ulDataLen = sizeof(data);</p>

<p class=BoxedCode>  rv = C_VerifyRecover(</p>

<p class=BoxedCode>    hSession, signature, sizeof(signature), data,
&amp;ulDataLen);</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<h2><a name="_Toc416959748"></a><a name="_Toc395183821"></a><a
name="_Toc391468825"></a><a name="_Toc370634034"></a><a name="_Toc235002385"></a><a
name="_Toc72656167"></a><a name="_Toc405794777"></a><a name="_Toc385057957"></a><a
name="_Ref384486862"></a><a name="_Ref384459262"></a><a name="_Ref384459019">5.12
Dual-function cryptographic functions</a></h2>

<p class=MsoNormal>Cryptoki provides the following functions to perform two
cryptographic operations “simultaneously” within a session.  These functions
are provided so as to avoid unnecessarily passing data back and forth to and
from a token.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002386"></a><a name="_Toc72656168"></a><a name="_Toc405794778"></a><a
name="_Toc385057958"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>C_DigestEncryptUpdate</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_DigestEncryptUpdate)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pPart,<br>
  CK_ULONG ulPartLen,<br>
  CK_BYTE_PTR pEncryptedPart,<br>
  CK_ULONG_PTR pulEncryptedPartLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_DigestEncryptUpdate</b> continues multiple-part digest
and encryption operations, processing another data part. <i>hSession</i> is the
session’s handle; <i>pPart</i> points to the data part; <i>ulPartLen</i> is the
length of the data part; <i>pEncryptedPart</i> points to the location that
receives the digested and encrypted data part; <i>pulEncryptedPartLen</i>
points to the location that holds the length of the encrypted data part.</p>

<p class=MsoNormal><b>C_DigestEncryptUpdate</b> uses the convention described
in Section 5.2 on producing output.  If a <b>C_DigestEncryptUpdate</b> call
does not produce encrypted output (because an error occurs, or because <i>pEncryptedPart</i>
has the value NULL_PTR, or because <i>pulEncryptedPartLen</i> is too small to
hold the entire encrypted part output), then no plaintext is passed to the
active digest operation.</p>

<p class=MsoNormal>Digest and encryption operations MUST both be active (they MUST
have been initialized with <b>C_DigestInit</b> and <b>C_EncryptInit,</b>
respectively).  This function may be called any number of times in succession,
and may be interspersed with <b>C_DigestUpdate</b>, <b>C_DigestKey</b>, and <b>C_EncryptUpdate</b>
calls (it would be somewhat unusual to intersperse calls to <b>C_DigestEncryptUpdate</b>
with calls to <b>C_DigestKey</b>, however).</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DATA_LEN_RANGE, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK,
CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>#define BUF_SZ 512</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hKey;</p>

<p class=BoxedCode>CK_BYTE iv[8];</p>

<p class=BoxedCode>CK_MECHANISM digestMechanism = {</p>

<p class=BoxedCode>  CKM_MD5, NULL_PTR, 0</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_MECHANISM encryptionMechanism = {</p>

<p class=BoxedCode>  <span lang=DE>CKM_DES_ECB, iv, sizeof(iv)</span></p>

<p class=BoxedCode><span lang=DE>};</span></p>

<p class=BoxedCode><span lang=DE>CK_BYTE encryptedData[BUF_SZ];</span></p>

<p class=BoxedCode><span lang=SV>CK_ULONG ulEncryptedDataLen;</span></p>

<p class=BoxedCode><span lang=SV>CK_BYTE digest[16];</span></p>

<p class=BoxedCode><span lang=SV>CK_ULONG ulDigestLen;</span></p>

<p class=BoxedCode><span lang=SV>CK_BYTE data[(2*BUF_SZ)+8];</span></p>

<p class=BoxedCode><span lang=SV>CK_RV rv;</span></p>

<p class=BoxedCode><span lang=SV>int i;</span></p>

<p class=BoxedCode><span lang=SV>&nbsp;</span></p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>memset(iv, 0, sizeof(iv));</p>

<p class=BoxedCode>memset(data, ‘A’, ((2*BUF_SZ)+5));</p>

<p class=BoxedCode>rv = C_EncryptInit(hSession, &amp;encryptionMechanism,
hKey);</p>

<p class=BoxedCode>if (rv != <span lang=DE-CH>CKR_OK) {</span></p>

<p class=BoxedCode><span lang=DE-CH>  .</span></p>

<p class=BoxedCode><span lang=DE-CH>  .</span></p>

<p class=BoxedCode><span lang=DE-CH>}</span></p>

<p class=BoxedCode><span lang=DE-CH>rv = C_DigestInit(hSession,
&amp;digestMechanism);</span></p>

<p class=BoxedCode>if (rv != CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>ulEncryptedDataLen = sizeof(encryptedData);</p>

<p class=BoxedCode>rv = C_DigestEncryptUpdate(</p>

<p class=BoxedCode>  hSession,</p>

<p class=BoxedCode>  &amp;data[0], BUF_SZ,</p>

<p class=BoxedCode>  encryptedData, &amp;ulEncryptedDataLen);</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>ulEncryptedDataLen = sizeof(encryptedData);</p>

<p class=BoxedCode>rv = C_DigestEncryptUpdate(</p>

<p class=BoxedCode>  hSession,</p>

<p class=BoxedCode>  &amp;data[BUF_SZ], BUF_SZ,</p>

<p class=BoxedCode>  encryptedData, &amp;ulEncryptedDataLen);</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/*</p>

<p class=BoxedCode> * The last portion of the buffer needs to be </p>

<p class=BoxedCode> * handled with separate calls to deal with </p>

<p class=BoxedCode> * padding issues in ECB mode</p>

<p class=BoxedCode> */</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* First, complete the digest on the buffer */</p>

<p class=BoxedCode><span lang=IT>rv = C_DigestUpdate(hSession,
&amp;data[BUF_SZ*2], 5);</span></p>

<p class=BoxedCode><span lang=DE>.</span></p>

<p class=BoxedCode><span lang=DE>.</span></p>

<p class=BoxedCode><span lang=DE>ulDigestLen = sizeof(digest);</span></p>

<p class=BoxedCode><span lang=DE>rv = C_DigestFinal(hSession, digest,
&amp;ulDigestLen);</span></p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Then, pad last part with 3 0x00 bytes, and complete
encryption */</p>

<p class=BoxedCode>for(i=0;i&lt;3;i++)</p>

<p class=BoxedCode>  data[((BUF_SZ*2)+5)+i] = 0x00;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Now, get second-to-last piece of ciphertext */</p>

<p class=BoxedCode>ulEncryptedDataLen = sizeof(encryptedData);</p>

<p class=BoxedCode>rv = C_EncryptUpdate(</p>

<p class=BoxedCode>  <span lang=IT>hSession,</span></p>

<p class=BoxedCode><span lang=IT>  &amp;data[BUF_SZ*2], 8,</span></p>

<p class=BoxedCode><span lang=IT>  encryptedData, &amp;ulEncryptedDataLen);</span></p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Get last piece of ciphertext (should have length 0, here)
*/</p>

<p class=BoxedCode>ulEncryptedDataLen = sizeof(encryptedData);</p>

<p class=BoxedCode>rv = C_EncryptFinal(hSession, encryptedData, &amp;ulEncryptedDataLen);</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002387"></a><a name="_Toc72656169"></a><a name="_Toc405794779"></a><a
name="_Toc385057959"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>C_DecryptDigestUpdate</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_DecryptDigestUpdate)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pEncryptedPart,<br>
  CK_ULONG ulEncryptedPartLen,<br>
  CK_BYTE_PTR pPart,<br>
  CK_ULONG_PTR pulPartLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_DecryptDigestUpdate</b> continues a multiple-part
combined decryption and digest operation, processing another data part. <i>hSession</i>
is the session’s handle; <i>pEncryptedPart</i> points to the encrypted data
part; <i>ulEncryptedPartLen</i> is the length of the encrypted data part; <i>pPart</i>
points to the location that receives the recovered data part; <i>pulPartLen</i>
points to the location that holds the length of the recovered data part.</p>

<p class=MsoNormal><b>C_DecryptDigestUpdate</b> uses the convention described
in Section 5.2 on producing output. If a <b>C_DecryptDigestUpdate</b> call does
not produce decrypted output (because an error occurs, or because <i>pPart</i>
has the value NULL_PTR, or because <i>pulPartLen</i> is too small to hold the
entire decrypted part output), then no plaintext is passed to the active digest
operation.</p>

<p class=MsoNormal>Decryption and digesting operations MUST both be active
(they MUST have been initialized with <b>C_DecryptInit</b> and <b>C_DigestInit,</b>
respectively).  This function may be called any number of times in succession,
and may be interspersed with <b>C_DecryptUpdate</b>, <b>C_DigestUpdate</b>, and
<b>C_DigestKey</b> calls (it would be somewhat unusual to intersperse calls to <b>C_DigestEncryptUpdate</b>
with calls to <b>C_DigestKey</b>, however).</p>

<p class=MsoNormal>Use of <b>C_DecryptDigestUpdate</b> involves a pipelining
issue that does not arise when using <b>C_DigestEncryptUpdate</b>, the “inverse
function” of <b>C_DecryptDigestUpdate</b>.  This is because when <b>C_DigestEncryptUpdate</b>
is called, precisely the same input is passed to both the active digesting
operation and the active encryption operation; however, when <b>C_DecryptDigestUpdate</b>
is called, the input passed to the active digesting operation is the <i>output
of</i> the active decryption operation.  This issue comes up only when the
mechanism used for decryption performs padding.</p>

<p class=MsoNormal>In particular, envision a 24-byte ciphertext which was
obtained by encrypting an 18-byte plaintext with DES in CBC mode with PKCS
padding.  Consider an application which will simultaneously decrypt this
ciphertext and digest the original plaintext thereby obtained.</p>

<p class=MsoNormal>After initializing decryption and digesting operations, the
application passes the 24-byte ciphertext (3 DES blocks) into <b>C_DecryptDigestUpdate</b>. 
<b>C_DecryptDigestUpdate</b> returns exactly 16 bytes of plaintext, since at
this point, Cryptoki doesn’t know if there’s more ciphertext coming, or if the
last block of ciphertext held any padding.  These 16 bytes of plaintext are
passed into the active digesting operation.</p>

<p class=MsoNormal>Since there is no more ciphertext, the application calls <b>C_DecryptFinal</b>. 
This tells Cryptoki that there’s no more ciphertext coming, and the call
returns the last 2 bytes of plaintext.  However, since the active decryption
and digesting operations are linked <i>only</i> through the <b>C_DecryptDigestUpdate</b>
call, these 2 bytes of plaintext are <i>not</i> passed on to be digested.</p>

<p class=MsoNormal>A call to <b>C_DigestFinal</b>, therefore, would compute the
message digest of <i>the first 16 bytes of the plaintext</i>, not the message
digest of the entire plaintext.  It is crucial that, before <b>C_DigestFinal</b>
is called, the last 2 bytes of plaintext get passed into the active digesting
operation via a <b>C_DigestUpdate</b> call.</p>

<p class=MsoNormal>Because of this, it is critical that when an application
uses a padded decryption mechanism with <b>C_DecryptDigestUpdate</b>, it knows
exactly how much plaintext has been passed into the active digesting
operation.  <i>Extreme caution is warranted when using a padded decryption
mechanism with <b>C_DecryptDigestUpdate</b>.</i></p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_ENCRYPTED_DATA_INVALID, CKR_ENCRYPTED_DATA_LEN_RANGE,
CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY,
CKR_OK, CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>#define BUF_SZ 512</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hKey;</p>

<p class=BoxedCode>CK_BYTE iv[8];</p>

<p class=BoxedCode>CK_MECHANISM decryptionMechanism = {</p>

<p class=BoxedCode>  CKM_DES_ECB, iv, sizeof(iv)</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_MECHANISM digestMechanism = {</p>

<p class=BoxedCode>  CKM_MD5, NULL_PTR, 0</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_BYTE encryptedData[(2*BUF_SZ)+8];</p>

<p class=BoxedCode><span lang=SV>CK_BYTE digest[16];</span></p>

<p class=BoxedCode><span lang=SV>CK_ULONG ulDigestLen;</span></p>

<p class=BoxedCode><span lang=SV>CK_BYTE data[BUF_SZ];</span></p>

<p class=BoxedCode><span lang=SV>CK_ULONG ulDataLen, ulLastUpdateSize;</span></p>

<p class=BoxedCode><span lang=SV>CK_RV rv;</span></p>

<p class=BoxedCode><span lang=SV>&nbsp;</span></p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>memset(iv, 0, sizeof(iv));</p>

<p class=BoxedCode>memset(encryptedData, ‘A’, ((2*BUF_SZ)+8));</p>

<p class=BoxedCode>rv = C_DecryptInit(hSession, &amp;decryptionMechanism,
hKey);</p>

<p class=BoxedCode>if (rv != CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>rv = C_DigestInit(hSession, &amp;digestMechanism);</p>

<p class=BoxedCode>if (rv != CKR_OK){</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>ulDataLen = sizeof(data);</p>

<p class=BoxedCode>rv = C_DecryptDigestUpdate(</p>

<p class=BoxedCode>  hSession,</p>

<p class=BoxedCode>  &amp;encryptedData[0], BUF_SZ,</p>

<p class=BoxedCode>  <span lang=IT>data, &amp;ulDataLen);</span></p>

<p class=BoxedCode><span lang=IT>.</span></p>

<p class=BoxedCode><span lang=IT>.</span></p>

<p class=BoxedCode><span lang=IT>ulDataLen = sizeof(data);</span></p>

<p class=BoxedCode><span lang=IT>rv = C_DecryptDigestUpdate(</span></p>

<p class=BoxedCode><span lang=IT>  hSession,</span></p>

<p class=BoxedCode><span lang=IT>  &amp;encryptedData[BUF_SZ], BUF_SZ,</span></p>

<p class=BoxedCode><span lang=IT>  </span>data, &amp;ulDataLen);</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/*</p>

<p class=BoxedCode> * The last portion of the buffer needs to be handled with </p>

<p class=BoxedCode> * separate calls to deal with padding issues in ECB mode</p>

<p class=BoxedCode> */</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* First, complete the decryption of the buffer */</p>

<p class=BoxedCode>ulLastUpdateSize = sizeof(data);</p>

<p class=BoxedCode>rv = C_DecryptUpdate(</p>

<p class=BoxedCode>  <span lang=IT>hSession,</span></p>

<p class=BoxedCode><span lang=IT>  &amp;encryptedData[BUF_SZ*2], 8,</span></p>

<p class=BoxedCode><span lang=IT>  data, &amp;ulLastUpdateSize);</span></p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>/* Get last piece of plaintext (should have length 0, here)
*/</p>

<p class=BoxedCode>ulDataLen = sizeof(data)-ulLastUpdateSize;</p>

<p class=BoxedCode>rv = C_DecryptFinal(hSession, &amp;data[ulLastUpdateSize],
&amp;ulDataLen);</p>

<p class=BoxedCode>if (rv != CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Digest last bit of plaintext */</p>

<p class=BoxedCode><span lang=IT>rv = C_DigestUpdate(hSession,
&amp;data[BUF_SZ*2], 5);</span></p>

<p class=BoxedCode><span lang=DE-CH>if (rv != </span><span lang=DE>CKR_OK) {</span></p>

<p class=BoxedCode><span lang=DE>  .</span></p>

<p class=BoxedCode><span lang=DE>  .</span></p>

<p class=BoxedCode><span lang=DE>}</span></p>

<p class=BoxedCode><span lang=DE>ulDigestLen = sizeof(digest);</span></p>

<p class=BoxedCode><span lang=DE>rv = C_DigestFinal(hSession, digest,
&amp;ulDigestLen);</span></p>

<p class=BoxedCode>if (rv != CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002388"></a><a name="_Toc72656170"></a><a name="_Toc405794780"></a><a
name="_Toc385057960"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>C_SignEncryptUpdate</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_SignEncryptUpdate)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pPart,<br>
  CK_ULONG ulPartLen,<br>
  CK_BYTE_PTR pEncryptedPart,<br>
  CK_ULONG_PTR pulEncryptedPartLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_SignEncryptUpdate</b> continues a multiple-part
combined signature and encryption operation, processing another data part. <i>hSession</i>
is the session’s handle; <i>pPart</i> points to the data part; <i>ulPartLen</i>
is the length of the data part; <i>pEncryptedPart</i> points to the location
that receives the digested and encrypted data part; and <i>pulEncryptedPartLen</i>
points to the location that holds the length of the encrypted data part.</p>

<p class=MsoNormal><b>C_SignEncryptUpdate</b> uses the convention described in
Section 5.2 on producing output.  If a <b>C_SignEncryptUpdate</b> call does not
produce encrypted output (because an error occurs, or because <i>pEncryptedPart</i>
has the value NULL_PTR, or because <i>pulEncryptedPartLen</i> is too small to
hold the entire encrypted part output), then no plaintext is passed to the
active signing operation.</p>

<p class=MsoNormal>Signature and encryption operations MUST both be active
(they MUST have been initialized with <b>C_SignInit</b> and <b>C_EncryptInit,</b>
respectively).  This function may be called any number of times in succession,
and may be interspersed with <b>C_SignUpdate</b> and <b>C_EncryptUpdate</b>
calls.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DATA_LEN_RANGE, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK,
CKR_OPERATION_NOT_INITIALIZED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID,
CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>#define BUF_SZ 512</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hEncryptionKey, hMacKey;</p>

<p class=BoxedCode>CK_BYTE iv[8];</p>

<p class=BoxedCode>CK_MECHANISM signMechanism = {</p>

<p class=BoxedCode>  CKM_DES_MAC, NULL_PTR, 0</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_MECHANISM encryptionMechanism = {</p>

<p class=BoxedCode>  CKM_DES_ECB, iv, sizeof(iv)</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_BYTE encryptedData[BUF_SZ];</p>

<p class=BoxedCode>CK_ULONG ulEncryptedDataLen;</p>

<p class=BoxedCode>CK_BYTE MAC[4];</p>

<p class=BoxedCode>CK_ULONG ulMacLen;</p>

<p class=BoxedCode>CK_BYTE data[(2*BUF_SZ)+8];</p>

<p class=BoxedCode><span lang=SV>CK_RV rv;</span></p>

<p class=BoxedCode><span lang=SV>int i;</span></p>

<p class=BoxedCode><span lang=SV>&nbsp;</span></p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>memset(iv, 0, sizeof(iv));</p>

<p class=BoxedCode>memset(data, ‘A’, ((2*BUF_SZ)+5));</p>

<p class=BoxedCode>rv = C_EncryptInit(hSession, &amp;encryptionMechanism,
hEncryptionKey);</p>

<p class=BoxedCode>if (rv != CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>rv = C_SignInit(hSession, &amp;signMechanism, hMacKey);</p>

<p class=BoxedCode>if (rv != CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>ulEncryptedDataLen = sizeof(encryptedData);</p>

<p class=BoxedCode>rv = C_SignEncryptUpdate(</p>

<p class=BoxedCode>  hSession,</p>

<p class=BoxedCode>  &amp;data[0], BUF_SZ,</p>

<p class=BoxedCode>  encryptedData, &amp;ulEncryptedDataLen);</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>ulEncryptedDataLen = sizeof(encryptedData);</p>

<p class=BoxedCode>rv = C_SignEncryptUpdate(</p>

<p class=BoxedCode>  hSession,</p>

<p class=BoxedCode>  &amp;data[BUF_SZ], BUF_SZ,</p>

<p class=BoxedCode>  encryptedData, &amp;ulEncryptedDataLen);</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/*</p>

<p class=BoxedCode> * The last portion of the buffer needs to be handled with </p>

<p class=BoxedCode> * separate calls to deal with padding issues in ECB mode</p>

<p class=BoxedCode> */</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* First, complete the signature on the buffer */</p>

<p class=BoxedCode><span lang=IT>rv = C_SignUpdate(hSession, &amp;data[BUF_SZ*2],
5);</span></p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>ulMacLen = sizeof(MAC);</p>

<p class=BoxedCode>rv = C_SignFinal(hSession, MAC, &amp;ulMacLen);</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Then pad last part with 3 0x00 bytes, and complete
encryption */</p>

<p class=BoxedCode>for(i=0;i&lt;3;i++)</p>

<p class=BoxedCode>  data[((BUF_SZ*2)+5)+i] = 0x00;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Now, get second-to-last piece of ciphertext */</p>

<p class=BoxedCode>ulEncryptedDataLen = sizeof(encryptedData);</p>

<p class=BoxedCode>rv = C_EncryptUpdate(</p>

<p class=BoxedCode>  <span lang=IT>hSession,</span></p>

<p class=BoxedCode><span lang=IT>  &amp;data[BUF_SZ*2], 8,</span></p>

<p class=BoxedCode><span lang=IT>  encryptedData, &amp;ulEncryptedDataLen);</span></p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Get last piece of ciphertext (should have length 0, here)
*/</p>

<p class=BoxedCode>ulEncryptedDataLen = sizeof(encryptedData);</p>

<p class=BoxedCode>rv = C_EncryptFinal(hSession, encryptedData,
&amp;ulEncryptedDataLen);</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002389"></a><a name="_Toc72656171"></a><a name="_Toc405794781"></a><a
name="_Toc385057961"><span style='font-family:Symbol;font-weight:normal'>¨<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-family:"Arial","sans-serif"'>C_DecryptVerifyUpdate</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_DecryptVerifyUpdate)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pEncryptedPart,<br>
  CK_ULONG ulEncryptedPartLen,<br>
  CK_BYTE_PTR pPart,<br>
  CK_ULONG_PTR pulPartLen<br>
);</p>

</div>

<p class=MsoNormal><a name="_Toc383864925"></a><a name="_Toc323610918"></a><a
name="_Toc323205489"></a><a name="_Toc323024155"></a><a name="_Toc323000714"></a><a
name="_Toc322945147"></a><a name="_Toc322855305"></a><a name="_Ref320514967"><b>C_DecryptVerifyUpdate</b>
continues a multiple-part combined decryption and verification operation,
processing another data part. <i>hSession</i> is the session’s handle; <i>pEncryptedPart</i>
points to the encrypted data; <i>ulEncryptedPartLen</i> is the length of the
encrypted data; <i>pPart</i> points to the location that receives the recovered
data; and <i>pulPartLen</i> points to the location that holds the length of the
recovered data.</a></p>

<p class=MsoNormal><b>C_DecryptVerifyUpdate</b> uses the convention described
in Section 5.2 on producing output.  If a <b>C_DecryptVerifyUpdate</b> call
does not produce decrypted output (because an error occurs, or because <i>pPart</i>
has the value NULL_PTR, or because <i>pulPartLen</i> is too small to hold the
entire encrypted part output), then no plaintext is passed to the active
verification operation.</p>

<p class=MsoNormal>Decryption and signature operations MUST both be active
(they MUST have been initialized with <b>C_DecryptInit</b> and <b>C_VerifyInit,</b>
respectively).  This function may be called any number of times in succession,
and may be interspersed with <b>C_DecryptUpdate</b> and <b>C_VerifyUpdate</b>
calls.</p>

<p class=MsoNormal>Use of <b>C_DecryptVerifyUpdate</b> involves a pipelining
issue that does not arise when using <b>C_SignEncryptUpdate</b>, the “inverse
function” of <b>C_DecryptVerifyUpdate</b>.  This is because when <b>C_SignEncryptUpdate</b>
is called, precisely the same input is passed to both the active signing
operation and the active encryption operation; however, when <b>C_DecryptVerifyUpdate</b>
is called, the input passed to the active verifying operation is the <i>output
of</i> the active decryption operation.  This issue comes up only when the
mechanism used for decryption performs padding.</p>

<p class=MsoNormal>In particular, envision a 24-byte ciphertext which was
obtained by encrypting an 18-byte plaintext with DES in CBC mode with PKCS
padding.  Consider an application which will simultaneously decrypt this
ciphertext and verify a signature on the original plaintext thereby obtained.</p>

<p class=MsoNormal>After initializing decryption and verification operations,
the application passes the 24-byte ciphertext (3 DES blocks) into <b>C_DecryptVerifyUpdate</b>. 
<b>C_DecryptVerifyUpdate</b> returns exactly 16 bytes of plaintext, since at
this point, Cryptoki doesn’t know if there’s more ciphertext coming, or if the
last block of ciphertext held any padding.  These 16 bytes of plaintext are
passed into the active verification operation.</p>

<p class=MsoNormal>Since there is no more ciphertext, the application calls <b>C_DecryptFinal</b>. 
This tells Cryptoki that there’s no more ciphertext coming, and the call
returns the last 2 bytes of plaintext.  However, since the active decryption
and verification operations are linked <i>only</i> through the <b>C_DecryptVerifyUpdate</b>
call, these 2 bytes of plaintext are <i>not</i> passed on to the verification
mechanism.</p>

<p class=MsoNormal>A call to <b>C_VerifyFinal</b>, therefore, would verify
whether or not the signature supplied is a valid signature on <i>the first 16
bytes of the plaintext</i>, not on the entire plaintext.  It is crucial that,
before <b>C_VerifyFinal</b> is called, the last 2 bytes of plaintext get passed
into the active verification operation via a <b>C_VerifyUpdate</b> call.</p>

<p class=MsoNormal>Because of this, it is critical that when an application
uses a padded decryption mechanism with <b>C_DecryptVerifyUpdate</b>, it knows
exactly how much plaintext has been passed into the active verification
operation.  <i>Extreme caution is warranted when using a padded decryption
mechanism with <b>C_DecryptVerifyUpdate</b>.</i></p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DATA_LEN_RANGE, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_ENCRYPTED_DATA_INVALID,
CKR_ENCRYPTED_DATA_LEN_RANGE, CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK, CKR_OPERATION_NOT_INITIALIZED,
CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>#define BUF_SZ 512</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hDecryptionKey, hMacKey;</p>

<p class=BoxedCode>CK_BYTE iv[8];</p>

<p class=BoxedCode>CK_MECHANISM decryptionMechanism = {</p>

<p class=BoxedCode>  <span lang=DE>CKM_DES_ECB, iv, sizeof(iv)</span></p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_MECHANISM verifyMechanism = {</p>

<p class=BoxedCode>  CKM_DES_MAC, NULL_PTR, 0</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_BYTE encryptedData[(2*BUF_SZ)+8];</p>

<p class=BoxedCode>CK_BYTE MAC[4];</p>

<p class=BoxedCode>CK_ULONG ulMacLen;</p>

<p class=BoxedCode>CK_BYTE data[BUF_SZ];</p>

<p class=BoxedCode><span lang=SV>CK_ULONG ulDataLen, ulLastUpdateSize;</span></p>

<p class=BoxedCode><span lang=SV>CK_RV rv;</span></p>

<p class=BoxedCode><span lang=SV>&nbsp;</span></p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>memset(iv, 0, sizeof(iv));</p>

<p class=BoxedCode>memset(encryptedData, ‘A’, ((2*BUF_SZ)+8));</p>

<p class=BoxedCode>rv = C_DecryptInit(hSession, &amp;decryptionMechanism,
hDecryptionKey);</p>

<p class=BoxedCode>if (rv != CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>rv = C_VerifyInit(hSession, &amp;verifyMechanism, hMacKey);</p>

<p class=BoxedCode>if (rv != CKR_OK){</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>ulDataLen = sizeof(data);</p>

<p class=BoxedCode>rv = C_DecryptVerifyUpdate(</p>

<p class=BoxedCode>  hSession,</p>

<p class=BoxedCode>  &amp;encryptedData[0], BUF_SZ,</p>

<p class=BoxedCode>  <span lang=IT>data, &amp;ulDataLen);</span></p>

<p class=BoxedCode><span lang=IT>.</span></p>

<p class=BoxedCode><span lang=IT>.</span></p>

<p class=BoxedCode><span lang=IT>ulDataLen = sizeof(data);</span></p>

<p class=BoxedCode><span lang=IT>rv = C_DecryptVerifyUpdate(</span></p>

<p class=BoxedCode><span lang=IT>  hSession,</span></p>

<p class=BoxedCode><span lang=IT>  &amp;encryptedData[BUF_SZ], BUF_SZ,</span></p>

<p class=BoxedCode><span lang=IT>  </span>data, &amp;uldataLen);</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/*</p>

<p class=BoxedCode> * The last portion of the buffer needs to be handled with </p>

<p class=BoxedCode> * separate calls to deal with padding issues in ECB mode</p>

<p class=BoxedCode> */</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* First, complete the decryption of the buffer */</p>

<p class=BoxedCode>ulLastUpdateSize = sizeof(data);</p>

<p class=BoxedCode>rv = C_DecryptUpdate(</p>

<p class=BoxedCode>  <span lang=IT>hSession,</span></p>

<p class=BoxedCode><span lang=IT>  &amp;encryptedData[BUF_SZ*2], 8,</span></p>

<p class=BoxedCode><span lang=IT>  data, &amp;ulLastUpdateSize);</span></p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>/* Get last little piece of plaintext.  Should have length 0
*/</p>

<p class=BoxedCode>ulDataLen = sizeof(data)-ulLastUpdateSize;</p>

<p class=BoxedCode>rv = C_DecryptFinal(hSession, &amp;data[ulLastUpdateSize],
&amp;ulDataLen);</p>

<p class=BoxedCode>if (rv != CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/* Send last bit of plaintext to verification operation */</p>

<p class=BoxedCode><span lang=IT>rv = C_VerifyUpdate(hSession,
&amp;data[BUF_SZ*2], 5);</span></p>

<p class=BoxedCode>if (rv != CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

<p class=BoxedCode>rv = C_VerifyFinal(hSession, MAC, ulMacLen);</p>

<p class=BoxedCode>if (rv == CKR_SIGNATURE_INVALID) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<h2><a name="_Toc416959749"></a><a name="_Toc395183822"></a><a
name="_Toc391468826"></a><a name="_Toc370634035"></a><a name="_Toc235002390"></a><a
name="_Toc72656172"></a><a name="_Ref457140170"></a><a name="_Toc405794782"></a><a
name="_Ref399147279"></a><a name="_Ref399141071"></a><a name="_Ref385149143"></a><a
name="_Toc385057962">5.13 Key management</a> functions</h2>

<p class=MsoNormal>Cryptoki provides the following functions for key
management:</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002391"></a><a name="_Toc72656173"></a><a name="_Toc405794783"></a><a
name="_Toc385057963"></a><a name="_Toc383864926"></a><a name="_Toc323610919"></a><a
name="_Toc323205490"></a><a name="_Toc323024156"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_GenerateKey</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_GenerateKey)(<br>
  CK_SESSION_HANDLE hSession<br>
  CK_MECHANISM_PTR pMechanism,<br>
  CK_ATTRIBUTE_PTR pTemplate,<br>
  CK_ULONG ulCount,<br>
  CK_OBJECT_HANDLE_PTR phKey<br>
);</p>

</div>

<p class=MsoNormal><b>C_GenerateKey</b> generates a secret key or set of domain
parameters, creating a new object. <i>hSession</i> is the session’s handle; <i>pMechanism</i>
points to the generation mechanism; <i>pTemplate</i> points to the template for
the new key or set of domain parameters; <i>ulCount</i> is the number of
attributes in the template; <i>phKey</i> points to the location that receives
the handle of the new key or set of domain parameters.</p>

<p class=MsoNormal>If the generation mechanism is for domain parameter
generation, the <b>CKA_CLASS</b> attribute will have the value
CKO_DOMAIN_PARAMETERS; otherwise, it will have the value CKO_SECRET_KEY.</p>

<p class=MsoNormal>Since the type of key or domain parameters to be generated
is implicit in the generation mechanism, the template does not need to supply a
key type.  If it does supply a key type which is inconsistent with the
generation mechanism, <b>C_GenerateKey</b> fails and returns the error code
CKR_TEMPLATE_INCONSISTENT.  The CKA_CLASS attribute is treated similarly.</p>

<p class=MsoNormal>If a call to <b>C_GenerateKey</b> cannot support the precise
template supplied to it, it will fail and return without creating an object.</p>

<p class=MsoNormal>The object created by a successful call to <b>C_GenerateKey</b>
will have its <b>CKA_LOCAL</b> attribute set to CK_TRUE.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_ATTRIBUTE_READ_ONLY,
CKR_ATTRIBUTE_TYPE_INVALID, CKR_ATTRIBUTE_VALUE_INVALID,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_CURVE_NOT_SUPPORTED, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED,
CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_MECHANISM_INVALID,
CKR_MECHANISM_PARAM_INVALID, CKR_OK, CKR_OPERATION_ACTIVE, CKR_PIN_EXPIRED,
CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID, CKR_SESSION_READ_ONLY,
CKR_TEMPLATE_INCOMPLETE, CKR_TEMPLATE_INCONSISTENT, CKR_TOKEN_WRITE_PROTECTED,
CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hKey;</p>

<p class=BoxedCode>CK_MECHANISM mechanism = {</p>

<p class=BoxedCode>  CKM_DES_KEY_GEN, NULL_PTR, 0</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>rv = C_GenerateKey(hSession, &amp;mechanism, NULL_PTR, 0,
&amp;hKey);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002392"></a><a name="_Toc72656174"></a><a name="_Toc405794784"></a><a
name="_Toc385057964"></a><a name="_Toc383864927"></a><a name="_Toc323610920"></a><a
name="_Toc323205491"></a><a name="_Toc323024157"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_GenerateKeyPair</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_GenerateKeyPair)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_MECHANISM_PTR pMechanism,<br>
  CK_ATTRIBUTE_PTR pPublicKeyTemplate,<br>
  CK_ULONG ulPublicKeyAttributeCount,<br>
  CK_ATTRIBUTE_PTR pPrivateKeyTemplate,<br>
  CK_ULONG ulPrivateKeyAttributeCount,<br>
  CK_OBJECT_HANDLE_PTR phPublicKey,<br>
  CK_OBJECT_HANDLE_PTR phPrivateKey<br>
);</p>

</div>

<p class=MsoNormal><b>C_GenerateKeyPair</b> generates a public/private key
pair, creating new key objects.  <i>hSession</i> is the session’s handle; <i>pMechanism</i>
points to the key generation mechanism; <i>pPublicKeyTemplate</i> points to the
template for the public key; <i>ulPublicKeyAttributeCount</i> is the number of
attributes in the public-key template; <i>pPrivateKeyTemplate</i> points to the
template for the private key; <i>ulPrivateKeyAttributeCount</i> is the number
of attributes in the private-key template; <i>phPublicKey</i> points to the
location that receives the handle of the new public key; <i>phPrivateKey</i>
points to the location that receives the handle of the new private key.</p>

<p class=MsoNormal>Since the types of keys to be generated are implicit in the
key pair generation mechanism, the templates do not need to supply key types. 
If one of the templates does supply a key type which is inconsistent with the
key generation mechanism, <b>C_GenerateKeyPair</b> fails and returns the error
code CKR_TEMPLATE_INCONSISTENT.  The CKA_CLASS attribute is treated similarly.</p>

<p class=MsoNormal>If a call to <b>C_GenerateKeyPair</b> cannot support the
precise templates supplied to it, it will fail and return without creating any
key objects.</p>

<p class=MsoNormal>A call to <b>C_GenerateKeyPair</b> will never create just
one key and return.  A call can fail, and create no keys; or it can succeed,
and create a matching public/private key pair.</p>

<p class=MsoNormal>The key objects created by a successful call to <b>C_GenerateKeyPair</b>
will have their <b>CKA_LOCAL</b> attributes set to CK_TRUE.</p>

<p class=MsoNormal><i>Note carefully the order of the arguments to <b>C_GenerateKeyPair</b>. 
The last two arguments do not have the same order as they did in the original
Cryptoki Version 1.0 document.  The order of these two arguments has caused
some unfortunate confusion.</i></p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_ATTRIBUTE_READ_ONLY,
CKR_ATTRIBUTE_TYPE_INVALID, CKR_ATTRIBUTE_VALUE_INVALID,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_CURVE_NOT_SUPPORTED, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_DOMAIN_PARAMS_INVALID,
CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY,
CKR_MECHANISM_INVALID, CKR_MECHANISM_PARAM_INVALID, CKR_OK,
CKR_OPERATION_ACTIVE, CKR_PIN_EXPIRED, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_SESSION_READ_ONLY, CKR_TEMPLATE_INCOMPLETE,
CKR_TEMPLATE_INCONSISTENT, CKR_TOKEN_WRITE_PROTECTED, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hPublicKey, hPrivateKey;</p>

<p class=BoxedCode>CK_MECHANISM mechanism = {</p>

<p class=BoxedCode>  CKM_RSA_PKCS_KEY_PAIR_GEN, NULL_PTR, 0</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_ULONG modulusBits = 768;</p>

<p class=BoxedCode>CK_BYTE publicExponent[] = { 3 };</p>

<p class=BoxedCode>CK_BYTE subject[] = {...};</p>

<p class=BoxedCode>CK_BYTE id[] = {123};</p>

<p class=BoxedCode>CK_BBOOL true = CK_TRUE;</p>

<p class=BoxedCode>CK_ATTRIBUTE publicKeyTemplate[] = {</p>

<p class=BoxedCode>  {CKA_ENCRYPT, &amp;true, sizeof(true)},</p>

<p class=BoxedCode>  {CKA_VERIFY, &amp;true, sizeof(true)},</p>

<p class=BoxedCode>  {CKA_WRAP, &amp;true, sizeof(true)},</p>

<p class=BoxedCode>  {CKA_MODULUS_BITS, &amp;modulusBits, sizeof(modulusBits)},</p>

<p class=BoxedCode>  {CKA_PUBLIC_EXPONENT, publicExponent, sizeof
(publicExponent)}</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_ATTRIBUTE privateKeyTemplate[] = {</p>

<p class=BoxedCode>  {CKA_TOKEN, &amp;true, sizeof(true)},</p>

<p class=BoxedCode>  {CKA_PRIVATE, &amp;true, sizeof(true)},</p>

<p class=BoxedCode>  {CKA_SUBJECT, subject, sizeof(subject)},</p>

<p class=BoxedCode>  {CKA_ID, id, sizeof(id)},</p>

<p class=BoxedCode>  {CKA_SENSITIVE, &amp;true, sizeof(true)},</p>

<p class=BoxedCode>  {CKA_DECRYPT, &amp;true, sizeof(true)},</p>

<p class=BoxedCode>  {CKA_SIGN, &amp;true, sizeof(true)},</p>

<p class=BoxedCode>  {CKA_UNWRAP, &amp;true, sizeof(true)}</p>

<p class=BoxedCode><span lang=SV>};</span></p>

<p class=BoxedCode><span lang=SV>CK_RV rv;</span></p>

<p class=BoxedCode><span lang=SV>&nbsp;</span></p>

<p class=BoxedCode><span lang=SV>rv = C_GenerateKeyPair(</span></p>

<p class=BoxedCode><span lang=SV>  </span>hSession, &amp;mechanism,</p>

<p class=BoxedCode>  publicKeyTemplate, 5,</p>

<p class=BoxedCode>  privateKeyTemplate, 8,</p>

<p class=BoxedCode>  &amp;hPublicKey, &amp;hPrivateKey);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002393"></a><a name="_Toc72656175"></a><a name="_Toc405794785"></a><a
name="_Toc385057965"></a><a name="_Toc383864928"></a><a name="_Toc323610921"></a><a
name="_Toc323205492"></a><a name="_Toc323024158"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_WrapKey</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_WrapKey)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_MECHANISM_PTR pMechanism,<br>
  CK_OBJECT_HANDLE hWrappingKey,<br>
  CK_OBJECT_HANDLE hKey,<br>
  CK_BYTE_PTR pWrappedKey,<br>
  CK_ULONG_PTR pulWrappedKeyLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_WrapKey</b> wraps (<i>i.e.</i>, encrypts) a private or
secret key. <i>hSession</i> is the session’s handle; <i>pMechanism</i> points
to the wrapping mechanism; <i>hWrappingKey</i> is the handle of the wrapping
key;<i> hKey</i> is the handle of the key to be wrapped; <i>pWrappedKey</i>
points to the location that receives the wrapped key; and<i> pulWrappedKeyLen</i>
points to the location that receives the length of the wrapped key.</p>

<p class=MsoNormal><b>C_WrapKey</b> uses the convention described in Section 5.2 on producing output.</p>

<p class=MsoNormal>The <b>CKA_WRAP</b> attribute of the wrapping key, which
indicates whether the key supports wrapping, MUST be CK_TRUE.  The <b>CKA_EXTRACTABLE</b>
attribute of the key to be wrapped MUST also be CK_TRUE.</p>

<p class=MsoNormal>If the key to be wrapped cannot be wrapped for some
token-specific reason, despite its having its <b>CKA_EXTRACTABLE</b> attribute
set to CK_TRUE, then <b>C_WrapKey</b> fails with error code
CKR_KEY_NOT_WRAPPABLE.  If it cannot be wrapped with the specified wrapping key
and mechanism solely because of its length, then <b>C_WrapKey</b> fails with
error code CKR_KEY_SIZE_RANGE.</p>

<p class=MsoNormal><b>C_WrapKey</b> can be used in the following situations:</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>To wrap any secret key with a public key that supports encryption
and decryption.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>To wrap any secret key with any other secret key. Consideration MUST
be given to key size and mechanism strength or the token may not allow the
operation.</p>

<p class=MsoNormal style='margin-left:.25in;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>To wrap a private key with any secret key.</p>

<p class=MsoNormal>Of course, tokens vary in which types of keys can actually
be wrapped with which mechanisms.</p>

<p class=MsoNormal>To partition the wrapping keys so they can only wrap a
subset of extractable keys the attribute CKA_WRAP_TEMPLATE can be used on the
wrapping key to specify an attribute set that will be compared against the
attributes of the key to be wrapped. If all attributes match according to the
C_FindObject rules of attribute matching then the wrap will proceed. The value
of this attribute is an attribute template and the size is the number of items
in the template times the size of CK_ATTRIBUTE. If this attribute is not
supplied then any template is acceptable. If an attribute is not present, it
will not be checked. If any attribute mismatch occurs on an attempt to wrap a
key then the function SHALL return CKR_KEY_HANDLE_INVALID.</p>

<p class=MsoNormal>Return Values: CKR_ARGUMENTS_BAD, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_KEY_HANDLE_INVALID,
CKR_KEY_NOT_WRAPPABLE, CKR_KEY_SIZE_RANGE, CKR_KEY_UNEXTRACTABLE,
CKR_MECHANISM_INVALID, CKR_MECHANISM_PARAM_INVALID, CKR_OK,
CKR_OPERATION_ACTIVE, CKR_PIN_EXPIRED, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_USER_NOT_LOGGED_IN, CKR_WRAPPING_KEY_HANDLE_INVALID,
CKR_WRAPPING_KEY_SIZE_RANGE, CKR_WRAPPING_KEY_TYPE_INCONSISTENT.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hWrappingKey, hKey;</p>

<p class=BoxedCode>CK_MECHANISM mechanism = {</p>

<p class=BoxedCode>  CKM_DES3_ECB, NULL_PTR, 0</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_BYTE wrappedKey[8];</p>

<p class=BoxedCode>CK_ULONG ulWrappedKeyLen;</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>ulWrappedKeyLen = sizeof(wrappedKey);</p>

<p class=BoxedCode>rv = C_WrapKey(</p>

<p class=BoxedCode>  hSession, &amp;mechanism,</p>

<p class=BoxedCode>  hWrappingKey, hKey,</p>

<p class=BoxedCode>  wrappedKey, &amp;ulWrappedKeyLen);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002394"></a><a name="_Toc72656176"></a><a name="_Toc405794786"></a><a
name="_Toc385057966"></a><a name="_Toc383864929"></a><a name="_Toc323610922"></a><a
name="_Toc323205493"></a><a name="_Toc323024159"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_UnwrapKey</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_UnwrapKey)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_MECHANISM_PTR pMechanism,<br>
  CK_OBJECT_HANDLE hUnwrappingKey,<br>
  CK_BYTE_PTR pWrappedKey,<br>
  CK_ULONG ulWrappedKeyLen,<br>
  CK_ATTRIBUTE_PTR pTemplate,<br>
  CK_ULONG ulAttributeCount,<br>
  CK_OBJECT_HANDLE_PTR phKey<br>
);</p>

</div>

<p class=MsoNormal><b>C_UnwrapKey</b> unwraps (<i>i.e.</i> decrypts) a wrapped
key, creating a new private key or secret key object. <i>hSession</i> is the
session’s handle; <i>pMechanism</i> points to the unwrapping mechanism; <i>hUnwrappingKey</i>
is the handle of the unwrapping key;<i> pWrappedKey</i> points to the wrapped
key; <i>ulWrappedKeyLen</i> is the length of the wrapped key; <i>pTemplate</i>
points to the template for the new key; <i>ulAttributeCount</i> is the number
of attributes in the template; <i>phKey</i> points to the location that
receives the handle of the recovered key.</p>

<p class=MsoNormal>The <b>CKA_UNWRAP</b> attribute of the unwrapping key, which
indicates whether the key supports unwrapping, MUST be CK_TRUE.</p>

<p class=MsoNormal>The new key will have the <b>CKA_ALWAYS_SENSITIVE</b>
attribute set to CK_FALSE, and the <b>CKA_NEVER_EXTRACTABLE</b> attribute set
to CK_FALSE. The <b>CKA_EXTRACTABLE</b> attribute is by default set to CK_TRUE.</p>

<p class=MsoNormal>Some mechanisms may modify, or attempt to modify. the
contents of the pMechanism structure at the same time that the key is
unwrapped.</p>

<p class=MsoNormal>If a call to <b>C_UnwrapKey</b> cannot support the precise
template supplied to it, it will fail and return without creating any key
object.</p>

<p class=MsoNormal>The key object created by a successful call to <b>C_UnwrapKey</b>
will have its <b>CKA_LOCAL</b> attribute set to CK_FALSE.</p>

<p class=MsoNormal>To partition the unwrapping keys so they can only unwrap a
subset of keys the attribute CKA_UNWRAP_TEMPLATE can be used on the unwrapping
key to specify an attribute set that will be added to attributes of the key to
be unwrapped. If the attributes do not conflict with the user supplied
attribute template, in ‘pTemplate’, then the unwrap will proceed. The value of
this attribute is an attribute template and the size is the number of items in
the template times the size of CK_ATTRIBUTE. If this attribute is not present
on the unwrapping key then no additional attributes will be added. If any
attribute conflict occurs on an attempt to unwrap a key then the function SHALL
return CKR_TEMPLATE_INCONSISTENT.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_ATTRIBUTE_READ_ONLY,
CKR_ATTRIBUTE_TYPE_INVALID, CKR_ATTRIBUTE_VALUE_INVALID, CKR_BUFFER_TOO_SMALL,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_CURVE_NOT_SUPPORTED, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_DOMAIN_PARAMS_INVALID,
CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY,
CKR_MECHANISM_INVALID, CKR_MECHANISM_PARAM_INVALID, CKR_OK, CKR_OPERATION_ACTIVE,
CKR_PIN_EXPIRED, CKR_SESSION_CLOSED, CKR_SESSION_HANDLE_INVALID,
CKR_SESSION_READ_ONLY, CKR_TEMPLATE_INCOMPLETE, CKR_TEMPLATE_INCONSISTENT,
CKR_TOKEN_WRITE_PROTECTED, CKR_UNWRAPPING_KEY_HANDLE_INVALID,
CKR_UNWRAPPING_KEY_SIZE_RANGE, CKR_UNWRAPPING_KEY_TYPE_INCONSISTENT,
CKR_USER_NOT_LOGGED_IN, CKR_WRAPPED_KEY_INVALID, CKR_WRAPPED_KEY_LEN_RANGE.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hUnwrappingKey, hKey;</p>

<p class=BoxedCode>CK_MECHANISM mechanism = {</p>

<p class=BoxedCode>  CKM_DES3_ECB, NULL_PTR, 0</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_BYTE wrappedKey[8] = {...};</p>

<p class=BoxedCode>CK_OBJECT_CLASS keyClass = CKO_SECRET_KEY;</p>

<p class=BoxedCode>CK_KEY_TYPE keyType = CKK_DES;</p>

<p class=BoxedCode>CK_BBOOL true = CK_TRUE;</p>

<p class=BoxedCode>CK_ATTRIBUTE template[] = {</p>

<p class=BoxedCode>  {CKA_CLASS, &amp;keyClass, sizeof(keyClass)},</p>

<p class=BoxedCode>  {CKA_KEY_TYPE, &amp;keyType, sizeof(keyType)},</p>

<p class=BoxedCode>  {CKA_ENCRYPT, &amp;true, sizeof(true)},</p>

<p class=BoxedCode>  {CKA_DECRYPT, &amp;true, sizeof(true)}</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>rv = C_UnwrapKey(</p>

<p class=BoxedCode>  hSession, &amp;mechanism, hUnwrappingKey,</p>

<p class=BoxedCode>  wrappedKey, sizeof(wrappedKey), template, 4, &amp;hKey);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002395"></a><a name="_Toc72656177"></a><a name="_Toc405794787"></a><a
name="_Toc385057967"></a><a name="_Toc383864930"></a><a name="_Toc323610923"></a><a
name="_Toc323205494"></a><a name="_Toc323024160"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_DeriveKey</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_DeriveKey)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_MECHANISM_PTR pMechanism,<br>
  CK_OBJECT_HANDLE hBaseKey,<br>
  CK_ATTRIBUTE_PTR pTemplate,<br>
  CK_ULONG ulAttributeCount,<br>
  CK_OBJECT_HANDLE_PTR phKey<br>
);</p>

</div>

<p class=MsoNormal><b>C_DeriveKey</b> derives a key from a base key, creating a
new key object. <i>hSession</i> is the session’s handle; <i>pMechanism</i>
points to a structure that specifies the key derivation mechanism;  <i>hBaseKey</i>
is the handle of the base key; <i>pTemplate</i> points to the template for the
new key; <i>ulAttributeCount</i> is the number of  attributes in the template;
and <i>phKey</i> points to the location that receives the handle of the derived
key.</p>

<p class=MsoNormal>The values of the <b>CKA_SENSITIVE</b>, <b>CKA_ALWAYS_SENSITIVE</b>,
<b>CKA_EXTRACTABLE</b>, and <b>CKA_NEVER_EXTRACTABLE</b> attributes for the
base key affect the values that these attributes can hold for the newly-derived
key.  See the description of each particular key-derivation mechanism in
Section 5.16.2 for any constraints of this type.</p>

<p class=MsoNormal>If a call to <b>C_DeriveKey</b> cannot support the precise
template supplied to it, it will fail and return without creating any key
object.</p>

<p class=MsoNormal>The key object created by a successful call to <b>C_DeriveKey</b>
will have its <b>CKA_LOCAL</b> attribute set to CK_FALSE.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD, CKR_ATTRIBUTE_READ_ONLY,
CKR_ATTRIBUTE_TYPE_INVALID, CKR_ATTRIBUTE_VALUE_INVALID,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_CURVE_NOT_SUPPORTED, CKR_DEVICE_ERROR,
CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED, CKR_DOMAIN_PARAMS_INVALID,
CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY,
CKR_KEY_HANDLE_INVALID, CKR_KEY_SIZE_RANGE, CKR_KEY_TYPE_INCONSISTENT,
CKR_MECHANISM_INVALID, CKR_MECHANISM_PARAM_INVALID, CKR_OK,
CKR_OPERATION_ACTIVE, CKR_PIN_EXPIRED, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_SESSION_READ_ONLY, CKR_TEMPLATE_INCOMPLETE,
CKR_TEMPLATE_INCONSISTENT, CKR_TOKEN_WRITE_PROTECTED, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_OBJECT_HANDLE hPublicKey, hPrivateKey, hKey;</p>

<p class=BoxedCode>CK_MECHANISM keyPairMechanism = {</p>

<p class=BoxedCode>  CKM_DH_PKCS_KEY_PAIR_GEN, NULL_PTR, 0</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_BYTE prime[] = {...};</p>

<p class=BoxedCode>CK_BYTE base[] = {...};</p>

<p class=BoxedCode>CK_BYTE publicValue[128];</p>

<p class=BoxedCode>CK_BYTE otherPublicValue[128];</p>

<p class=BoxedCode>CK_MECHANISM mechanism = {</p>

<p class=BoxedCode>  CKM_DH_PKCS_DERIVE, otherPublicValue,
sizeof(otherPublicValue)</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_ATTRIBUTE pTemplate[] = {</p>

<p class=BoxedCode>  CKA_VALUE, &amp;publicValue, sizeof(publicValue)}</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_OBJECT_CLASS keyClass = CKO_SECRET_KEY;</p>

<p class=BoxedCode>CK_KEY_TYPE keyType = CKK_DES;</p>

<p class=BoxedCode>CK_BBOOL true = CK_TRUE;</p>

<p class=BoxedCode>CK_ATTRIBUTE publicKeyTemplate[] = {</p>

<p class=BoxedCode>  {CKA_PRIME, prime, sizeof(prime)},</p>

<p class=BoxedCode>  <span lang=IT>{CKA_BASE, base, sizeof(base)}</span></p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_ATTRIBUTE privateKeyTemplate[] = {</p>

<p class=BoxedCode>  {CKA_DERIVE, &amp;true, sizeof(true)}</p>

<p class=BoxedCode>};</p>

<p class=BoxedCode>CK_ATTRIBUTE template[] = {</p>

<p class=BoxedCode>  {CKA_CLASS, &amp;keyClass, sizeof(keyClass)},</p>

<p class=BoxedCode>  {CKA_KEY_TYPE, &amp;keyType, sizeof(keyType)},</p>

<p class=BoxedCode>  {CKA_ENCRYPT, &amp;true, sizeof(true)},</p>

<p class=BoxedCode>  {CKA_DECRYPT, &amp;true, sizeof(true)}</p>

<p class=BoxedCode><span lang=SV>};</span></p>

<p class=BoxedCode><span lang=SV>CK_RV rv;</span></p>

<p class=BoxedCode><span lang=SV>&nbsp;</span></p>

<p class=BoxedCode><span lang=SV>.</span></p>

<p class=BoxedCode><span lang=SV>.</span></p>

<p class=BoxedCode><span lang=SV>rv = C_GenerateKeyPair(</span></p>

<p class=BoxedCode><span lang=SV>  </span>hSession, &amp;keyPairMechanism,</p>

<p class=BoxedCode>  publicKeyTemplate, 2,</p>

<p class=BoxedCode>  privateKeyTemplate, 1,</p>

<p class=BoxedCode>  &amp;hPublicKey, &amp;hPrivateKey);</p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  rv = C_GetAttributeValue(hSession, hPublicKey,
&amp;pTemplate, 1);</p>

<p class=BoxedCode>  if (rv == CKR_OK) {</p>

<p class=BoxedCode>    /* Put other guy’s public value in otherPublicValue */</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>    .</p>

<p class=BoxedCode>    rv = C_DeriveKey(</p>

<p class=BoxedCode>      hSession, &amp;mechanism,</p>

<p class=BoxedCode>      hPrivateKey, template, 4, &amp;hKey);</p>

<p class=BoxedCode>    if (rv == CKR_OK) {</p>

<p class=BoxedCode>      .</p>

<p class=BoxedCode>      .</p>

<p class=BoxedCode>    }</p>

<p class=BoxedCode>  }</p>

<p class=BoxedCode>}</p>

</div>

<h2><a name="_Toc323024162"></a><a name="_Toc416959750"></a><a
name="_Toc395183823"></a><a name="_Toc391468827"></a><a name="_Toc370634036"></a><a
name="_Toc235002396"></a><a name="_Toc72656178"></a><a name="_Toc405794788"></a><a
name="_Toc385057968"></a><a name="_Toc383864931"></a><a name="_Toc323610924"></a><a
name="_Toc323205495">5.14 Random number generation</a> functions</h2>

<p class=MsoNormal><a name="_Toc323205496">Cryptoki provides the following
functions for generating random numbers:</a></p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002397"></a><a name="_Toc72656179"></a><a name="_Toc405794789"></a><a
name="_Toc385057969"></a><a name="_Toc383864932"></a><a name="_Toc323610925"><span
style='font-family:Symbol;font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_SeedRandom</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_SeedRandom)(<br>
  CK_SESSION_HANDLE hSession,<br>
  CK_BYTE_PTR pSeed,<br>
  CK_ULONG ulSeedLen<br>
);</p>

</div>

<p class=MsoNormal><b>C_SeedRandom</b> mixes additional seed material into the
token’s random number generator. <i>hSession</i> is the session’s handle; <i>pSeed</i>
points to the seed material; and<i> ulSeedLen</i> is the length in bytes of the
seed material.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY,
CKR_DEVICE_REMOVED, CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED,
CKR_GENERAL_ERROR, CKR_HOST_MEMORY, CKR_OK, CKR_OPERATION_ACTIVE,
CKR_RANDOM_SEED_NOT_SUPPORTED, CKR_RANDOM_NO_RNG, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example: see <b>C_GenerateRandom</b>.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002398"></a><a name="_Toc72656180"></a><a name="_Toc405794790"></a><a
name="_Toc385057970"></a><a name="_Toc383864933"></a><a name="_Toc323610926"></a><a
name="_Toc323205497"></a><a name="_Toc323024163"><span lang=SV
style='font-family:Symbol;font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=SV style='font-family:"Arial","sans-serif"'>C_GenerateRandom</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode><span lang=SV>CK_DEFINE_FUNCTION(CK_RV, C_GenerateRandom)(</span></p>

<p class=BoxedCode><span lang=SV>  </span>CK_SESSION_HANDLE hSession,</p>

<p class=BoxedCode>  <span lang=SV>CK_BYTE_PTR pRandomData,</span></p>

<p class=BoxedCode><span lang=SV>  CK_ULONG ulRandomLen</span></p>

<p class=BoxedCode><span lang=SV>);</span></p>

</div>

<p class=MsoNormal><b>C_GenerateRandom</b> generates random or pseudo-random
data. <i>hSession</i> is the session’s handle; <i>pRandomData</i> points to the
location that receives the random data; and<i> ulRandomLen</i> is the length in
bytes of the random or pseudo-random data to be generated.</p>

<p class=MsoNormal>Return values: CKR_ARGUMENTS_BAD,
CKR_CRYPTOKI_NOT_INITIALIZED, CKR_DEVICE_ERROR, CKR_DEVICE_MEMORY, CKR_DEVICE_REMOVED,
CKR_FUNCTION_CANCELED, CKR_FUNCTION_FAILED, CKR_GENERAL_ERROR, CKR_HOST_MEMORY,
CKR_OK, CKR_OPERATION_ACTIVE, CKR_RANDOM_NO_RNG, CKR_SESSION_CLOSED,
CKR_SESSION_HANDLE_INVALID, CKR_USER_NOT_LOGGED_IN.</p>

<p class=MsoNormal>Example:</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_SESSION_HANDLE hSession;</p>

<p class=BoxedCode>CK_BYTE seed[] = {...};</p>

<p class=BoxedCode>CK_BYTE randomData[] = {...};</p>

<p class=BoxedCode>CK_RV rv;</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>.</p>

<p class=BoxedCode>rv = C_SeedRandom(hSession, seed, sizeof(seed));</p>

<p class=BoxedCode>if (rv != CKR_OK) {</p>

<p class=BoxedCode>  <span lang=SV>.</span></p>

<p class=BoxedCode><span lang=SV>  .</span></p>

<p class=BoxedCode><span lang=SV>}</span></p>

<p class=BoxedCode><span lang=SV>rv = C_GenerateRandom(hSession, randomData,
sizeof(randomData));</span></p>

<p class=BoxedCode>if (rv == CKR_OK) {</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>  .</p>

<p class=BoxedCode>}</p>

</div>

<h2><a name="_Toc416959751"></a><a name="_Toc395183824"></a><a
name="_Toc391468828"></a><a name="_Toc370634037"></a><a name="_Toc235002399"></a><a
name="_Toc72656181"></a><a name="_Toc405794791"></a><a name="_Ref399575137"></a><a
name="_Toc385057971"></a><a name="_Toc383864934"></a><a name="_Toc323610927"></a><a
name="_Toc323205498"></a><a name="_Toc323024164"></a><a name="_Toc323000716"></a><a
name="_Toc322945149"></a><a name="_Toc322855307">5.15 Parallel function
management</a> functions</h2>

<p class=MsoNormal>Cryptoki provides the following functions for managing
parallel execution of cryptographic functions.  These functions exist only for
backwards compatibility.</p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002400"></a><a name="_Toc72656182"></a><a name="_Toc405794792"></a><a
name="_Toc385057972"></a><a name="_Toc383864935"></a><a name="_Toc323610928"></a><a
name="_Toc323205499"></a><a name="_Toc323024165"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_GetFunctionStatus</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_GetFunctionStatus)(<br>
  CK_SESSION_HANDLE hSession<br>
);</p>

</div>

<p class=MsoNormal>In previous versions of Cryptoki, <b>C_GetFunctionStatus</b>
obtained the status of a function running in parallel with an application. 
Now, however, <b>C_GetFunctionStatus</b> is a legacy function which should
simply return the value CKR_FUNCTION_NOT_PARALLEL.</p>

<p class=MsoNormal>Return values: CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_FUNCTION_FAILED, CKR_FUNCTION_NOT_PARALLEL, CKR_GENERAL_ERROR,
CKR_HOST_MEMORY, CKR_SESSION_HANDLE_INVALID, CKR_SESSION_CLOSED.   </p>

<p class=name style='margin-left:.25in;text-indent:-.25in'><a
name="_Toc235002401"></a><a name="_Toc72656183"></a><a name="_Toc405794793"></a><a
name="_Toc385057973"></a><a name="_Toc383864936"></a><a name="_Toc323610929"></a><a
name="_Toc323205500"></a><a name="_Toc323024166"><span style='font-family:Symbol;
font-weight:normal'>¨<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Arial","sans-serif"'>C_CancelFunction</span></a></p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>CK_DEFINE_FUNCTION(CK_RV, C_CancelFunction)(<br>
  CK_SESSION_HANDLE hSession<br>
);</p>

</div>

<p class=MsoNormal>In previous versions of Cryptoki, <b>C_CancelFunction</b>
cancelled a function running in parallel with an application.  Now, however, <b>C_CancelFunction</b>
is a legacy function which should simply return the value CKR_FUNCTION_NOT_PARALLEL.</p>

<p class=MsoNormal>Return values: CKR_CRYPTOKI_NOT_INITIALIZED,
CKR_FUNCTION_FAILED, CKR_FUNCTION_NOT_PARALLEL, CKR_GENERAL_ERROR,
CKR_HOST_MEMORY, CKR_SESSION_HANDLE_INVALID, CKR_SESSION_CLOSED.  </p>

<h2><a name="_Ref319997130"></a><a name="_Toc416959752"></a><a
name="_Toc395183825"></a><a name="_Toc391468829"></a><a name="_Toc370634038"></a><a
name="_Toc235002402"></a><a name="_Toc72656184"></a><a name="_Toc405794794"></a><a
name="_Ref385351071"></a><a name="_Toc385057974"></a><a name="_Ref384828675"></a><a
name="_Toc383864937"></a><a name="_Toc323610930"></a><a name="_Toc323205501"></a><a
name="_Toc323024167"></a><a name="_Toc323000717"></a><a name="_Toc322945150"></a><a
name="_Ref322938213"></a><a name="_Toc322855308"></a><a name="_Ref320505795">5.16
Callback function</a>s</h2>

<p class=MsoNormal>Cryptoki sessions can use function pointers of type <b>CK_NOTIFY</b>
to notify the application of certain events.</p>

<h3><a name="_Toc416959753"></a><a name="_Toc395183826"></a><a
name="_Toc391468830"></a><a name="_Toc370634039"></a><a name="_Toc235002403"></a><a
name="_Toc72656185"></a><a name="_Toc405794795"></a><a name="_Ref394400826">5.16.1
Surrender callbacks</a></h3>

<p class=MsoNormal>Cryptographic functions (<i>i.e.</i>, any functions falling
under one of these categories: encryption functions; decryption functions;
message digesting functions; signing and MACing functions; functions for
verifying signatures and MACs; dual-purpose cryptographic functions; key
management functions; random number generation functions) executing in Cryptoki
sessions can periodically surrender control to the application who called them
if the session they are executing in had a notification callback function
associated with it when it was opened.  They do this by calling the session’s
callback with the arguments (hSession, CKN_SURRENDER, pApplication), where
hSession is the session’s handle and pApplication was supplied to <b>C_OpenSession</b>
when the session was opened.  Surrender callbacks should return either the
value CKR_OK (to indicate that Cryptoki should continue executing the function)
or the value CKR_CANCEL (to indicate that Cryptoki should abort execution of
the function).  Of course, before returning one of these values, the callback
function can perform some computation, if desired.</p>

<p class=MsoNormal>A typical use of a surrender callback might be to give an
application user feedback during a lengthy key pair generation operation.  Each
time the application receives a callback, it could display an additional “.” to
the user.  It might also examine the keyboard’s activity since the last
surrender callback, and abort the key pair generation operation (probably by
returning the value CKR_CANCEL) if the user hit &lt;ESCAPE&gt;.</p>

<p class=MsoNormal>A Cryptoki library is not <i>required</i> to make <i>any</i>
surrender callbacks.</p>

<h3><a name="_Toc385057976"></a><a name="_Toc383864939"></a><a
name="_Toc323610932"></a><a name="_Toc323205503"></a><a name="_Toc323024169"></a><a
name="_Toc323000718"></a><a name="_Toc322945151"></a><a name="_Toc322855309"></a><a
name="_Ref320514897"></a><a name="_Toc416959754"></a><a name="_Toc395183827"></a><a
name="_Toc391468831"></a><a name="_Toc370634040"></a><a name="_Toc235002404"></a><a
name="_Toc72656186"></a><a name="_Toc405794796">5.16.2 Vendor-defined callbacks</a></h3>

<p class=MsoNormal>Library vendors can also define additional types of
callbacks.  Because of this extension capability, application-supplied
notification callback routines should examine each callback they receive, and
if they are unfamiliar with the type of that callback, they should immediately
give control back to the library by returning with the value CKR_OK.</p>

<p class=MsoNormal>&nbsp;</p>

<div style='border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in'>

<h1><a name="_Toc416959755"></a><a name="_Toc395183828"></a><a
name="_Toc391468832"></a><a name="_Toc370634041">6<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>PKCS #11 Implementation Conformance</a></h1>

</div>

<p class=MsoNormal>An implementation is a conforming implementation if it meets
the conditions specified in one or more server profiles specified in <b>[PKCS
#11-Prof]</b>.</p>

<p class=MsoNormal>If a PKCS #11 implementation claims support for a particular
profile, then the implementation SHALL conform to all normative statements
within the clauses specified for that profile and for any subclauses to each of
those clauses<span style='font-family:"Courier New"'>.</span></p>

<div style='border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in'>

<p class=AppendixHeading1><a name="_Ref72659766"></a><a name="_Ref72659745"></a><a
name="_Ref72658945"></a><a name="_Ref72658937"></a><a name="_Toc72656531"></a><a
name="_Toc405794955"></a><a name="_Toc383864976"></a><a name="_Toc323610960"></a><a
name="_Toc235002410">Appendix A.<span style='font:7.0pt "Times New Roman"'> </span> </a><a
name="_Toc416959756"></a><a name="_Toc395183829"></a><a name="_Toc391468833"></a><a
name="_Toc370634042">Acknowledgments</a></p>

</div>

<p class=MsoNormal>The following individuals have participated in the creation
of this specification and are gratefully acknowledged:</p>

<p class=Titlepageinfo>&nbsp;</p>

<p class=Titlepageinfo>Participants:</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Gil Abel,
Athena Smartcard Solutions, Inc.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Warren
Armstrong, QuintessenceLabs</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Jeff
Bartell, Semper Foris Solutions LLC</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Peter
Bartok, Venafi, Inc.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Anthony
Berglas, Cryptsoft </p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Joseph
Brand, Semper Fortis Solutions LLC</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Kelley
Burgin, National Security Agency</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Robert
Burns, Thales e-Security</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Wan-Teh
Chang, Google Inc.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Hai-May
Chao, Oracle</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Janice
Cheng, Vormetric, Inc.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Sangrae Cho,
Electronics and Telecommunications Research Institute (ETRI)</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Doron Cohen,
SafeNet, Inc.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Fadi Cotran,
Futurex</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Tony Cox,
Cryptsoft </p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Christopher
Duane, EMC</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Chris Dunn,
SafeNet, Inc.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Valerie
Fenwick, Oracle</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Terry
Fletcher, SafeNet, Inc.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Susan
Gleeson, Oracle</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Sven Gossel,
Charismathics</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>John Green,
QuintessenceLabs</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Robert Griffin,
EMC</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Paul
Grojean, Individual</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Peter
Gutmann, Individual</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Dennis E.
Hamilton, Individual</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Thomas
Hardjono, M.I.T.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Tim Hudson,
Cryptsoft</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Gershon
Janssen, Individual</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Seunghun
Jin, Electronics and Telecommunications Research Institute (ETRI)</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Wang
Jingman, Feitan Technologies</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Andrey
Jivsov, Symantec Corp.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Mark Joseph,
P6R</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Stefan
Kaesar, Infineon Technologies</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Greg
Kazmierczak, Wave Systems Corp.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Mark Knight,
Thales e-Security</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
lang=DE-CH>Darren Krahn, Google Inc.</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
lang=DE-CH>Alex Krasnov, Infineon Technologies AG</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Dina
Kurktchi-Nimeh, Oracle</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Mark
Lambiase, SecureAuth Corporation</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Lawrence
Lee, GoTrust Technology Inc.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
lang=FR-CH>John Leiseboer, QuintessenceLabs </span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
lang=FR-CH>Sean Leon, Infineon Technologies</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
lang=FR-CH>Geoffrey Li, Infineon Technologies</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
lang=FR-CH>Howie Liu, Infineon Technologies</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Hal
Lockhart, Oracle</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Robert
Lockhart, Thales e-Security</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Dale Moberg,
Axway Software</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Darren
Moffat, Oracle</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Valery
Osheter, SafeNet, Inc.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Sean
Parkinson, EMC</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Rob
Philpott, EMC</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Mark Powers,
Oracle</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Ajai Puri,
SafeNet, Inc.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Robert
Relyea, Red Hat</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Saikat Saha,
Oracle</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
lang=IT>Subhash Sankuratripati, NetApp</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
lang=IT>Anthony Scarpino, Oracle</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Johann
Schoetz, Infineon Technologies AG</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Rayees
Shamsuddin, Wave Systems Corp.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
lang=IT>Radhika Siravara, Oracle</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
lang=IT>Brian Smith, Mozilla Corporation</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>David Smith,
Venafi, Inc.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Ryan Smith,
Futurex</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Jerry Smith,
US Department of Defense (DoD)</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Oscar So,
Oracle</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Graham
Steel, Cryptosense</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Michael
Stevens, QuintessenceLabs </p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Michael
StJohns, Individual</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Jim Susoy,
P6R</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Sander
Temme, Thales e-Security</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Kiran Thota,
VMware, Inc.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Walter-John
Turnes, Gemini Security Solutions, Inc.</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
lang=DE-CH>Stef Walter, Red Hat</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
lang=DE-CH>James Wang, Vormetric</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
lang=DE-CH>Jeff Webb, Dell</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
lang=DE-CH>Peng Yu, Feitian Technologies</span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'><span
lang=DE-CH>Magda Zdunkiewicz, Cryptsoft </span></p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>Chris
Zimman, Individual</p>

<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt'>.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<div style='border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in'>

<p class=AppendixHeading1><a name="_Toc416959757"></a><a name="_Toc395183830"></a><a
name="_Toc391468834"></a><a name="_Toc370634043">Appendix B.<span
style='font:7.0pt "Times New Roman"'> </span>Manifest constants</a></p>

</div>

<p class=MsoNormal>The following definitions can be found in the appropriate
header file.  Also, refer <b>[PKCS11_Curr] and [PKCS11_HIST] </b>for additional
definitions.</p>

<p class=MsoNormal style='page-break-after:avoid'>&nbsp;</p>

<div style='border:solid windowtext 1.0pt;padding:1.0pt 4.0pt 1.0pt 4.0pt'>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>/*</p>

<p class=BoxedCode> * Copyright © Oasis Open 2013.  All right reserved.</p>

<p class=BoxedCode> * OASIS trademark, IPR and other policies apply.</p>

<p class=BoxedCode> * <a
href="http://www.oasis-open.org/policies-guidelines/ipr">http://www.oasis-open.org/policies-guidelines/ipr</a></p>

<p class=BoxedCode> */</p>

<p class=BoxedCode>#define CK_INVALID_HANDLE                 0UL</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>#define CKN_SURRENDER                     0UL</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>#define CK_UNAVAILABLE_INFORMATION        (~0UL)</p>

<p class=BoxedCode>#define CK_EFFECTIVELY_INFINITE           0UL</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>#define CKF_DONT_BLOCK 1</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode><span lang=IT>#define CKF_ARRAY_ATTRIBUTE               0x40000000UL</span></p>

<p class=BoxedCode><span lang=IT>&nbsp;</span></p>

<p class=BoxedCode><span lang=IT>#define CKU_SO                            0UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKU_USER                          1UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKU_CONTEXT_SPECIFIC              2UL</span></p>

<p class=BoxedCode><span lang=IT>&nbsp;</span></p>

<p class=BoxedCode>#define CKS_RO_PUBLIC_SESSION             0UL</p>

<p class=BoxedCode>#define CKS_RO_USER_FUNCTIONS             1UL</p>

<p class=BoxedCode>#define CKS_RW_PUBLIC_SESSION             2UL</p>

<p class=BoxedCode>#define CKS_RW_USER_FUNCTIONS             3UL</p>

<p class=BoxedCode>#define CKS_RW_SO_FUNCTIONS               4UL</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode><span lang=IT>#define CKO_DATA                          0x00000000UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKO_CERTIFICATE                   0x00000001UL</span></p>

<p class=BoxedCode>#define CKO_PUBLIC_KEY                    0x00000002UL</p>

<p class=BoxedCode>#define CKO_PRIVATE_KEY                   0x00000003UL</p>

<p class=BoxedCode>#define CKO_SECRET_KEY                    0x00000004UL</p>

<p class=BoxedCode>#define CKO_HW_FEATURE                    0x00000005UL</p>

<p class=BoxedCode>#define CKO_DOMAIN_PARAMETERS             0x00000006UL</p>

<p class=BoxedCode>#define CKO_MECHANISM                     0x00000007UL</p>

<p class=BoxedCode>#define CKO_VENDOR_DEFINED                0x80000000UL</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>#define CKH_MONOTONIC_COUNTER             0x00000001UL</p>

<p class=BoxedCode>#define CKH_CLOCK                         0x00000002UL</p>

<p class=BoxedCode><span lang=IT>#define CKH_USER_INTERFACE                0x00000003UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKH_VENDOR_DEFINED                0x80000000UL</span></p>

<span lang=IT style='font-size:10.0pt;font-family:"Courier New"'><br clear=all
style='page-break-before:always'>
</span>

<p class=BoxedCode><span lang=IT>&nbsp;</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_CLASS                         0x00000000UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_TOKEN                         0x00000001UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_PRIVATE                       0x00000002UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_LABEL                         0x00000003UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_APPLICATION                   0x00000010UL</span></p>

<p class=BoxedCode>#define CKA_VALUE                         0x00000011UL</p>

<p class=BoxedCode>#define CKA_OBJECT_ID                     0x00000012UL</p>

<p class=BoxedCode><span lang=IT>#define CKA_CERTIFICATE_TYPE              0x00000080UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_ISSUER                        0x00000081UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_SERIAL_NUMBER                 0x00000082UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_AC_ISSUER                     0x00000083UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_OWNER                         0x00000084UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_ATTR_TYPES                    0x00000085UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_TRUSTED                       0x00000086UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_CERTIFICATE_CATEGORY          0x00000087UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_JAVA_MIDP_SECURITY_DOMAIN     0x00000088UL</span></p>

<p class=BoxedCode>#define CKA_URL                           0x00000089UL</p>

<p class=BoxedCode>#define CKA_HASH_OF_SUBJECT_PUBLIC_KEY    0x0000008AUL</p>

<p class=BoxedCode>#define CKA_HASH_OF_ISSUER_PUBLIC_KEY     0x0000008BUL</p>

<p class=BoxedCode>#define CKA_NAME_HASH_ALGORITHM           0x0000008CUL</p>

<p class=BoxedCode>#define CKA_CHECK_VALUE                   0x00000090UL</p>

<p class=BoxedCode>#define CKA_KEY_TYPE                      0x00000100UL</p>

<p class=BoxedCode><span lang=IT>#define CKA_SUBJECT                       0x00000101UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_ID                            0x00000102UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_SENSITIVE                     0x00000103UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_ENCRYPT                       0x00000104UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_DECRYPT                       0x00000105UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_WRAP                          0x00000106UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_UNWRAP                        0x00000107UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_SIGN                          0x00000108UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_SIGN_RECOVER                  0x00000109UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_VERIFY                        0x0000010AUL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_VERIFY_RECOVER                0x0000010BUL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_DERIVE                        0x0000010CUL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_START_DATE                    0x00000110UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_END_DATE                      0x00000111UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_MODULUS                       0x00000120UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_MODULUS_BITS                  0x00000121UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_PUBLIC_EXPONENT               0x00000122UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_PRIVATE_EXPONENT              0x00000123UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_PRIME_1                       0x00000124UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_PRIME_2                       0x00000125UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_EXPONENT_1                    0x00000126UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_EXPONENT_2                    0x00000127UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_COEFFICIENT                   0x00000128UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_PRIME                         0x00000130UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_SUBPRIME                      0x00000131UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_BASE                          0x00000132UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_PRIME_BITS                    0x00000133UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_SUBPRIME_BITS                 0x00000134UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_VALUE_BITS                    0x00000160UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_VALUE_LEN                     0x00000161UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_EXTRACTABLE                   0x00000162UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_LOCAL                         0x00000163UL</span></p>

<p class=BoxedCode>#define CKA_NEVER_EXTRACTABLE             0x00000164UL</p>

<p class=BoxedCode>#define CKA_ALWAYS_SENSITIVE              0x00000165UL</p>

<p class=BoxedCode>#define CKA_KEY_GEN_MECHANISM             0x00000166UL</p>

<p class=BoxedCode><span lang=IT>#define CKA_MODIFIABLE                    0x00000170UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_COPYABLE                      0x00000171UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_DESTROYABLE                   0x00000172UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_ECDSA_PARAMS                  0x00000180UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_EC_PARAMS                     0x00000180UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_EC_POINT                      0x00000181UL</span></p>

<p class=BoxedCode>#define CKA_SECONDARY_AUTH                0x00000200UL /*
Deprecated */</p>

<p class=BoxedCode>#define CKA_AUTH_PIN_FLAGS                0x00000201UL /*
Deprecated */</p>

<p class=BoxedCode>#define CKA_ALWAYS_AUTHENTICATE           0x00000202UL</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>#define CKA_WRAP_WITH_TRUSTED             0x00000210UL</p>

<p class=BoxedCode>#define CKA_WRAP_TEMPLATE                 (CKF_ARRAY_ATTRIBUTE|0x00000211UL)</p>

<p class=BoxedCode>   #define CKA_UNWRAP_TEMPLATE            (CKF_ARRAY_ATTRIBUTE|0x00000212UL)</p>

<p class=BoxedCode>#define CKA_HW_FEATURE_TYPE               0x00000300UL</p>

<p class=BoxedCode>#define CKA_RESET_ON_INIT                 0x00000301UL</p>

<p class=BoxedCode>#define CKA_HAS_RESET                     0x00000302UL</p>

<p class=BoxedCode>#define CKA_PIXEL_X                       0x00000400UL</p>

<p class=BoxedCode>#define CKA_PIXEL_Y                       0x00000401UL</p>

<p class=BoxedCode>#define CKA_RESOLUTION                    0x00000402UL</p>

<p class=BoxedCode>#define CKA_CHAR_ROWS                     0x00000403UL</p>

<p class=BoxedCode><span lang=IT>#define CKA_CHAR_COLUMNS                  0x00000404UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKA_COLOR                         0x00000405UL</span></p>

<p class=BoxedCode><span lang=SV>#define CKA_BITS_PER_PIXEL                0x00000406UL</span></p>

<p class=BoxedCode><span lang=SV>#define CKA_CHAR_SETS                     0x00000480UL</span></p>

<p class=BoxedCode><span lang=SV>#define CKA_ENCODING_METHODS              0x00000481UL</span></p>

<p class=BoxedCode><span lang=SV>#define CKA_MIME_TYPES                    0x00000482UL</span></p>

<p class=BoxedCode><span lang=SV>#define CKA_MECHANISM_TYPE                0x00000500UL</span></p>

<p class=BoxedCode>#define CKA_REQUIRED_CMS_ATTRIBUTES       0x00000501UL</p>

<p class=BoxedCode>#define CKA_DEFAULT_CMS_ATTRIBUTES        0x00000502UL</p>

<p class=BoxedCode>#define CKA_SUPPORTED_CMS_ATTRIBUTES      0x00000503UL</p>

<p class=BoxedCode>#define CKA_ALLOWED_MECHANISMS            (CKF_ARRAY_ATTRIBUTE|0x00000600UL)</p>

<p class=BoxedCode><span lang=IT>#define CKA_VENDOR_DEFINED                0x80000000UL</span></p>

<p class=BoxedCode><span lang=IT>&nbsp;</span></p>

<p class=BoxedCode><span lang=IT>#define CKR_OK                           
0x00000000UL</span></p>

<p class=BoxedCode>#define CKR_CANCEL                        0x00000001UL</p>

<p class=BoxedCode>#define CKR_HOST_MEMORY                   0x00000002UL</p>

<p class=BoxedCode>#define CKR_SLOT_ID_INVALID               0x00000003UL</p>

<p class=BoxedCode>#define CKR_GENERAL_ERROR                 0x00000005UL</p>

<p class=BoxedCode>#define CKR_FUNCTION_FAILED               0x00000006UL</p>

<p class=BoxedCode>#define CKR_ARGUMENTS_BAD                 0x00000007UL</p>

<p class=BoxedCode>#define CKR_NO_EVENT                      0x00000008UL</p>

<p class=BoxedCode>#define CKR_NEED_TO_CREATE_THREADS        0x00000009UL</p>

<p class=BoxedCode>#define CKR_CANT_LOCK                     0x0000000AUL</p>

<p class=BoxedCode>#define CKR_ATTRIBUTE_READ_ONLY           0x00000010UL</p>

<p class=BoxedCode>#define CKR_ATTRIBUTE_SENSITIVE           0x00000011UL</p>

<p class=BoxedCode>#define CKR_ATTRIBUTE_TYPE_INVALID        0x00000012UL</p>

<p class=BoxedCode>#define CKR_ATTRIBUTE_VALUE_INVALID       0x00000013UL</p>

<p class=BoxedCode>#define <span style='color:black'>CKR_COPY_PROHIBITED               </span>0x0000001AUL</p>

<p class=BoxedCode>#define CKR_ACTION_PROHIBITED             0x0000001BUL</p>

<p class=BoxedCode>#define CKR_DATA_INVALID                  0x00000020UL</p>

<p class=BoxedCode>#define CKR_DATA_LEN_RANGE                0x00000021UL</p>

<p class=BoxedCode>#define CKR_DEVICE_ERROR                  0x00000030UL</p>

<p class=BoxedCode>#define CKR_DEVICE_MEMORY                 0x00000031UL</p>

<p class=BoxedCode>#define CKR_DEVICE_REMOVED                0x00000032UL</p>

<p class=BoxedCode>#define CKR_ENCRYPTED_DATA_INVALID        0x00000040UL</p>

<p class=BoxedCode>#define CKR_ENCRYPTED_DATA_LEN_RANGE      0x00000041UL</p>

<p class=BoxedCode>#define CKR_FUNCTION_CANCELED             0x00000050UL</p>

<p class=BoxedCode>#define CKR_FUNCTION_NOT_PARALLEL         0x00000051UL</p>

<p class=BoxedCode>#define CKR_FUNCTION_NOT_SUPPORTED        0x00000054UL</p>

<p class=BoxedCode>#define CKR_KEY_HANDLE_INVALID            0x00000060UL</p>

<p class=BoxedCode>#define CKR_KEY_SIZE_RANGE                0x00000062UL</p>

<p class=BoxedCode>#define CKR_KEY_TYPE_INCONSISTENT         0x00000063UL</p>

<p class=BoxedCode>#define CKR_KEY_NOT_NEEDED                0x00000064UL</p>

<p class=BoxedCode>#define CKR_KEY_CHANGED                   0x00000065UL</p>

<p class=BoxedCode>#define CKR_KEY_NEEDED                    0x00000066UL</p>

<p class=BoxedCode>#define CKR_KEY_INDIGESTIBLE              0x00000067UL</p>

<p class=BoxedCode>#define CKR_KEY_FUNCTION_NOT_PERMITTED    0x00000068UL</p>

<p class=BoxedCode>#define CKR_KEY_NOT_WRAPPABLE             0x00000069UL</p>

<p class=BoxedCode>#define CKR_KEY_UNEXTRACTABLE             0x0000006AUL</p>

<p class=BoxedCode>#define CKR_MECHANISM_INVALID             0x00000070UL</p>

<p class=BoxedCode>#define CKR_MECHANISM_PARAM_INVALID       0x00000071UL</p>

<p class=BoxedCode>#define CKR_OBJECT_HANDLE_INVALID         0x00000082UL</p>

<p class=BoxedCode>#define CKR_OPERATION_ACTIVE              0x00000090UL</p>

<p class=BoxedCode>#define CKR_OPERATION_NOT_INITIALIZED     0x00000091UL</p>

<p class=BoxedCode>#define CKR_PIN_INCORRECT                 0x000000A0UL</p>

<p class=BoxedCode>#define CKR_PIN_INVALID                   0x000000A1UL</p>

<p class=BoxedCode>#define CKR_PIN_LEN_RANGE                 0x000000A2UL</p>

<p class=BoxedCode>#define CKR_PIN_EXPIRED                   0x000000A3UL</p>

<p class=BoxedCode>#define CKR_PIN_LOCKED                    0x000000A4UL</p>

<p class=BoxedCode>#define CKR_SESSION_CLOSED                0x000000B0UL</p>

<p class=BoxedCode>#define CKR_SESSION_COUNT                 0x000000B1UL</p>

<p class=BoxedCode>#define CKR_SESSION_HANDLE_INVALID        0x000000B3UL</p>

<p class=BoxedCode>#define CKR_SESSION_PARALLEL_NOT_SUPPORTED 0x000000B4UL</p>

<p class=BoxedCode>#define CKR_SESSION_READ_ONLY             0x000000B5UL</p>

<p class=BoxedCode>#define CKR_SESSION_EXISTS                0x000000B6UL</p>

<p class=BoxedCode>#define CKR_SESSION_READ_ONLY_EXISTS      0x000000B7UL</p>

<p class=BoxedCode>#define CKR_SESSION_READ_WRITE_SO_EXISTS  0x000000B8UL</p>

<p class=BoxedCode><span lang=IT>#define CKR_SIGNATURE_INVALID            
0x000000C0UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKR_SIGNATURE_LEN_RANGE          
0x000000C1UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKR_TEMPLATE_INCOMPLETE          
0x000000D0UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKR_TEMPLATE_INCONSISTENT         0x000000D1UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKR_TOKEN_NOT_PRESENT            
0x000000E0UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKR_TOKEN_NOT_RECOGNIZED         
0x000000E1UL</span></p>

<p class=BoxedCode><span lang=IT>#define CKR_TOKEN_WRITE_PROTECTED        
0x000000E2UL</span></p>

<p class=BoxedCode>#define CKR_UNWRAPPING_KEY_HANDLE_INVALID 0x000000F0UL</p>

<p class=BoxedCode>#define CKR_UNWRAPPING_KEY_SIZE_RANGE     0x000000F1UL</p>

<p class=BoxedCode>#define CKR_UNWRAPPING_KEY_TYPE_INCONSISTENT  0x000000F2UL</p>

<p class=BoxedCode>#define CKR_USER_ALREADY_LOGGED_IN        0x00000100UL</p>

<p class=BoxedCode>#define CKR_USER_NOT_LOGGED_IN            0x00000101UL</p>

<p class=BoxedCode>#define CKR_USER_PIN_NOT_INITIALIZED      0x00000102UL</p>

<p class=BoxedCode>#define CKR_USER_TYPE_INVALID             0x00000103UL</p>

<p class=BoxedCode>#define CKR_USER_ANOTHER_ALREADY_LOGGED_IN 0x00000104UL</p>

<p class=BoxedCode>#define CKR_USER_TOO_MANY_TYPES           0x00000105UL</p>

<p class=BoxedCode>#define CKR_WRAPPED_KEY_INVALID           0x00000110UL</p>

<p class=BoxedCode>#define CKR_WRAPPED_KEY_LEN_RANGE         0x00000112UL</p>

<p class=BoxedCode>#define CKR_WRAPPING_KEY_HANDLE_INVALID   0x00000113UL</p>

<p class=BoxedCode>#define CKR_WRAPPING_KEY_SIZE_RANGE       0x00000114UL</p>

<p class=BoxedCode>#define CKR_WRAPPING_KEY_TYPE_INCONSISTENT 0x00000115UL</p>

<p class=BoxedCode>#define CKR_RANDOM_SEED_NOT_SUPPORTED     0x00000120UL</p>

<p class=BoxedCode>#define CKR_RANDOM_NO_RNG                 0x00000121UL</p>

<p class=BoxedCode>#define CKR_DOMAIN_PARAMS_INVALID         0x00000130UL</p>

<p class=BoxedCode>#define CKR_CURVE_NOT_SUPPORTED           0x00000140UL</p>

<p class=BoxedCode>#define CKR_BUFFER_TOO_SMALL              0x00000150UL</p>

<p class=BoxedCode>#define CKR_SAVED_STATE_INVALID           0x00000160UL</p>

<p class=BoxedCode>#define CKR_INFORMATION_SENSITIVE         0x00000170UL</p>

<p class=BoxedCode>#define CKR_STATE_UNSAVEABLE              0x00000180UL</p>

<p class=BoxedCode>#define CKR_CRYPTOKI_NOT_INITIALIZED      0x00000190UL</p>

<p class=BoxedCode>#define CKR_CRYPTOKI_ALREADY_INITIALIZED  0x00000191UL</p>

<p class=BoxedCode>#define CKR_MUTEX_BAD                     0x000001A0UL</p>

<p class=BoxedCode>#define CKR_MUTEX_NOT_LOCKED              0x000001A1UL</p>

<p class=BoxedCode>#define CKR_FUNCTION_REJECTED             0x00000200UL</p>

<p class=BoxedCode>#define CKR_VENDOR_DEFINED                0x80000000UL</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>#define CK_CERTIFICATE_CATEGORY_UNSPECIFIED     0UL</p>

<p class=BoxedCode>#define CK_CERTIFICATE_CATEGORY_TOKEN_USER      1UL</p>

<p class=BoxedCode>#define CK_CERTIFICATE_CATEGORY_AUTHORITY       2UL</p>

<p class=BoxedCode>#define CK_CERTIFICATE_CATEGORY_OTHER_ENTITY    3UL</p>

<p class=BoxedCode>&nbsp;</p>

<p class=BoxedCode>#define CK_SECURITY_DOMAIN_UNSPECIFIED          0UL</p>

<p class=BoxedCode>#define CK_SECURITY_DOMAIN_MANUFACTURER         1UL</p>

<p class=BoxedCode>#define CK_SECURITY_DOMAIN_OPERATOR             2UL</p>

<p class=BoxedCode>#define CK_SECURITY_DOMAIN_THIRD_PARTY          3UL</p>

<p class=BoxedCode>&nbsp;</p>

</div>

<div style='border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in'>

<p class=AppendixHeading1><a name="_Toc416959758"></a><a name="_Toc395183831"></a><a
name="_Toc391468835"></a><a name="_Toc370634044"></a><a name="_Toc287332014"></a><a
name="_Toc85472898">Appendix C.<span style='font:7.0pt "Times New Roman"'> </span>Revision
History</a></p>

</div>

<p class=MsoNormal>&nbsp;</p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=643
 style='width:482.3pt;border-collapse:collapse;border:none'>
 <tr style='height:20.1pt'>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:20.1pt'>
  <p class=MsoNormal align=center style='text-align:center'><b>Revision</b></p>
  </td>
  <td width=97 valign=top style='width:72.55pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:20.1pt'>
  <p class=MsoNormal align=center style='text-align:center'><b>Date</b></p>
  </td>
  <td width=145 valign=top style='width:108.8pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:20.1pt'>
  <p class=MsoNormal align=center style='text-align:center'><b>Editor</b></p>
  </td>
  <td width=297 valign=top style='width:223.0pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt;height:20.1pt'>
  <p class=MsoNormal><b>Changes Made</b></p>
  </td>
 </tr>
 <tr style='height:20.1pt'>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:20.1pt'>
  <p class=MsoNormal>wd01</p>
  </td>
  <td width=97 valign=top style='width:72.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:20.1pt'>
  <p class=MsoNormal>Apr 30 2013</p>
  </td>
  <td width=145 valign=top style='width:108.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:20.1pt'>
  <p class=MsoNormal>Chris Zimman</p>
  </td>
  <td width=297 valign=top style='width:223.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:20.1pt'>
  <p class=MsoNormal>Initial import into OASIS template</p>
  </td>
 </tr>
 <tr style='height:31.95pt'>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>wd02</p>
  </td>
  <td width=97 valign=top style='width:72.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>July 7 2013</p>
  </td>
  <td width=145 valign=top style='width:108.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Chris Zimman</p>
  </td>
  <td width=297 valign=top style='width:223.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Move explanatory material to PKCS #11 Usage Guide v2.40
  wd02</p>
  </td>
 </tr>
 <tr style='height:20.1pt'>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:20.1pt'>
  <p class=MsoNormal>wd03</p>
  </td>
  <td width=97 valign=top style='width:72.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:20.1pt'>
  <p class=MsoNormal>Aug 16 2013</p>
  </td>
  <td width=145 valign=top style='width:108.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:20.1pt'>
  <p class=MsoNormal>Chris Zimman</p>
  </td>
  <td width=297 valign=top style='width:223.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:20.1pt'>
  <p class=MsoNormal>Incorporation of recent ballot items</p>
  </td>
 </tr>
 <tr style='height:31.95pt'>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>wd04</p>
  </td>
  <td width=97 valign=top style='width:72.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Oct 1 2013</p>
  </td>
  <td width=145 valign=top style='width:108.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Chris Zimman</p>
  </td>
  <td width=297 valign=top style='width:223.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Incorporation of ballot items, prep for Committee
  Specification Draft promotion</p>
  </td>
 </tr>
 <tr style='height:43.8pt'>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:43.8pt'>
  <p class=MsoNormal>wd05</p>
  </td>
  <td width=97 valign=top style='width:72.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:43.8pt'>
  <p class=MsoNormal>Oct 7 2013</p>
  </td>
  <td width=145 valign=top style='width:108.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:43.8pt'>
  <p class=MsoNormal>Chris Zimman</p>
  </td>
  <td width=297 valign=top style='width:223.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:43.8pt'>
  <p class=MsoNormal>Typo correction and proof.  This is the candidate for promotion
  to Committee Specification Draft.</p>
  </td>
 </tr>
 <tr style='height:31.95pt'>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>wd06</p>
  </td>
  <td width=97 valign=top style='width:72.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Oct 27 2013</p>
  </td>
  <td width=145 valign=top style='width:108.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Robert Griffin</p>
  </td>
  <td width=297 valign=top style='width:223.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Final participant list and other editorial changes for
  Committee Specification Draft</p>
  </td>
 </tr>
 <tr style='height:31.95pt'>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>csd01</p>
  </td>
  <td width=97 valign=top style='width:72.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Oct 30 2013</p>
  </td>
  <td width=145 valign=top style='width:108.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>OASIS</p>
  </td>
  <td width=297 valign=top style='width:223.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Committee Specification Draft</p>
  </td>
 </tr>
 <tr style='height:31.95pt'>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>wd07</p>
  </td>
  <td width=97 valign=top style='width:72.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Feb 17 2014</p>
  </td>
  <td width=145 valign=top style='width:108.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Chris Zimman</p>
  </td>
  <td width=297 valign=top style='width:223.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Incorporation of comments and changes from public feedback
  and review</p>
  </td>
 </tr>
 <tr style='height:31.95pt'>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>wd08</p>
  </td>
  <td width=97 valign=top style='width:72.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Feb 27 2014</p>
  </td>
  <td width=145 valign=top style='width:108.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Chris Zimman</p>
  </td>
  <td width=297 valign=top style='width:223.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Incorporation of comments and changes from public feedback
  and review</p>
  </td>
 </tr>
 <tr style='height:31.95pt'>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>csd02</p>
  </td>
  <td width=97 valign=top style='width:72.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Apr 23 2014</p>
  </td>
  <td width=145 valign=top style='width:108.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>OASIS</p>
  </td>
  <td width=297 valign=top style='width:223.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Committee Specification Draft</p>
  </td>
 </tr>
 <tr style='height:31.95pt'>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>wd09</p>
  </td>
  <td width=97 valign=top style='width:72.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>May 2 2014</p>
  </td>
  <td width=145 valign=top style='width:108.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Chris Zimman</p>
  </td>
  <td width=297 valign=top style='width:223.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Incorporated changes from PKCS 11 TC face-to-face meeting</p>
  </td>
 </tr>
 <tr style='height:31.95pt'>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>wd10</p>
  </td>
  <td width=97 valign=top style='width:72.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Jul 2 2014</p>
  </td>
  <td width=145 valign=top style='width:108.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Chris Zimman</p>
  </td>
  <td width=297 valign=top style='width:223.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Corrected manifest constants</p>
  </td>
 </tr>
 <tr style='height:31.95pt'>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>csd03</p>
  </td>
  <td width=97 valign=top style='width:72.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Jul 16 2014</p>
  </td>
  <td width=145 valign=top style='width:108.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>OASIS</p>
  </td>
  <td width=297 valign=top style='width:223.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Committee Specification Draft</p>
  </td>
 </tr>
 <tr style='height:31.95pt'>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>csd03a</p>
  </td>
  <td width=97 valign=top style='width:72.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Sep 3 2014</p>
  </td>
  <td width=145 valign=top style='width:108.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Robert Griffin</p>
  </td>
  <td width=297 valign=top style='width:223.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Updated revision history and participant list in
  preparation for Committee Specification ballot</p>
  </td>
 </tr>
 <tr style='height:31.95pt'>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>wd11</p>
  </td>
  <td width=97 valign=top style='width:72.55pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Nov 3 2014</p>
  </td>
  <td width=145 valign=top style='width:108.8pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Robert Griffin</p>
  </td>
  <td width=297 valign=top style='width:223.0pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:31.95pt'>
  <p class=MsoNormal>Editorial corrections</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
